<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8" />
<meta name="generator" content="Docutils 0.20.1: https://docutils.sourceforge.io/" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OPTIMADE API specification v1.2.0~develop</title>
<style type="text/css">

/* This is an OPTIMADE adjustment of the minimal CSS for HTML output from Docutils. */

:root {
    --bg-color: white;
    --fg-color: #000000;
    --code-bg-color: #F0F0F0;
    --code-fg-color: #282828;
    --primary: #007bff;
    --secondary: #50fa7b;
    --tertiary: #ff414d;
    --quaternary: #7a2dd0;
    --external-refs: var(--tertiary);
    --inline-refs: var(--primary);
    --monospace-font-family:  monospace;
    --sans-serif-font-family: sans-serif;
}

@media (prefers-color-scheme: dark) {
    :root {
        --bg-color: #161625;
        --fg-color: #dcdcdc;
        --code-fg-color: #f8f8f8;
        --code-bg-color: #3a3d4d;
        --primary: #007bff;
        --secondary: #50fa7b;
        --tertiary: #ff414d;
        --quaternary: #7a2dd0;
        --external-refs: var(--tertiary);
        --inline-refs: var(--primary);
        --monospace-font-family: monospace;
        --sans-serif-font-family: sans-serif;

    }
}

body {
    font-family: var(--sans-serif-font-family);
    font-size: 16px;
    max-width: 60rem;
    margin-left: 10rem;
    margin-right: auto;
    margin-top: 0;
    margin-bottom: 0;
    color: var(--fg-color);
    background-color: var(--bg-color);
    --field-indent: 9em; /* default indent of fields in field lists */
}

/*Banner for development version*/
.banner-container {
    max-width: 60rem;
    min-width: 60rem;
    height: 50px;
    position: fixed;
    top: 0;
    color: var(--code-bg-color);
    background: var(--code-fg-color);
    border: outset 2px var(--tertiary);
    align-items: center;
    display: flex;
    justify-content: center;
}

.banner {
    text-transform: uppercase;
    text-align: center;
    vertical-align: middle;
    font-size: 1.5em;
    display: table-cell;
}

/* "page layout" */
main, footer, header {
  line-height:1.6;
  /* avoid long lines --> better reading */
  /* optimum is 45…75 characters/line <http://webtypography.net/2.1.2> */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 60rem;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
}
main {
  counter-reset: table figure;
  background-color: var(--bg-color);
}
footer, header {
  font-size: smaller;
  padding: 0.5em 2%;
  border: none;
}

.reference.internal {
    text-decoration: dotted underline;
    text-decoration-thickness: 2px;
    text-decoration-color: var(--inline-refs);
    text-decoration-skip-ink: none;
    text-underline-offset: 2px;
    color: var(--fg-color);
}

.auto-toc .reference.internal {
    text-decoration: none;
}

.auto-toc .reference.internal .sectnum {
    text-decoration: dotted underline;
    text-decoration-thickness: 2px;
    text-decoration-color: var(--inline-refs);
}


.reference.external {
    text-decoration: dotted underline;
    text-decoration-thickness: 2px;
    text-underline-offset: 2px;
    text-decoration-color: var(--external-refs);
    color: var(--fg-color);
}



/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 9079 2022-06-19 14:00:56Z milde $                                                               */
/* :Copyright: © 2015, 2021 Günter Milde.                                  */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS3 stylesheet defines rules for Docutils elements without        */
/* HTML equivalent. It is required to make the document semantics visible. */
/*                                                                         */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link        */

/* titles */
p.topic-title,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
p.sidebar-title,
p.rubric {
  font-weight: bold;
  font-size: larger;
}
p.rubric {
  color: maroon;
}
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
h1 + p.subtitle {
  font-size: 1.6em;
}
a.toc-backref {
  color: inherit;
  text-decoration: none;
}

/* Warnings, Errors */
.system-messages h2,
.system-message-title,
span.problematic {
  color: red;
}

/* Inline Literals */
.docutils.literal {
  font-family: var(--monospace-font-family);
  white-space: pre-wrap;
  color: var(--code-fg-color);
  background-color: var(--code-bg-color);
  border-radius: 0.2em;
  overflow-wrap: anywhere;
  padding-left: 4px;
  padding-right: 4px;
  padding-top: 2px;
  padding-bottom: 2px;
}
/* do not wrap at hyphens and similar: */
/*.literal > span.pre { white-space: nowrap; }*/

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .simple  ul, .simple  ol,
.compact li, .compact ul, .compact ol,
.simple  > li p, dl.simple  > dd,
.compact > li p, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}
/* Nested Paragraphs */
p:first-child { margin-top: 0; }
p:last-child { margin-bottom: 0; }
details > p:last-child { margin-bottom: 1em; }

/* Table of Contents */
.contents ul.auto-toc { /* section numbers present */
  list-style-type: none;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

/* Definition Lists and Derivatives */
dt .classifier { font-style: italic }
dt .classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}
/* Field Lists and similar */
/* bold field name, content starts on the same line */
dl.field-list,
dl.option-list,
dl.docinfo {
  display: flow-root;
}
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.2em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples, fit all Docinfo fields */
}
/* start nested lists on new line */
dd > dl:first-child,
dd > ul:first-child,
dd > ol:first-child {
  clear: left;
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}

/* Bibliographic Fields (docinfo) */
dl.docinfo pre.address {
  font: inherit;
  margin: 0.5em 0;
}
dl.docinfo > dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */

.footnote, .citation { margin: 1em 0; } /* default paragraph skip (Firefox) */
/* hanging indent */
.citation { padding-left: 2em; }
.footnote { padding-left: 1.7em; }
.footnote.superscript { padding-left: 1.0em; }
.citation > .label { margin-left: -2em; }
.footnote > .label { margin-left: -1.7em; }
.footnote.superscript > .label { margin-left: -1.0em; }

.footnote > .label + *,
.citation > .label + * {
  display: inline-block;
  margin-top: 0;
  vertical-align: top;
}
.footnote > .backrefs + *,
.citation > .backrefs + * {
  margin-top: 0;
}
.footnote > .label + p, .footnote > .backrefs + p,
.citation > .label + p, .citation > .backrefs + p {
  display: inline;
  vertical-align: inherit;
}

.backrefs { user-select: none; }
.backrefs > a { font-style: italic; }

/* superscript footnotes */
a[role="doc-noteref"].superscript,
.footnote.superscript > .label,
.footnote.superscript > .backrefs {
  vertical-align: super;
  font-size: smaller;
  line-height: 1;
}
a[role="doc-noteref"].superscript > .fn-bracket,
.footnote.superscript > .label > .fn-bracket {
  /* hide brackets in display but leave for copy/paste */
  display: inline-block;
  width: 0;
  overflow: hidden;
}
[role="doc-noteref"].superscript + [role="doc-noteref"].superscript {
  padding-left: 0.15em; /* separate consecutive footnote references */
  /* TODO: unfortunately, "+" also selects with text between the references. */
}

/* Alignment */
.align-left   {
  text-align: left;
  margin-right: auto;
}
.align-center {
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}
.align-right  {
  text-align: right;
  margin-left: auto;
}
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* reset inner alignment in figures and tables */
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Text Blocks */
.topic { margin: 1em 2em; }
.sidebar,
.admonition,
.system-message {
  margin: 1em 2em;
  border: thin solid;
  padding: 0.5em 1em;
}
div.line-block { display: block; }
div.line-block div.line-block, pre { margin-left: 2em; }

/* Tables */
table {
  border-collapse: collapse;
}
td, th {
  border: thin solid silver;
  padding: 0 1ex;
}
.borderless td, .borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

table > caption {
  text-align: left;
  margin-top: 0.2em;
  margin-bottom: 0.2em;
}
table.captionbelow {
  caption-side: bottom;
}

/* Document Header and Footer */
header { border-bottom: 1px solid black; }
footer { border-top: 1px solid black; }

/* Images are block-level by default in Docutils */
/* New HTML5 block elements: set display for older browsers */
img, header, footer, main, aside, nav, section, figure, video, details {
  display: block;
}
/* inline images */
p img, p video, figure img, figure video {
  display: inline;
}


/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.                  */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 9338 2023-04-08 21:08:47Z milde $                                                               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: https://www.w3.org/Style/CSS/                                 */


/* Document Structure */
/* ****************** */


/* Table of Contents */
ul.auto-toc > li > p {
  padding-left: 1em;
  text-indent: -1em;
}
nav.contents ul {
  padding-left: 1em;
}
main > nav.contents ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B29\ ';
}
main > nav.contents ul ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B1D\ ';
}

/* Transitions */
hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */

/* vertical space (parskip) */
p, ol, ul, dl, li,
div.line-block,
.footnote, .citation,
div > math,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

h1, h2, h3, h4, h5, h6,
dd, details > p:last-child {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Definition Lists */
/* Indent lists nested in definition lists */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description {
  display: flow-root;
}
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.3em;
}
dl.description > dd:after {
  display: table;
  content: "";
  clear: left; /* clearfix for empty descriptions */
}

/* Field Lists */

dl.field-list > dd,
dl.docinfo > dd {
  margin-left: var(--field-indent); /* adapted in media queries or HTML */
}

/* example for custom field-name width */
dl.field-list.narrow > dd {
  --field-indent: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use dl.docinfo */
/* but dedication and abstract are placed into divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* disclosures */
details { padding-left: 1em; }
summary { margin-left: -1em; }

/* Text Blocks */
/* =========== */

/* Literal Blocks */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  font-family: var(--monospace-font-family);
  background-color: var(--code-bg-color);
  border: thin solid var(--fg-color);
  color: var(--code-fg-color);
  border-radius: 0.2em;
  padding-left: 0.5em;
overflow: auto;
}

/* Block Quotes and Topics */
blockquote {
  background-color: var(--code-bg-color);
  color: var(--fg-color);
  border: thin solid var(--fg-color);
  border-radius: 0.2em;
  padding: 0.5em 1em;
}
blockquote p.attribution,
.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Code */
pre.code { padding: 0.7ex }
pre.code, code {
  background-color: var(--code-bg-color);
  font-family: var(--monospace-font-family);
  color: var(--code-fg-color);
}

sup, sub { line-height: 0.8; } /* do not add leading for lines with sup/sub */
/* Hyperlink References */
a { text-decoration: none; }

</style>
</head>
<body class="with-toc"><div class="banner-container"><div class="banner">This is a development version of the specification.</div></div>
<main id="optimade-api-specification-v1-2-0-develop">
<h1 class="title">OPTIMADE API specification v1.2.0~develop</h1>

<!-- comment

This document uses RST text roles on (almost) all literals to specify the context to which each literal belongs.
This markup enables nicer formatting (e.g., HTML output can be formatted using CSS), as well as automated spell checks and testing.
Below follows the definitions of the text roles used:

  # Filtering

  filter : full OPTIMADE filter strings
  filter-fragment : segments of filter strings, or filter strings that uses, e.g., "..."
                    so they would not pass a validation.
  filter-op : operators and keywords in the filtering language
  ere : regex on ere form
  pcre : regex on pcre form

  # OPTIMADE concepts

  entry : names of type of resources, served via OPTIMADE, pertaining to data in a database.
  property : data item that belongs to an entry.
  val : value examples that properties can be.
        :val: is ONLY used when referencing values of actual properties, i.e., information that belongs to the database.
  type : data type of values.
         MUST equal a valid OPTIMADE data type as listed and defined under `Data types`_.

  # URL queries

  endpoint : specification of endpoints and endpoint names.
  query-param : URL query parameter names.
  query-string : strings that represent segments of URL query strings, with query parameters and values.
  query-url : full URLs, or relative starting with a '/' of URL queries.

  # HTTP

  http-header : an HTTP header name, or header + value.
  http-error : an HTTP error on form <number> <English text>.

  # Responses

  json : examples of JSON output.
  field : keys in key-value dictionaries in responses.
  field-val : value examples that fields can be set to.
              Note that `null` sometimes refer to the OPTIMADE concept of :val:`null`, and sometimes to the javascript constant :field-val:`null`, and the markup distinguishes these two cases.
  object : names of more complex response objects.

  # Validation

  <anything>-fail : means this is a counter-example of something
                    that is meant to be on form <anything> but is not valid. -->
<nav class="contents" id="contents" role="doc-toc">
<p class="topic-title">Contents</p>
<ul class="auto-toc simple">
<li><p><a class="reference internal" href="#introduction" id="toc-entry-1"><span class="sectnum">1 </span>Introduction</a></p></li>
<li><p><a class="reference internal" href="#definition-of-terms" id="toc-entry-2"><span class="sectnum">2 </span>Definition of Terms</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#data-types" id="toc-entry-3"><span class="sectnum">2.1 </span>Data types</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#general-api-requirements-and-conventions" id="toc-entry-4"><span class="sectnum">3 </span>General API Requirements and Conventions</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#versioning-of-this-standard" id="toc-entry-5"><span class="sectnum">3.1 </span>Versioning of this standard</a></p></li>
<li><p><a class="reference internal" href="#base-url" id="toc-entry-6"><span class="sectnum">3.2 </span>Base URL</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#versioned-base-urls" id="toc-entry-7"><span class="sectnum">3.2.1 </span>Versioned base URLs</a></p></li>
<li><p><a class="reference internal" href="#unversioned-base-url" id="toc-entry-8"><span class="sectnum">3.2.2 </span>Unversioned base URL</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#version-negotiation" id="toc-entry-9"><span class="sectnum">3.3 </span>Version Negotiation</a></p></li>
<li><p><a class="reference internal" href="#index-meta-database" id="toc-entry-10"><span class="sectnum">3.4 </span>Index Meta-Database</a></p></li>
<li><p><a class="reference internal" href="#namespace-prefixes" id="toc-entry-11"><span class="sectnum">3.5 </span>Namespace Prefixes</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#database-provider-specific-namespace-prefixes" id="toc-entry-12"><span class="sectnum">3.5.1 </span>Database-Provider-Specific Namespace Prefixes</a></p></li>
<li><p><a class="reference internal" href="#definition-provider-specific-namespace-prefixes" id="toc-entry-13"><span class="sectnum">3.5.2 </span>Definition-Provider-Specific Namespace Prefixes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#url-encoding" id="toc-entry-14"><span class="sectnum">3.6 </span>URL Encoding</a></p></li>
<li><p><a class="reference internal" href="#relationships" id="toc-entry-15"><span class="sectnum">3.7 </span>Relationships</a></p></li>
<li><p><a class="reference internal" href="#properties-with-an-unknown-value" id="toc-entry-16"><span class="sectnum">3.8 </span>Properties with an unknown value</a></p></li>
<li><p><a class="reference internal" href="#handling-unknown-property-names" id="toc-entry-17"><span class="sectnum">3.9 </span>Handling unknown property names</a></p></li>
<li><p><a class="reference internal" href="#transmission-of-large-property-values" id="toc-entry-18"><span class="sectnum">3.10 </span>Transmission of large property values</a></p></li>
<li><p><a class="reference internal" href="#metadata-properties" id="toc-entry-19"><span class="sectnum">3.11 </span>Metadata properties</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#responses" id="toc-entry-20"><span class="sectnum">4 </span>Responses</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#response-format" id="toc-entry-21"><span class="sectnum">4.1 </span>Response Format</a></p></li>
<li><p><a class="reference internal" href="#json-response-schema-common-fields" id="toc-entry-22"><span class="sectnum">4.2 </span>JSON Response Schema: Common Fields</a></p></li>
<li><p><a class="reference internal" href="#http-response-status-codes" id="toc-entry-23"><span class="sectnum">4.3 </span>HTTP Response Status Codes</a></p></li>
<li><p><a class="reference internal" href="#http-response-headers" id="toc-entry-24"><span class="sectnum">4.4 </span>HTTP Response Headers</a></p></li>
<li><p><a class="reference internal" href="#warnings" id="toc-entry-25"><span class="sectnum">4.5 </span>Warnings</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#api-endpoints" id="toc-entry-26"><span class="sectnum">5 </span>API Endpoints</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#query-parameters" id="toc-entry-27"><span class="sectnum">5.1 </span>Query parameters</a></p></li>
<li><p><a class="reference internal" href="#versions-endpoint" id="toc-entry-28"><span class="sectnum">5.2 </span>Versions Endpoint</a></p></li>
<li><p><a class="reference internal" href="#entry-listing-endpoints" id="toc-entry-29"><span class="sectnum">5.3 </span>Entry Listing Endpoints</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#entry-listing-url-query-parameters" id="toc-entry-30"><span class="sectnum">5.3.1 </span>Entry Listing URL Query Parameters</a></p></li>
<li><p><a class="reference internal" href="#entry-listing-json-response-schema" id="toc-entry-31"><span class="sectnum">5.3.2 </span>Entry Listing JSON Response Schema</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#single-entry-endpoints" id="toc-entry-32"><span class="sectnum">5.4 </span>Single Entry Endpoints</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#single-entry-url-query-parameters" id="toc-entry-33"><span class="sectnum">5.4.1 </span>Single Entry URL Query Parameters</a></p></li>
<li><p><a class="reference internal" href="#single-entry-json-response-schema" id="toc-entry-34"><span class="sectnum">5.4.2 </span>Single Entry JSON Response Schema</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#info-endpoints" id="toc-entry-35"><span class="sectnum">5.5 </span>Info Endpoints</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#base-info-endpoint" id="toc-entry-36"><span class="sectnum">5.5.1 </span>Base Info Endpoint</a></p></li>
<li><p><a class="reference internal" href="#entry-listing-info-endpoints" id="toc-entry-37"><span class="sectnum">5.5.2 </span>Entry Listing Info Endpoints</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#links-endpoint" id="toc-entry-38"><span class="sectnum">5.6 </span>Links Endpoint</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#link-types" id="toc-entry-39"><span class="sectnum">5.6.1 </span>Link Types</a></p></li>
<li><p><a class="reference internal" href="#links-endpoint-json-response-schema" id="toc-entry-40"><span class="sectnum">5.6.2 </span>Links Endpoint JSON Response Schema</a></p></li>
<li><p><a class="reference internal" href="#internal-links-root-and-child-links" id="toc-entry-41"><span class="sectnum">5.6.3 </span>Internal Links: Root and Child Links</a></p></li>
<li><p><a class="reference internal" href="#list-of-providers-links" id="toc-entry-42"><span class="sectnum">5.6.4 </span>List of Providers Links</a></p></li>
<li><p><a class="reference internal" href="#index-meta-database-links-endpoint" id="toc-entry-43"><span class="sectnum">5.6.5 </span>Index Meta-Database Links Endpoint</a></p></li>
<li><p><a class="reference internal" href="#link-aggregate-options" id="toc-entry-44"><span class="sectnum">5.6.6 </span>Link Aggregate Options</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#custom-extension-endpoints" id="toc-entry-45"><span class="sectnum">5.7 </span>Custom Extension Endpoints</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#api-filtering-format-specification" id="toc-entry-46"><span class="sectnum">6 </span>API Filtering Format Specification</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#lexical-tokens" id="toc-entry-47"><span class="sectnum">6.1 </span>Lexical Tokens</a></p></li>
<li><p><a class="reference internal" href="#the-filter-language-syntax" id="toc-entry-48"><span class="sectnum">6.2 </span>The Filter Language Syntax</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#basic-boolean-operations" id="toc-entry-49"><span class="sectnum">6.2.1 </span>Basic boolean operations</a></p></li>
<li><p><a class="reference internal" href="#numeric-and-string-comparisons" id="toc-entry-50"><span class="sectnum">6.2.2 </span>Numeric and String comparisons</a></p></li>
<li><p><a class="reference internal" href="#substring-comparisons" id="toc-entry-51"><span class="sectnum">6.2.3 </span>Substring comparisons</a></p></li>
<li><p><a class="reference internal" href="#comparisons-of-boolean-values" id="toc-entry-52"><span class="sectnum">6.2.4 </span>Comparisons of boolean values</a></p></li>
<li><p><a class="reference internal" href="#comparisons-of-list-properties" id="toc-entry-53"><span class="sectnum">6.2.5 </span>Comparisons of list properties</a></p></li>
<li><p><a class="reference internal" href="#nested-property-names" id="toc-entry-54"><span class="sectnum">6.2.6 </span>Nested property names</a></p></li>
<li><p><a class="reference internal" href="#filtering-on-relationships" id="toc-entry-55"><span class="sectnum">6.2.7 </span>Filtering on relationships</a></p></li>
<li><p><a class="reference internal" href="#filtering-on-properties-with-an-unknown-value" id="toc-entry-56"><span class="sectnum">6.2.8 </span>Filtering on Properties with an unknown value</a></p></li>
<li><p><a class="reference internal" href="#precedence" id="toc-entry-57"><span class="sectnum">6.2.9 </span>Precedence</a></p></li>
<li><p><a class="reference internal" href="#type-handling-and-conversions-in-comparisons" id="toc-entry-58"><span class="sectnum">6.2.10 </span>Type handling and conversions in comparisons</a></p></li>
<li><p><a class="reference internal" href="#optional-filter-features" id="toc-entry-59"><span class="sectnum">6.2.11 </span>Optional filter features</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#property-definitions" id="toc-entry-60"><span class="sectnum">7 </span>Property Definitions</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#property-definition-keys-from-json-schema" id="toc-entry-61"><span class="sectnum">7.1 </span>Property Definition keys from JSON Schema</a></p></li>
<li><p><a class="reference internal" href="#physical-units-in-property-definitions" id="toc-entry-62"><span class="sectnum">7.2 </span>Physical Units in Property Definitions</a></p></li>
<li><p><a class="reference internal" href="#compound-unit-expressions" id="toc-entry-63"><span class="sectnum">7.3 </span>Compound Unit Expressions</a></p></li>
<li><p><a class="reference internal" href="#physical-unit-definitions" id="toc-entry-64"><span class="sectnum">7.4 </span>Physical Unit Definitions</a></p></li>
<li><p><a class="reference internal" href="#prefixes-and-constants" id="toc-entry-65"><span class="sectnum">7.5 </span>Prefixes and constants</a></p></li>
<li><p><a class="reference internal" href="#unrecognized-keys-in-property-definitions" id="toc-entry-66"><span class="sectnum">7.6 </span>Unrecognized keys in property definitions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#entry-list" id="toc-entry-67"><span class="sectnum">8 </span>Entry List</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#properties-used-by-multiple-entry-types" id="toc-entry-68"><span class="sectnum">8.1 </span>Properties Used by Multiple Entry Types</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#id" id="toc-entry-69"><span class="sectnum">8.1.1 </span>id</a></p></li>
<li><p><a class="reference internal" href="#type" id="toc-entry-70"><span class="sectnum">8.1.2 </span>type</a></p></li>
<li><p><a class="reference internal" href="#immutable-id" id="toc-entry-71"><span class="sectnum">8.1.3 </span>immutable_id</a></p></li>
<li><p><a class="reference internal" href="#last-modified" id="toc-entry-72"><span class="sectnum">8.1.4 </span>last_modified</a></p></li>
<li><p><a class="reference internal" href="#custom-properties" id="toc-entry-73"><span class="sectnum">8.1.5 </span>Custom properties</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#structures-entries" id="toc-entry-74"><span class="sectnum">8.2 </span>Structures Entries</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#elements" id="toc-entry-75"><span class="sectnum">8.2.1 </span>elements</a></p></li>
<li><p><a class="reference internal" href="#nelements" id="toc-entry-76"><span class="sectnum">8.2.2 </span>nelements</a></p></li>
<li><p><a class="reference internal" href="#elements-ratios" id="toc-entry-77"><span class="sectnum">8.2.3 </span>elements_ratios</a></p></li>
<li><p><a class="reference internal" href="#chemical-formula-descriptive" id="toc-entry-78"><span class="sectnum">8.2.4 </span>chemical_formula_descriptive</a></p></li>
<li><p><a class="reference internal" href="#chemical-formula-reduced" id="toc-entry-79"><span class="sectnum">8.2.5 </span>chemical_formula_reduced</a></p></li>
<li><p><a class="reference internal" href="#chemical-formula-hill" id="toc-entry-80"><span class="sectnum">8.2.6 </span>chemical_formula_hill</a></p></li>
<li><p><a class="reference internal" href="#chemical-formula-anonymous" id="toc-entry-81"><span class="sectnum">8.2.7 </span>chemical_formula_anonymous</a></p></li>
<li><p><a class="reference internal" href="#dimension-types" id="toc-entry-82"><span class="sectnum">8.2.8 </span>dimension_types</a></p></li>
<li><p><a class="reference internal" href="#nperiodic-dimensions" id="toc-entry-83"><span class="sectnum">8.2.9 </span>nperiodic_dimensions</a></p></li>
<li><p><a class="reference internal" href="#lattice-vectors" id="toc-entry-84"><span class="sectnum">8.2.10 </span>lattice_vectors</a></p></li>
<li><p><a class="reference internal" href="#space-group-symmetry-operations-xyz" id="toc-entry-85"><span class="sectnum">8.2.11 </span>space_group_symmetry_operations_xyz</a></p></li>
<li><p><a class="reference internal" href="#space-group-symbol-hall" id="toc-entry-86"><span class="sectnum">8.2.12 </span>space_group_symbol_hall</a></p></li>
<li><p><a class="reference internal" href="#space-group-symbol-hermann-mauguin" id="toc-entry-87"><span class="sectnum">8.2.13 </span>space_group_symbol_hermann_mauguin</a></p></li>
<li><p><a class="reference internal" href="#space-group-symbol-hermann-mauguin-extended" id="toc-entry-88"><span class="sectnum">8.2.14 </span>space_group_symbol_hermann_mauguin_extended</a></p></li>
<li><p><a class="reference internal" href="#space-group-it-number" id="toc-entry-89"><span class="sectnum">8.2.15 </span>space_group_it_number</a></p></li>
<li><p><a class="reference internal" href="#cartesian-site-positions" id="toc-entry-90"><span class="sectnum">8.2.16 </span>cartesian_site_positions</a></p></li>
<li><p><a class="reference internal" href="#nsites" id="toc-entry-91"><span class="sectnum">8.2.17 </span>nsites</a></p></li>
<li><p><a class="reference internal" href="#species-at-sites" id="toc-entry-92"><span class="sectnum">8.2.18 </span>species_at_sites</a></p></li>
<li><p><a class="reference internal" href="#species" id="toc-entry-93"><span class="sectnum">8.2.19 </span>species</a></p></li>
<li><p><a class="reference internal" href="#assemblies" id="toc-entry-94"><span class="sectnum">8.2.20 </span>assemblies</a></p></li>
<li><p><a class="reference internal" href="#structure-features" id="toc-entry-95"><span class="sectnum">8.2.21 </span>structure_features</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#calculations-entries" id="toc-entry-96"><span class="sectnum">8.3 </span>Calculations Entries</a></p></li>
<li><p><a class="reference internal" href="#references-entries" id="toc-entry-97"><span class="sectnum">8.4 </span>References Entries</a></p></li>
<li><p><a class="reference internal" href="#files-entries" id="toc-entry-98"><span class="sectnum">8.5 </span>Files Entries</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#url" id="toc-entry-99"><span class="sectnum">8.5.1 </span>url</a></p></li>
<li><p><a class="reference internal" href="#url-stable-until" id="toc-entry-100"><span class="sectnum">8.5.2 </span>url_stable_until</a></p></li>
<li><p><a class="reference internal" href="#name" id="toc-entry-101"><span class="sectnum">8.5.3 </span>name</a></p></li>
<li><p><a class="reference internal" href="#size" id="toc-entry-102"><span class="sectnum">8.5.4 </span>size</a></p></li>
<li><p><a class="reference internal" href="#media-type" id="toc-entry-103"><span class="sectnum">8.5.5 </span>media_type</a></p></li>
<li><p><a class="reference internal" href="#version" id="toc-entry-104"><span class="sectnum">8.5.6 </span>version</a></p></li>
<li><p><a class="reference internal" href="#modification-timestamp" id="toc-entry-105"><span class="sectnum">8.5.7 </span>modification_timestamp</a></p></li>
<li><p><a class="reference internal" href="#description" id="toc-entry-106"><span class="sectnum">8.5.8 </span>description</a></p></li>
<li><p><a class="reference internal" href="#checksums" id="toc-entry-107"><span class="sectnum">8.5.9 </span>checksums</a></p></li>
<li><p><a class="reference internal" href="#atime" id="toc-entry-108"><span class="sectnum">8.5.10 </span>atime</a></p></li>
<li><p><a class="reference internal" href="#ctime" id="toc-entry-109"><span class="sectnum">8.5.11 </span>ctime</a></p></li>
<li><p><a class="reference internal" href="#mtime" id="toc-entry-110"><span class="sectnum">8.5.12 </span>mtime</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#custom-entry-types" id="toc-entry-111"><span class="sectnum">8.6 </span>Custom Entry Types</a></p></li>
<li><p><a class="reference internal" href="#relationships-used-by-multiple-entry-types" id="toc-entry-112"><span class="sectnum">8.7 </span>Relationships Used by Multiple Entry Types</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#references" id="toc-entry-113"><span class="sectnum">8.7.1 </span>References</a></p></li>
<li><p><a class="reference internal" href="#calculations" id="toc-entry-114"><span class="sectnum">8.7.2 </span>Calculations</a></p></li>
<li><p><a class="reference internal" href="#files" id="toc-entry-115"><span class="sectnum">8.7.3 </span>Files</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#appendices" id="toc-entry-116"><span class="sectnum">9 </span>Appendices</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#the-filter-language-ebnf-grammar" id="toc-entry-117"><span class="sectnum">9.1 </span>The Filter Language EBNF Grammar</a></p></li>
<li><p><a class="reference internal" href="#regular-expressions-for-optimade-filter-tokens" id="toc-entry-118"><span class="sectnum">9.2 </span>Regular Expressions for OPTIMADE Filter Tokens</a></p></li>
<li><p><a class="reference internal" href="#the-symmetry-operation-string-regular-expressions" id="toc-entry-119"><span class="sectnum">9.3 </span>The Symmetry Operation String Regular Expressions</a></p></li>
<li><p><a class="reference internal" href="#optimade-json-lines-partial-data-format" id="toc-entry-120"><span class="sectnum">9.4 </span>OPTIMADE JSON lines partial data format</a></p>
<ul class="auto-toc">
<li><p><a class="reference internal" href="#examples" id="toc-entry-121"><span class="sectnum">9.4.1 </span>Examples</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#property-definition-example" id="toc-entry-122"><span class="sectnum">9.5 </span>Property Definition Example</a></p></li>
<li><p><a class="reference internal" href="#optimade-regular-expression-format" id="toc-entry-123"><span class="sectnum">9.6 </span>OPTIMADE Regular Expression Format</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#toc-entry-1" role="doc-backlink"><span class="sectnum">1 </span>Introduction</a></h2>
<p>As researchers create independent materials databases, much can be gained from retrieving data from multiple databases.
However, automating the retrieval of data is difficult if each database has a different application programming interface (API).
This document specifies a standard API for retrieving data from materials databases.
This API specification has been developed over a series of workshops entitled &quot;Open Databases Integration for Materials Design&quot;, held at the Lorentz Center in Leiden, Netherlands and the CECAM headquarters in Lausanne, Switzerland.</p>
<p>The API specification described in this document builds on top of the <a class="reference external" href="https://jsonapi.org/format/1.1/">JSON:API v1.1 specification</a>.
More specifically, it defines specific <a class="reference external" href="https://jsonapi.org/format/1.1/#semantics">implementation semantics</a> allowed by the JSON:API standard, but which go beyond the restrictions imposed on <a class="reference external" href="https://jsonapi.org/format/1.1/#profile-rules">JSON:API profiles</a> and <a class="reference external" href="https://jsonapi.org/format/1.1/#extension-rules">extensions</a>.
The JSON:API specification is assumed to apply wherever it is stricter than what is formulated in this document.
Exceptions to this rule are stated explicitly (e.g. non-compliant responses are tolerated if a non-standard response format is explicitly requested).</p>
</section>
<section id="definition-of-terms">
<h2><a class="toc-backref" href="#toc-entry-2" role="doc-backlink"><span class="sectnum">2 </span>Definition of Terms</a></h2>
<p>The keywords &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be interpreted as described in <a class="reference external" href="https://tools.ietf.org/html/rfc2119.html">RFC 2119</a>.</p>
<dl class="simple">
<dt><strong>Database provider</strong></dt>
<dd><p>A service that provides one or more databases with data desired to be made available using the OPTIMADE API.</p>
</dd>
<dt><strong>Database-provider-specific prefix</strong></dt>
<dd><p>Every database provider is designated a unique prefix.
The prefix is used to separate the namespaces used by provider-specific extensions.
The list of presently defined prefixes is maintained externally from this specification.
For more information, see section <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>.</p>
</dd>
<dt><strong>Definition provider</strong></dt>
<dd><p>A service that provides one or more external or domain-specific property definitions that can be used by OPTIMADE API implementations.</p>
</dd>
<dt><strong>Definition provider prefix</strong></dt>
<dd><p>Every definition provider is designated a prefix that cannot clash with an existing database provider prefix.
The prefix is used to separate the namespaces used by these collections of definitions.
The list of presently defined prefixes is maintained externally from this specification.
For more information, see section <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>.</p>
</dd>
<dt><strong>API implementation</strong></dt>
<dd><p>A realization of the OPTIMADE API that a database provider uses to serve data from one or more databases.</p>
</dd>
<dt><strong>Identifier</strong></dt>
<dd><p>Names that MUST start with a lowercase letter ([a-z]) or an underscore (&quot;_&quot;) followed by any number of lowercase alphanumerics ([a-z0-9]) and underscores (&quot;_&quot;).</p>
</dd>
<dt><strong>Base URL</strong></dt>
<dd><p>The topmost URL under which the API is served. See section <a class="reference internal" href="#base-url">Base URL</a>.</p>
</dd>
<dt><strong>Versioned base URL</strong></dt>
<dd><p>A URL formed by the base URL plus a path segment indicating a version of the API. See section <a class="reference internal" href="#base-url">Base URL</a>.</p>
</dd>
<dt><strong>Entry</strong></dt>
<dd><p>A single instance of a specific type of resource served by the API implementation.
For example, a <span class="entry docutils literal">structures</span> entry is comprised by data that belong to a single structure.</p>
</dd>
<dt><strong>Entry type</strong></dt>
<dd><p>Entries are categorized into types, e.g., <span class="entry docutils literal">structures</span>, <span class="entry docutils literal">calculations</span>, <span class="entry docutils literal">references</span>.
Entry types MUST be named according to the rules for identifiers.</p>
</dd>
<dt><strong>Entry property</strong></dt>
<dd><p>One data item which belongs to an entry, e.g., the chemical formula of a structure.</p>
</dd>
<dt><strong>Entry property name</strong></dt>
<dd><p>The name of an entry property.
Entry property names MUST follow the rules for identifiers and MUST NOT have the same name as any of the entry types.</p>
</dd>
<dt><strong>Relationship</strong></dt>
<dd><p>Any entry can have one or more relationships with other entries.
These are described in section <a class="reference internal" href="#relationships">Relationships</a>.
Relationships describe links between entries rather than data that belong to a single entry, and are thus regarded as distinct from the entry properties.</p>
</dd>
<dt><strong>Query filter</strong></dt>
<dd><p>An expression used to influence the entries returned in the response to a URL query.
The filter is specified using the URL query parameter <span class="query-param docutils literal">filter</span>
using a format described in the section <a class="reference internal" href="#api-filtering-format-specification">API Filtering Format Specification</a>.</p>
</dd>
<dt><strong>Queryable property</strong></dt>
<dd><p>An entry property that can be referred to in the filtering of results.
See section <a class="reference internal" href="#api-filtering-format-specification">API Filtering Format Specification</a> for more information on formulating filters on properties.
The section <a class="reference internal" href="#entry-list">Entry List</a> specifies the REQUIRED level of query support for different properties.
If nothing is specified, any support for queries is OPTIONAL.</p>
</dd>
<dt><strong>ID</strong></dt>
<dd><p>The ID entry property is a unique string referencing a specific entry in the database.
The following constraints and conventions apply to IDs:</p>
<ul class="simple">
<li><p>Taken together, the ID and entry type MUST uniquely identify the entry.</p></li>
<li><p>Reasonably short IDs are encouraged and SHOULD NOT be longer than 255 characters.</p></li>
<li><p>IDs MAY change over time.</p></li>
</ul>
</dd>
<dt><strong>Immutable ID</strong></dt>
<dd><p>A unique string that specifies a specific resource in a database.
The string MUST NOT change over time.</p>
</dd>
<dt><strong>Response format</strong></dt>
<dd><p>The data format for the HTTP response, which can be selected using the <span class="query-param docutils literal">response_format</span> URL query parameter.
For more info, see section <a class="reference internal" href="#response-format">Response Format</a>.</p>
</dd>
<dt><strong>Field</strong></dt>
<dd><p>The key used in response formats that return data in associative-array-type data structures.
This is particularly relevant for the default JSON-based response format.
In this case, <strong>field</strong> refers to the name part of the name-value pairs of JSON objects.</p>
</dd>
</dl>
<section id="data-types">
<h3><a class="toc-backref" href="#toc-entry-3" role="doc-backlink"><span class="sectnum">2.1 </span>Data types</a></h3>
<p>An API implementation handles data types and their representations in three different contexts:</p>
<ul class="simple">
<li><p>In the HTTP URL query filter, see section <a class="reference internal" href="#api-filtering-format-specification">API Filtering Format Specification</a>.</p></li>
<li><p>In the HTTP response. The default response format is JSON-based and thus uses JSON data types.
However, other response formats can use different data types.
For more info, see section <a class="reference internal" href="#responses">Responses</a>.</p></li>
<li><p>The underlying database backend(s) from which the implementation serves data.</p></li>
</ul>
<p>Hence, entry properties are described in this proposal using
context-independent types that are assumed to have some form of
representation in all contexts. They are as follows:</p>
<ul class="simple">
<li><p>Basic types: <strong>string</strong>, <strong>integer</strong>, <strong>float</strong>, <strong>boolean</strong>, <strong>timestamp</strong>.</p></li>
<li><p><strong>list</strong>: an ordered collection of items, where all items are of the same type, unless they are unknown.
A list can be empty, i.e., contain no items.</p></li>
<li><p><strong>dictionary</strong>: an associative array of <strong>keys</strong> and <strong>values</strong>, where <strong>keys</strong> are pre-determined strings, i.e., for the same entry property, the <strong>keys</strong> remain the same among different entries whereas the <strong>values</strong> change.
The <strong>values</strong> of a dictionary can be any basic type, list, dictionary, or unknown.</p></li>
</ul>
<p>An entry property value that is not present in the database is <strong>unknown</strong>.
This is equivalently expressed by the statement that the value of that entry property is <span class="val docutils literal">null</span>.
For more information see section <a class="reference internal" href="#properties-with-an-unknown-value">Properties with an unknown value</a></p>
<p>The definition of a property of an entry type specifies a type. The value of that property MUST either have a value of that type, or be unknown.</p>
</section>
</section>
<section id="general-api-requirements-and-conventions">
<h2><a class="toc-backref" href="#toc-entry-4" role="doc-backlink"><span class="sectnum">3 </span>General API Requirements and Conventions</a></h2>
<section id="versioning-of-this-standard">
<h3><a class="toc-backref" href="#toc-entry-5" role="doc-backlink"><span class="sectnum">3.1 </span>Versioning of this standard</a></h3>
<p>This standard describes a communication protocol that, when implemented by a server, provides clients with an API for data access.</p>
<p>Released versions of the standard are versioned using <a class="reference external" href="https://semver.org/spec/v2.0.0.html">semantic versioning v2</a> in reference to changes in <em>that API</em> (i.e., not in the server-side implementation of the protocol).</p>
<p>To clarify: semantic versioning mandates version numbers of the form MAJOR.MINOR.PATCH, where a &quot;backwards incompatible API change&quot; requires incrementing the MAJOR version number.
A future version of the OPTIMADE standard can mandate servers to change their behavior to be compliant with the newer version.
However, such changes are only considered &quot;backwards incompatible API changes&quot; if they have the potential to break clients that correctly use the API according to the earlier version.</p>
<p>Furthermore, the addition of new keys in key-value-formatted responses of the OPTIMADE API are not regarded as &quot;backwards incompatible API changes.&quot;
Hence, a client MUST disregard unrecognized keys when interpreting responses (but MAY issue warnings about them).
On the other hand, a change of the OPTIMADE standard that fundamentally alters the interpretation of a response due to the presence of a new key will be regarded as a &quot;backwards incompatible API change&quot; since a client interpreting the response according to a prior version of the standard would misinterpret that response.</p>
<p>Working copies distributed as part of the development of the standard are marked with the version number for the release they are based on with an additional &quot;~develop&quot; suffix.
These &quot;versions&quot; do not refer to a single specific instance of the text (i.e., the same &quot;~develop&quot; version string is retained until a release), nor is it clear to what degree they contain backwards incompatible API changes.
Hence, the suffix is intentionally designed to make these version strings not to conform with semantic versioning to prevent incorrect comparisons to released versions using the scheme prescribed by semantic versioning.
Version strings with a &quot;~develop&quot; suffix MAY be used by implementations during testing.
However, a client that encounters them unexpectedly SHOULD NOT make any assumptions about the level of API compatibility.</p>
<p>In conclusion, the versioning policy of this standard is designed to allow clients using the OPTIMADE API according to a specific version of the standard to assume compatibility with servers implementing any future (non-development) version of the standard sharing the same MAJOR version number.</p>
</section>
<section id="base-url">
<h3><a class="toc-backref" href="#toc-entry-6" role="doc-backlink"><span class="sectnum">3.2 </span>Base URL</a></h3>
<p>Each database provider will publish one or more <strong>base URLs</strong> that serve the API, for example: <a class="reference external" href="http://example.com/optimade/">http://example.com/optimade/</a>.
Every URL path segment that follows the base URL MUST behave as standardized in this API specification.</p>
<section id="versioned-base-urls">
<h4><a class="toc-backref" href="#toc-entry-7" role="doc-backlink"><span class="sectnum">3.2.1 </span>Versioned base URLs</a></h4>
<p>Access to the API is primarily provided under <strong>versioned base URLs</strong>.
An implementation MUST provide access to the API under a URL where the first path segment appended to the base URL is <span class="query-url docutils literal">/vMAJOR</span>, where <span class="val docutils literal">MAJOR</span> is one of the major version numbers of the API that the implementation supports.
This URL MUST serve the <em>latest</em> minor/patch version supported by the implementation.
For example, the latest minor and patch version of major version 1 of the API is served under <span class="query-url docutils literal">/v1</span>.</p>
<p>An implementation MAY also provide versioned base URLs on the forms <span class="query-url docutils literal">/vMAJOR.MINOR</span> and <span class="query-url docutils literal">/vMAJOR.MINOR.PATCH</span>.
Here, <span class="val docutils literal">MINOR</span> is the minor version number and <span class="val docutils literal">PATCH</span> is the patch version number of the API.
A URL on the form  <span class="query-url docutils literal">/vMAJOR.MINOR</span> MUST serve the <em>latest</em> patch version supported by the implementation of this minor version.</p>
<p>API versions that are published with a suffix, e.g., <span class="val docutils literal"><span class="pre">-rc&lt;number&gt;</span></span> to indicate a release candidate version, SHOULD be served on versioned base URLs without this suffix.</p>
<p>If a request is made to a versioned base URL that begins with <span class="query-url docutils literal">/v</span> and an integer followed by any other characters, indicating a version that the implementation does not recognize or support, the implementation SHOULD respond with the custom HTTP server error status code <span class="http-error docutils literal">553 Version Not Supported</span>, preferably along with a user-friendly error message that directs the client to adapt the request to a version it provides.</p>
<p>It is the intent that future versions of this standard will not assign different meanings to URLs that begin with <span class="query-url docutils literal">/v</span> and an integer followed by other characters.
Hence, a client can safely attempt to access a specific version of the API via the corresponding versioned base URL.
For other forms of version negotiation, see section <a class="reference internal" href="#version-negotiation">Version Negotiation</a>.</p>
<p>Examples of valid versioned base URLs:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://example.com/optimade/v0/">http://example.com/optimade/v0/</a></p></li>
<li><p><a class="reference external" href="http://example.com/v0.9.1/">http://example.com/v0.9.1/</a></p></li>
<li><p><a class="reference external" href="http://example.com/v1/">http://example.com/v1/</a></p></li>
</ul>
<p>Examples of invalid versioned base URLs:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://example.com/optimade/0.9/">http://example.com/optimade/0.9/</a></p></li>
<li><p><a class="reference external" href="http://example.com/optimade/">http://example.com/optimade/</a></p></li>
</ul>
<p>Database providers SHOULD strive to implement the latest released version of this standard, as well as the latest patch version of any major and minor version they support.</p>
<p>Note: The base URLs and versioned base URLs themselves are not considered part of the API, and the standard does not specify the response for a request to them.
However, it is RECOMMENDED that implementations serve a human-readable HTML document on base URLs and versioned base URLs, which explains that the URL is an OPTIMADE URL meant to be queried by an OPTIMADE client.</p>
</section>
<section id="unversioned-base-url">
<h4><a class="toc-backref" href="#toc-entry-8" role="doc-backlink"><span class="sectnum">3.2.2 </span>Unversioned base URL</a></h4>
<p>Implementations MAY also provide access to the API on the <strong>unversioned base URL</strong> as described in this subsection.</p>
<p>Access via the unversioned URL is primarily intended for (i) convenience when manually interacting with the API, and (ii) to provide version agnostic permanent links to resource objects.
Clients that perform automated processing of responses SHOULD access the API via versioned base URLs.</p>
<p>Implementations serving the API on the unversioned base URL have a few alternative options:</p>
<ol class="arabic simple">
<li><p>Direct access MAY be provided to the full API.</p></li>
<li><p>Requests to endpoints under the unversioned base URL MAY be redirected using an HTTP 307 temporary redirect to the corresponding endpoints under a versioned base URL.</p></li>
<li><p>Direct access MAY be limited to only single entry endpoints (see section <a class="reference internal" href="#single-entry-endpoints">Single Entry Endpoints</a>), i.e., so that this form of access is only available for permanent links to resource objects.</p></li>
</ol>
<p>Implementations MAY combine direct access to single entry endpoints with redirects for other API queries.</p>
<p>The client MAY provide a query parameter <span class="query-param docutils literal">api_hint</span> to hint the server about a preferred API version.
When this parameter is provided, the request is to be handled as described in section <a class="reference internal" href="#version-negotiation">Version Negotiation</a>, which allows a &quot;best suitable&quot; version of the API to be selected to serve the request (or forward the request to).
However, if <span class="query-param docutils literal">api_hint</span> is not provided, the implementation SHOULD serve (or redirect to) its preferred version of the API (i.e., the latest, most mature, and stable version).
In this case, that version MUST also be the first version in the response of the <span class="endpoint docutils literal">versions</span> endpoint (see section <a class="reference internal" href="#versions-endpoint">Versions Endpoint</a>).</p>
<blockquote>
<p><strong>For implementers</strong>: Before enabling access to the API on unversioned base URLs, implementers are advised to consider that an upgrade of the major version of the API served this way can change the behaviors of associated endpoints in ways that are not backward compatible.</p>
</blockquote>
</section>
</section>
<section id="version-negotiation">
<h3><a class="toc-backref" href="#toc-entry-9" role="doc-backlink"><span class="sectnum">3.3 </span>Version Negotiation</a></h3>
<p>The OPTIMADE API provides three concurrent mechanisms for version negotiation between client and server.</p>
<ol class="arabic simple">
<li><p>The <span class="endpoint docutils literal">versions</span> endpoint served directly under the unversioned base URL allows a client to discover all major API versions supported by a server in the order of preference (see section <a class="reference internal" href="#versions-endpoint">Versions Endpoint</a>).</p></li>
<li><p>A client can access the API under versioned base URLs.
In this case, the server MUST respond according to the specified version or return an error if the version is not supported (see section <a class="reference internal" href="#versioned-base-urls">Versioned Base URLs</a>).</p></li>
<li><p>When accessing the API under the unversioned base URL, clients are encouraged to append the OPTIONAL query parameter <span class="query-param docutils literal">api_hint</span> to hint the server about a preferred API version for the request.
This parameter is described in more detail below.</p></li>
</ol>
<p>The <span class="query-param docutils literal">api_hint</span> query parameter MUST be accepted by all API endpoints.
However, for endpoints under a versioned base URL the request MUST be served as usual according to the version specified in the URL path segment regardless of the value of <span class="query-param docutils literal">api_hint</span>.
In this case, the server MAY issue a warning if the value of <span class="query-param docutils literal">api_hint</span> suggests that the query may not be properly supported.
If the client provides the parameter, the value SHOULD have the format <span class="val docutils literal">vMAJOR</span> or <span class="val docutils literal">vMAJOR.MINOR</span>, where MAJOR is a major version and MINOR is a minor version of the API.
For example, if a client appends <span class="query-string docutils literal">api_hint=v1.0</span> to the query string, the hint provided is for major version 1 and minor version 0.</p>
<p>If the server supports the major version indicated by the <span class="query-param docutils literal">api_hint</span> parameter at the same or a higher minor version (if provided), it SHOULD serve the request using this version.
If the server does not support the major version hinted, or if it supports the major version but only at a minor version below the one hinted, it MAY use the provided values to make a best-effort attempt at still serving the request, e.g., by invoking the closest supported version of the API.
If the hinted version is not supported by the server and the request is not served using an alternative version, the server SHOULD respond with the custom HTTP server error status code <span class="http-error docutils literal">553 Version Not Supported</span>.
Note that the above protocol means that clients MUST NOT expect that a returned response is served according to the version that is hinted.</p>
<blockquote>
<p><strong>For end users</strong>: Users are strongly encouraged to include the <span class="query-param docutils literal">api_hint</span> query parameter for URLs in, e.g., journal publications for queries on endpoints under the unversioned base URL.
The version hint will make it possible to serve such queries in a reasonable way even after the server changes the major API version used for requests without version hints.</p>
</blockquote>
</section>
<section id="index-meta-database">
<h3><a class="toc-backref" href="#toc-entry-10" role="doc-backlink"><span class="sectnum">3.4 </span>Index Meta-Database</a></h3>
<p>A database provider MAY publish a special Index Meta-Database base URL. The main purpose of this base URL is to allow for automatic discoverability of all databases of the provider. Thus, it acts as a meta-database for the database provider's implementation(s).</p>
<p>The index meta-database MUST only provide the <span class="endpoint docutils literal">info</span> and <span class="endpoint docutils literal">links</span> endpoints, see sections <a class="reference internal" href="#info-endpoints">Info Endpoints</a> and <a class="reference internal" href="#links-endpoint">Links Endpoint</a>.
It MUST NOT expose any entry listing endpoints (e.g., <span class="endpoint docutils literal">structures</span>).</p>
<p>These endpoints do not need to be queryable, i.e., they MAY be provided as static JSON files.
However, they MUST return the correct and updated information on all currently provided implementations.</p>
<p>The <span class="field docutils literal">is_index</span> field under <span class="field docutils literal">attributes</span> as well as the <span class="field docutils literal">relationships</span> field, MUST be included in the <span class="endpoint docutils literal">info</span> endpoint for the index meta-database (see section <a class="reference internal" href="#base-info-endpoint">Base Info Endpoint</a>).
The value for <span class="field docutils literal">is_index</span> MUST be <span class="field-val docutils literal">true</span>.</p>
<p>A few suggestions and mandatory requirements of the OPTIMADE specification are specifically relaxed <strong>only for index meta-databases</strong> to make it possible to serve them in the form of static files on restricted third-party hosting platforms:</p>
<ul class="simple">
<li><p>When serving an index meta-database in the form of static files, it is RECOMMENDED that the response excludes the subfields in the top-level <span class="field docutils literal">meta</span> field that would need to be dynamically generated (as described in the section <a class="reference internal" href="#json-response-schema-common-fields">JSON Response Schema: Common Fields</a>.)
The motivation is that static files cannot keep dynamic fields such as <span class="field docutils literal">time_stamp</span> updated.</p></li>
<li><p>The <a class="reference external" href="http://jsonapi.org/format/1.1">JSON:API specification</a> requirements on content negotiation using the HTTP headers <span class="http-header docutils literal"><span class="pre">Content-Type</span></span> and <span class="http-header docutils literal">Accept</span> are NOT mandatory for index meta-databases.
Hence, API Implementations MAY ignore the content of these headers and respond to all requests.
The motivation is that static file hosting is typically not flexible enough to support these requirements on HTTP headers.</p></li>
<li><p>API implementations SHOULD serve JSON content with either the JSON:API mandated HTTP header <span class="http-header docutils literal"><span class="pre">Content-Type:</span> application/vnd.api+json</span> or <span class="http-header docutils literal"><span class="pre">Content-Type:</span> application/json</span>. However, if the hosting platform does not allow this, JSON content MAY be served with <span class="http-header docutils literal"><span class="pre">Content-Type:</span> text/plain</span>.</p></li>
</ul>
<!--  -->
<blockquote>
<p><strong>Note</strong>: A list of database and definition providers acknowledged by the <strong>Open Databases Integration for Materials Design</strong> consortium is maintained externally from this specification and can be retrieved as described in section <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>.
This list is also machine-readable, enabling the automatic discoverability of OPTIMADE API services.</p>
</blockquote>
</section>
<section id="namespace-prefixes">
<h3><a class="toc-backref" href="#toc-entry-11" role="doc-backlink"><span class="sectnum">3.5 </span>Namespace Prefixes</a></h3>
<p>There are two mechanisms by which a provider can serve properties that are not standardized by the OPTIMADE specification.</p>
<ol class="arabic simple">
<li><p>By serving properties under a database-provider-specific namespace prefix.
This is the preferred mechanism for serving properties that are specific to a particular database provider.</p></li>
<li><p>By adopting a property definition external to the specification by a definition provider.
This is the preferred mechanism in cases where a database-specific field aligns with a field that is already defined by a definition provider, and can be used to enable aggregated filtering over all OPTIMADE APIs that support this property.</p></li>
</ol>
<p>A list of known database and definition providers and their assigned prefixes is published in the form of an OPTIMADE Index Meta-Database with base URL <a class="reference external" href="https://providers.optimade.org">https://providers.optimade.org</a>.
Visiting this URL in a web browser gives a human-readable description of how to retrieve the information in the form of a JSON file, and specifies the procedure for registration of new prefixes.
A human-readable dashboard is also hosted at <a class="reference external" href="https://www.optimade.org/providers-dashboard">https://www.optimade.org/providers-dashboard</a>.</p>
<p>API implementations SHOULD NOT make up and use new prefixes without first getting them registered in the official list.</p>
<p><strong>Examples</strong>:</p>
<ul class="simple">
<li><p>A database-provider-specific prefix: <span class="docutils literal">exmpl</span>. Used as a field name in a response: <span class="field docutils literal">_exmpl_custom_field</span>.</p></li>
<li><p>A definition-provider prefix: <span class="docutils literal">dft</span>. Used as a field name in a response by multiple different providers: <span class="field docutils literal">_dft_cell_volume</span> (note: this is a hypothetical example).</p></li>
</ul>
<p>The initial underscore indicates an identifier that is under a separate namespace under the ownership of that organization or definition provider.
Identifiers prefixed with underscores will not be used for standardized names.</p>
<section id="database-provider-specific-namespace-prefixes">
<h4><a class="toc-backref" href="#toc-entry-12" role="doc-backlink"><span class="sectnum">3.5.1 </span>Database-Provider-Specific Namespace Prefixes</a></h4>
<p>This standard refers to database-provider-specific prefixes and database providers.</p>
<p>Database-provider-specific fields only need to be consistent within the context of one particular database.
Providers that serve multiple databases MAY use the same provider-specific field names with different meanings in different databases.
For example, a provider may use the field <span class="field docutils literal">_exmpl_band_gap</span> to mean a computed band gap in one their databases, and a measured band gap in another database.</p>
<p>Database-provider-specific fields SHOULD be fully described at the relevant <span class="endpoint docutils literal"><span class="pre">/info/&lt;entry_type&gt;</span></span> endpoint (see section <a class="reference internal" href="#entry-listing-info-endpoints">Entry Listing Info Endpoints</a>)</p>
</section>
<section id="definition-provider-specific-namespace-prefixes">
<h4><a class="toc-backref" href="#toc-entry-13" role="doc-backlink"><span class="sectnum">3.5.2 </span>Definition-Provider-Specific Namespace Prefixes</a></h4>
<p>This standard refers to definition-provider-specific prefixes and definition providers.</p>
<p>Definition providers MUST provide a canonical property definition for all custom fields they define using the OPTIMADE <a class="reference internal" href="#property-definitions">Property Definitions</a> format.
Definition providers MUST also list these definitions in the relevant <span class="endpoint docutils literal"><span class="pre">/info/&lt;entry_type&gt;</span></span> endpoint of the index meta-database for that provider.
They MAY also provide human-readable webpages for their definitions.</p>
<p>Definition-provider-specific fields MAY be fully described at the relevant <span class="endpoint docutils literal"><span class="pre">/info/&lt;entry_type&gt;</span></span> endpoint (see section <a class="reference internal" href="#entry-listing-info-endpoints">Entry Listing Info Endpoints</a>), but can also rely on the canonical definitions provided by the definition provider, provided they return an <span class="docutils literal">$id</span> for the field that resolves to the relevant OPTIMADE property definition.</p>
</section>
</section>
<section id="url-encoding">
<h3><a class="toc-backref" href="#toc-entry-14" role="doc-backlink"><span class="sectnum">3.6 </span>URL Encoding</a></h3>
<p>Clients SHOULD encode URLs according to <a class="reference external" href="https://tools.ietf.org/html/rfc3986.html">RFC 3986</a>.
API implementations MUST decode URLs according to <a class="reference external" href="https://tools.ietf.org/html/rfc3986.html">RFC 3986</a>.</p>
</section>
<section id="relationships">
<h3><a class="toc-backref" href="#toc-entry-15" role="doc-backlink"><span class="sectnum">3.7 </span>Relationships</a></h3>
<p>The API implementation MAY describe many-to-many relationships between entries along with OPTIONAL human-readable descriptions that describe each relationship.
These relationships can be to the same, or to different, entry types.
Response formats have to encode these relationships in ways appropriate for each format.</p>
<p>In the default response format, relationships are encoded as <a class="reference external" href="https://jsonapi.org/format/1.1/#document-resource-object-relationships">JSON:API Relationships</a>, see section <a class="reference internal" href="#entry-listing-json-response-schema">Entry Listing JSON Response Schema</a>.</p>
<blockquote>
<p><strong>For implementers</strong>: For database-specific response formats without a dedicated mechanism to indicate relationships, it is suggested that they are encoded alongside the entry properties.
For each entry type, the relationships with entries of that type can then be encoded in a field with the name of the entry type, which are to contain a list of the IDs of the referenced entries alongside the respective human-readable description of the relationships.
It is the intent that future versions of this standard uphold the viability of this encoding by not standardizing property names that overlap with the entry type names.</p>
</blockquote>
</section>
<section id="properties-with-an-unknown-value">
<h3><a class="toc-backref" href="#toc-entry-16" role="doc-backlink"><span class="sectnum">3.8 </span>Properties with an unknown value</a></h3>
<p>Many databases allow specific data values to exist for some of the entries, whereas for others, no data value is present.
This is referred to as the property having an <em>unknown</em> value, or equivalently, that the property value is <span class="val docutils literal">null</span>.</p>
<p>The text in this section describes how the API handles properties with the value <span class="val docutils literal">null</span>.
The use of <span class="val docutils literal">null</span> values inside nested property values (such as, e.g., lists or dictionaries) are described in the definitions of those data structures elsewhere in the specification, see section <a class="reference internal" href="#entry-list">Entry List</a>.
For these properties, <span class="val docutils literal">null</span> MAY carry a special meaning.</p>
<p>REQUIRED properties with an unknown value MUST be included and returned in the response with the value <span class="val docutils literal">null</span>.</p>
<p>OPTIONAL properties with an unknown value, if requested explicitly via the <span class="query-param docutils literal">response_fields</span> query parameter, MUST be included and returned in the response with the value <span class="val docutils literal">null</span>.
(For more info on the <span class="query-param docutils literal">response_fields</span> query parameter, see section <a class="reference internal" href="#entry-listing-url-query-parameters">Entry Listing URL Query Parameters</a>.)</p>
<p>The interaction of properties with an unknown value with query filters is described in the section <a class="reference internal" href="#filtering-on-properties-with-an-unknown-value">Filtering on Properties with an unknown value</a>.
In particular, filters with <span class="filter-fragment docutils literal">IS UNKNOWN</span> and <span class="filter-fragment docutils literal">IS KNOWN</span> can be used to match entries with values that are, or are not, unknown for some property, respectively.</p>
</section>
<section id="handling-unknown-property-names">
<h3><a class="toc-backref" href="#toc-entry-17" role="doc-backlink"><span class="sectnum">3.9 </span>Handling unknown property names</a></h3>
<p>When an implementation receives a request with a query filter that refers to an unknown property name it is handled differently depending on the database-specific prefix:</p>
<ul class="simple">
<li><p>If the property name has no database-specific prefix, or if it has the database-specific prefix that belongs to the implementation itself, the error <span class="http-error docutils literal">400 Bad Request</span> MUST be returned with a message indicating the offending property name.</p></li>
<li><p>If the property name has a database-specific prefix that does <em>not</em> belong to the implementation itself, it MUST NOT treat this as an error, but rather MUST evaluate the query with the property treated as unknown, i.e., comparisons are evaluated as if the property has the value <span class="val docutils literal">null</span>.</p>
<ul>
<li><p>Furthermore, if the implementation does not recognize the prefix at all, it SHOULD return a warning that indicates that the property has been handled as unknown.</p></li>
<li><p>On the other hand, if the prefix is recognized, i.e., as belonging to a known database provider, the implementation SHOULD NOT issue a warning but MAY issue diagnostic output with a note explaining how the request was handled.</p></li>
</ul>
</li>
</ul>
<p>The rationale for treating properties from other databases as unknown rather than triggering an error is for OPTIMADE to support queries using database-specific properties that can be sent to multiple databases.</p>
<p>For example, the following query can be sent to API implementations <span class="docutils literal">exmpl1</span> and <span class="docutils literal">exmpl2</span> without generating any errors:</p>
<p><code class="filter">filter=_exmpl1_band_gap&lt;2.0 OR _exmpl2_band_gap&lt;2.5</code></p>
</section>
<section id="transmission-of-large-property-values">
<h3><a class="toc-backref" href="#toc-entry-18" role="doc-backlink"><span class="sectnum">3.10 </span>Transmission of large property values</a></h3>
<p>A property value may be too large to fit in a single response.
OPTIMADE provides a mechanism for a client to handle such properties by fetching them in separate series of requests.
It is up to the implementation to decide which values are too large to represent in a single response, and this decision MAY change between responses.</p>
<p>In this case, the response to the initial query gives the value <span class="val docutils literal">null</span> for the property.
A list of one or more data URLs together with their respective partial data formats are given in the response.
How this list is provided is response format-dependent.
For the JSON response format, see the description of the <span class="field docutils literal">partial_data_links</span> field, nested under <span class="field docutils literal">data</span> and then <span class="field docutils literal">meta</span>, in the section <a class="reference internal" href="#json-response-schema-common-fields">JSON Response Schema: Common Fields</a>.</p>
<p>The default partial data format is named &quot;jsonlines&quot; and is described in the Appendix <a class="reference internal" href="#optimade-json-lines-partial-data-format">OPTIMADE JSON lines partial data format</a>.
An implementation SHOULD always include this format as one of the partial data formats provided for a property that has been omitted from the response to the initial query.
Implementations MAY provide links to their own non-standard formats, but non-standard format names MUST be prefixed by a database-provider-specific prefix.</p>
<p>Below follows an example of the <span class="field docutils literal">data</span> and <span class="field docutils literal">meta</span> parts of a response using the JSON response format that communicates that the property value has been omitted from the response, with three different links for different partial data formats provided.</p>
<pre class="code jsonc literal-block"><code>{
  // ...
  &quot;data&quot;: {
    &quot;type&quot;: &quot;structures&quot;,
    &quot;id&quot;: &quot;2345678&quot;,
    &quot;attributes&quot;: {
        &quot;a&quot;: null
    }
    &quot;meta&quot;: {
      &quot;partial_data_links&quot;: {
        &quot;a&quot;: [
          {
            &quot;format&quot;: &quot;jsonlines&quot;,
            &quot;link&quot;: &quot;https://example.org/optimade/v1.2/extensions/partial_data/structures/2345678/a/default_format&quot;
          },
          {
            &quot;format&quot;: &quot;_exmpl_bzip2_jsonlines&quot;,
            &quot;link&quot;: &quot;https://db.example.org/assets/partial_values/structures/2345678/a/bzip2_format&quot;
          },
          {
            &quot;format&quot;: &quot;_exmpl_hdf5&quot;,
            &quot;link&quot;: &quot;https://cloud.example.org/ACCHSORJGIHWOSJZG&quot;
          }
        ]
      }
    }
  }
  // ...
}</code></pre>
</section>
<section id="metadata-properties">
<h3><a class="toc-backref" href="#toc-entry-19" role="doc-backlink"><span class="sectnum">3.11 </span>Metadata properties</a></h3>
<p>A metadata property represents entry and property-specific metadata for a given entry.
How these are communicated in the response depends on the response format.
For the JSON response format, the metadata properties are stored in the resource object metadata field, <span class="field docutils literal">meta</span> in a dictionary field <span class="field docutils literal">property_metadata</span> with the keys equal to the names of the respective properties for which metadata is available, see <a class="reference internal" href="#json-response-schema-common-fields">JSON Response Schema: Common Fields</a>.</p>
<p>The format of the metadata property is specified by the field <span class="field docutils literal"><span class="pre">x-optimade-metadata-definition</span></span> in the Property Definition of the field, see <a class="reference internal" href="#property-definitions">Property Definitions</a>.
Database providers are allowed to define their own metadata properties in <span class="field docutils literal"><span class="pre">x-optimade-metadata-definition</span></span>, but they MUST use the database-provider-specific prefix even for metadata of database-specific fields.
For example, the metadata property definition of the field <span class="field docutils literal">_exmpl_example_field</span> MUST NOT define a metadata field named, e.g., <span class="field docutils literal">accuracy</span>; the field rather needs to be named, e.g., <span class="field docutils literal">_exmpl_accuracy</span>.
The reason for this limitation is to avoid name collisions with metadata fields defined by the OPTIMADE standard in the future that apply also to database-specific data fields.</p>
<p>Implementation of the <span class="field docutils literal">meta</span> field is OPTIONAL.
However, when an implementation supports the <span class="field docutils literal">property_metadata</span> field, it SHOULD include metadata fields for all properties which have metadata and are present in the data part of the response.</p>
<p>Example of a response in the JSON response format with two structure entries that each include a metadata property for the attribute field <span class="field docutils literal">elements_ratios</span> and the database-specific per entry metadata field <span class="field docutils literal">_exmpl_originates_from_project</span>:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: [
    {
      &quot;type&quot;: &quot;structures&quot;,
      &quot;id&quot;: &quot;example.db:structs:0001&quot;,
      &quot;attributes&quot;: {
        &quot;elements_ratios&quot;:[0.33336, 0.22229, 0.44425]
      },
      &quot;meta&quot;: {
        &quot;property_metadata&quot;: {
          &quot;elements_ratios&quot;: {
            &quot;_exmpl_originates_from_project&quot;: &quot;piezoelectic_perovskites&quot;
          }
        }
      }
    },
    {
      &quot;type&quot;: &quot;structures&quot;,
      &quot;id&quot;: &quot;example.db:structs:1234&quot;,
      &quot;attributes&quot;: {
        &quot;elements_ratios&quot;:[0.5, 0.5]
      },
      &quot;meta&quot;: {
        &quot;property_metadata&quot;:{
          &quot;elements_ratios&quot;: {
            &quot;_exmpl_originates_from_project&quot;: &quot;ferroelectric_binaries&quot;
          }
        }
      }
    }
    //...
  ]
  // ...
}</code></pre>
<p>Example of the corresponding metadata property definition contained in the field <span class="field docutils literal"><span class="pre">x-optimade-metadata-definition</span></span> which is placed in the property definition of <span class="field docutils literal">elements_ratios</span>:</p>
<pre class="code jsonc literal-block"><code>// ...
&quot;x-optimade-metadata-definition&quot;: {
  &quot;title&quot;: &quot;Metadata for the elements_ratios field&quot;,
  &quot;description&quot;: &quot;This field contains the per-entry metadata for the elements_ratios field.&quot;,
  &quot;x-optimade-type&quot;: &quot;dictionary&quot;,
  &quot;x-optimade-unit&quot;: &quot;inapplicable&quot;,
  &quot;type&quot;: [&quot;object&quot;, &quot;null&quot;],
  &quot;properties&quot; : {
    &quot;_exmpl_originates_from_project&quot;: {
      &quot;$id&quot;: &quot;https://properties.example.com/v1.2.0/elements_ratios_meta/_exmpl_originates_from_project&quot;,
      &quot;description&quot; : &quot;A string naming the internal example.com project id where this property was added to the database.&quot;,
      &quot;x-optimade-type&quot;: &quot;string&quot;,
      &quot;x-optimade-unit&quot; : &quot;inapplicable&quot;,
      &quot;type&quot;: [&quot;string&quot;, &quot;null&quot;]
    }
  }
}
// ...</code></pre>
</section>
</section>
<section id="responses">
<h2><a class="toc-backref" href="#toc-entry-20" role="doc-backlink"><span class="sectnum">4 </span>Responses</a></h2>
<section id="response-format">
<h3><a class="toc-backref" href="#toc-entry-21" role="doc-backlink"><span class="sectnum">4.1 </span>Response Format</a></h3>
<p>This section defines a JSON response format that complies with the <a class="reference external" href="http://jsonapi.org/format/1.1">JSON:API v1.1</a> specification.
All endpoints of an API implementation MUST be able to provide responses in the JSON format specified below and MUST respond in this format by default.</p>
<p>Each endpoint MAY support additional formats, and SHOULD declare these formats under the endpoint <span class="endpoint docutils literal"><span class="pre">/info/&lt;entry</span> type&gt;</span> (see section <a class="reference internal" href="#entry-listing-info-endpoints">Entry Listing Info Endpoints</a>).
Clients can request these formats using the <span class="query-param docutils literal">response_format</span> URL query parameter.
Specifying a <span class="query-param docutils literal">response_format</span> different from <span class="query-val docutils literal">json</span> (e.g. <span class="query-string docutils literal">response_format=xml</span>) allows the API to break conformance not only with the JSON response format specification, but also, e.g., in terms of how content negotiation is implemented.</p>
<p>Database-provider-specific and definition-provider-specific <span class="query-param docutils literal">response_format</span> identifiers MUST include the corresponding prefix (see section <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>).</p>
</section>
<section id="json-response-schema-common-fields">
<h3><a class="toc-backref" href="#toc-entry-22" role="doc-backlink"><span class="sectnum">4.2 </span>JSON Response Schema: Common Fields</a></h3>
<p>In the JSON response format, property types translate as follows:</p>
<ul class="simple">
<li><p><strong>string</strong>, <strong>boolean</strong>, <strong>list</strong> are represented by their similarly named counterparts in JSON.</p></li>
<li><p><strong>integer</strong>, <strong>float</strong> are represented as the JSON number type.</p></li>
<li><p><strong>timestamp</strong> uses a string representation of date and time as defined in <a class="reference external" href="https://tools.ietf.org/html/rfc3339#section-5.6">RFC 3339 Internet Date/Time Format</a>.</p></li>
<li><p><strong>dictionary</strong> is represented by the JSON object type.</p></li>
<li><p><strong>unknown</strong> properties are represented by either omitting the property or by a JSON <span class="field-val docutils literal">null</span> value.</p></li>
</ul>
<p>Every response SHOULD contain the following fields, and MUST contain at least <span class="field docutils literal">meta</span>:</p>
<ul>
<li><p><strong>meta</strong>: a <a class="reference external" href="https://jsonapi.org/format/1.1/#document-meta">JSON:API meta member</a> that contains JSON:API meta objects of non-standard meta-information.
It MUST be a dictionary with these fields:</p>
<ul class="simple">
<li><p><strong>api_version</strong>: a string containing the full version of the API implementation.
The version number string MUST NOT be prefixed by, e.g., &quot;v&quot;.
Examples: <span class="field-val docutils literal">1.0.0</span>, <span class="field-val docutils literal"><span class="pre">1.0.0-rc.2</span></span>.</p></li>
<li><p><strong>query</strong>: information on the query that was requested.
It MUST be a dictionary with this field:</p>
<ul>
<li><p><strong>representation</strong>: a string with the part of the URL following the versioned or unversioned base URL that serves the API.
Query parameters that have not been used in processing the request MAY be omitted.
In particular, if no query parameters have been involved in processing the request, the query part of the URL MAY be excluded.
Example: <span class="field-val docutils literal"><span class="pre">/structures?filter=nelements=2</span></span>.</p></li>
</ul>
</li>
<li><p><strong>more_data_available</strong>: <span class="field-val docutils literal">false</span> if the response contains all data for the request (e.g., a request issued to a single entry endpoint, or a <span class="query-param docutils literal">filter</span> query at the last page of a paginated response) and <span class="field-val docutils literal">true</span> if the response is incomplete in the sense that multiple objects match the request, and not all of them have been included in the response (e.g., a query with multiple pages that is not at the last page).</p></li>
</ul>
<p><span class="field docutils literal">meta</span> SHOULD also include these fields:</p>
<ul>
<li><p><strong>time_stamp</strong>: a timestamp containing the date and time at which the query was executed.</p></li>
<li><p><strong>data_returned</strong>: an integer containing the total number of data resource objects returned for the current <span class="query-param docutils literal">filter</span> query, independent of pagination.</p></li>
<li><p><strong>provider</strong>: information on the database provider of the implementation.
It MUST be a dictionary with these fields:</p>
<ul class="simple">
<li><p><strong>name</strong>: a short name for the database provider.</p></li>
<li><p><strong>description</strong>: a longer description of the database provider.</p></li>
<li><p><strong>prefix</strong>: database-provider-specific prefix (see section <a class="reference internal" href="#database-provider-specific-namespace-prefixes">Database-Provider-Specific Namespace Prefixes</a>).</p></li>
</ul>
<p><span class="field docutils literal">provider</span> MAY include these fields:</p>
<ul class="simple">
<li><p><strong>homepage</strong>: a <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON API link</a>, pointing to the homepage of the database provider, either directly as a string, or as an object which can contain the following fields:</p>
<ul>
<li><p><strong>href</strong>: a string containing the homepage URL.</p></li>
<li><p><strong>meta</strong>: a meta object containing non-standard meta-information about the database provider's homepage.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><span class="field docutils literal">meta</span> MAY also include these fields:</p>
<ul>
<li><p><strong>data_available</strong>: an integer containing the total number of data resource objects available in the database for the endpoint.</p></li>
<li><p><strong>last_id</strong>: a string containing the last ID returned.</p></li>
<li><p><strong>response_message</strong>: response string from the server.</p></li>
<li><p><strong>request_delay</strong>: a non-negative float giving time in seconds that the client is suggested to wait before issuing a subsequent request.</p>
<p>Implementation note: the functionality of this field overlaps to some degree with features provided by the HTTP error <span class="http-error docutils literal">429 Too Many Requests</span> and the <a class="reference external" href="https://tools.ietf.org/html/rfc7231.html#section-7.1.3">Retry-After HTTP header</a>.
Implementations are suggested to provide consistent handling of request overload through both mechanisms.</p>
</li>
<li><p><strong>database</strong>: a dictionary describing the specific database accessible at this OPTIMADE API.
If provided, the dictionary fields SHOULD match those provided in the corresponding links entry for the database in the provider's index meta-database, outlined in <a class="reference internal" href="#links-endpoint-json-response-schema">Links Endpoint JSON Response Schema</a>.
The dictionary can contain the following OPTIONAL fields:</p>
<ul class="simple">
<li><p><strong>id</strong>: the identifier of this database within those served by this provider, i.e., the ID under which this database is served in this provider's index meta-database.</p></li>
<li><p><strong>name</strong>: a human-readable name for the database, e.g., for use in clients.</p></li>
<li><p><strong>version</strong>: a string describing the version of the database.</p></li>
<li><p><strong>description</strong>: a human-readable description of the database, e.g., for use in clients.</p></li>
<li><p><strong>homepage</strong>: a <a class="reference external" href="http://jsonapi.org/format/1.0/#document-links">JSON API link</a>, pointing to a homepage for the particular database.</p></li>
<li><p><strong>maintainer</strong>: a dictionary providing details about the maintainer of the database, which MUST contain the single field:</p>
<ul>
<li><p><strong>email</strong> with the maintainer's email address.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>implementation</strong>: a dictionary describing the server implementation, containing the OPTIONAL fields:</p>
<ul class="simple">
<li><p><strong>name</strong>: name of the implementation.</p></li>
<li><p><strong>version</strong>: version string of the current implementation.</p></li>
<li><p><strong>homepage</strong>: a <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON API link</a>, pointing to the homepage of the implementation.</p></li>
<li><p><strong>source_url</strong>: a <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON API link</a> pointing to the implementation source, either downloadable archive or version control system.</p></li>
<li><p><strong>maintainer</strong>: a dictionary providing details about the maintainer of the implementation, MUST contain the single field:</p>
<ul>
<li><p><strong>email</strong> with the maintainer's email address.</p></li>
</ul>
</li>
<li><p><strong>issue_tracker</strong>: a <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON API link</a> pointing to the implementation's issue tracker.</p></li>
</ul>
</li>
<li><p><strong>warnings</strong>: a list of warning resource objects representing non-critical errors or warnings.
A warning resource object is defined similarly to a <a class="reference external" href="http://jsonapi.org/format/1.1/#error-objects">JSON:API error object</a>, but MUST also include the field <span class="field docutils literal">type</span>, which MUST have the value <span class="field-val docutils literal">&quot;warning&quot;</span>.
The field <span class="field docutils literal">detail</span> MUST be present and SHOULD contain a non-critical message, e.g., reporting unrecognized search attributes or deprecated features.
The field <span class="field docutils literal">status</span>, representing an HTTP response status code, MUST NOT be present for a warning resource object.
This is an exclusive field for error resource objects.</p>
<p>Example for a deprecation warning:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;id&quot;: &quot;dep_chemical_formula_01&quot;,
  &quot;type&quot;: &quot;warning&quot;,
  &quot;code&quot;: &quot;_exmpl_dep_chemical_formula&quot;,
  &quot;title&quot;: &quot;Deprecation Warning&quot;,
  &quot;detail&quot;: &quot;chemical_formula is deprecated, use instead chemical_formula_hill&quot;
}</code></pre>
<p><strong>Note</strong>: warning <span class="field docutils literal">id</span>s MUST NOT be trusted to identify the exceptional situations (i.e., they are not error codes), use instead the field <span class="field docutils literal">code</span> for this.
Warning <span class="field docutils literal">id</span>s can <em>only</em> be trusted to be unique in the list of warning resource objects, i.e., together with the <span class="field docutils literal">type</span>.</p>
<p>General OPTIMADE warning codes are specified in section <a class="reference internal" href="#warnings">Warnings</a>.</p>
</li>
<li><p>Other OPTIONAL additional information <em>global to the query</em> that is not specified in this document, MUST start with a database-provider-specific prefix (see section <a class="reference internal" href="#database-provider-specific-namespace-prefixes">Database-Provider-Specific Namespace Prefixes</a>).</p></li>
<li><p>Example for a request made to <span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/structures/?filter=a=1</span> AND b=2</span>:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;meta&quot;: {
    &quot;query&quot;: {
      &quot;representation&quot;: &quot;/structures/?filter=a=1 AND b=2&quot;
    },
    &quot;api_version&quot;: &quot;1.0.0&quot;,
    &quot;schema&quot;: &quot;http://schemas.optimade.org/openapi/v1/optimade.json&quot;,
    &quot;time_stamp&quot;: &quot;2007-04-05T14:30:20Z&quot;,
    &quot;data_returned&quot;: 10,
    &quot;data_available&quot;: 10,
    &quot;more_data_available&quot;: false,
    &quot;provider&quot;: {
      &quot;name&quot;: &quot;Example provider&quot;,
      &quot;description&quot;: &quot;Provider used for examples, not to be assigned to a real database&quot;,
      &quot;prefix&quot;: &quot;exmpl&quot;,
      &quot;homepage&quot;: &quot;http://example.com&quot;
    },
    &quot;implementation&quot;: {
      &quot;name&quot;: &quot;exmpl-optimade&quot;,
      &quot;version&quot;: &quot;0.1.0&quot;,
      &quot;source_url&quot;: &quot;http://git.example.com/exmpl-optimade&quot;,
      &quot;maintainer&quot;: {
        &quot;email&quot;: &quot;admin&#64;example.com&quot;
      },
      &quot;issue_tracker&quot;: &quot;http://tracker.example.com/exmpl-optimade&quot;
    },
    &quot;database&quot;: {
      &quot;id&quot;: &quot;example_db&quot;,
      &quot;name&quot;: &quot;Example database 1 (of many)&quot;,
      &quot;description&quot;: &quot;The first example database in a series hosted by the Example Provider.&quot;,
      &quot;homepage&quot;: &quot;http://database_one.example.com&quot;,
      &quot;maintainer&quot;: {
        &quot;email&quot;: &quot;science_lead&#64;example.com&quot;
      }
    }
  }
  // ...
}</code></pre>
</li>
<li><p><strong>schema</strong>: a <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON:API links object</a> that points to a schema for the response.
If it is a string, or a dictionary containing no <span class="field docutils literal">meta</span> field, the provided URL MUST point at an <a class="reference external" href="https://swagger.io/specification/">OpenAPI</a> schema.
It is possible that future versions of this specification allow for alternative schema types.
Hence, if the <span class="field docutils literal">meta</span> field of the JSON:API links object is provided and contains a field <span class="field docutils literal">schema_type</span> that is not equal to the string <span class="field-val docutils literal">OpenAPI</span> the client MUST NOT handle failures to parse the schema or to validate the response against the schema as errors.</p>
<blockquote>
<p><strong>Note</strong>: The <span class="field docutils literal">schema</span> field was previously RECOMMENDED in all responses, but is now demoted to being OPTIONAL since there now is a standard way of specifying a response schema in JSON:API through the <span class="field docutils literal">describedby</span> subfield of the top-level <span class="field docutils literal">links</span> field.</p>
</blockquote>
</li>
</ul>
</li>
<li><p><strong>data</strong>: The schema of this value varies by endpoint, it can be either a <em>single</em> <a class="reference external" href="http://jsonapi.org/format/1.1/#document-resource-objects">JSON:API resource object</a> or a <em>list</em> of JSON:API resource objects.
Every resource object needs the <span class="field docutils literal">type</span> and <span class="field docutils literal">id</span> fields, and its attributes (described in section <a class="reference internal" href="#api-endpoints">API Endpoints</a>) need to be in a dictionary corresponding to the <span class="field docutils literal">attributes</span> field.</p>
<p>Every resource object MAY also contain a <span class="field docutils literal">meta</span> field which MAY contain the following keys:</p>
<ul>
<li><p><strong>property_metadata</strong>: an object containing per-entry and per-property metadata.
The keys are the names of the fields in <span class="field docutils literal">attributes</span> for which metadata is available.
The values belonging to these keys are dictionaries containing the relevant metadata fields.
See also <a class="reference internal" href="#metadata-properties">Metadata properties</a></p></li>
<li><p><strong>partial_data_links</strong>: an object used to list links which can be used to fetch data that has been omitted from the <span class="field docutils literal">data</span> part of the response.
The keys are the names of the fields in <span class="field docutils literal">attributes</span> for which partial data links are available.
Each value is a list of objects that MUST have the following keys:</p>
<ul class="simple">
<li><p><strong>format</strong>: String.
The name of the format provided via this link.
For one of the objects this <span class="field docutils literal">format</span> field SHOULD have the value &quot;jsonlines&quot;, which refers to the format in <a class="reference internal" href="#optimade-json-lines-partial-data-format">OPTIMADE JSON lines partial data format</a>.</p></li>
<li><p><strong>link</strong>: String.
A <a class="reference external" href="http://jsonapi.org/format/1.0/#document-links">JSON API link</a> that points to a location from which the omitted data can be fetched.
There is no requirement on the syntax or format for the link URL.</p></li>
</ul>
<p>For more information about the mechanism to transmit large property values, including an example of the format of <span class="field docutils literal">partial_data_links</span>, see <a class="reference internal" href="#transmission-of-large-property-values">Transmission of large property values</a>.</p>
</li>
</ul>
</li>
</ul>
<p>The response MAY also return resources related to the primary data in the field:</p>
<ul>
<li><p><strong>links</strong>: a <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON API links object</a> is REQUIRED for implementing pagination.
(see section <a class="reference internal" href="#entry-listing-url-query-parameters">Entry Listing URL Query Parameters</a>.)
Each field of a links object, i.e., a &quot;link&quot;, MUST be one of:</p>
<ul class="simple">
<li><p><span class="field-val docutils literal">null</span></p></li>
<li><p>a string representing a URI, or</p></li>
<li><p>a dictionary (&quot;link object&quot;) with fields</p>
<ul>
<li><p><strong>href</strong>: a string representing a URI</p></li>
<li><p><strong>meta</strong>: (OPTIONAL) a meta object containing non-standard meta-information about the link</p></li>
</ul>
</li>
</ul>
<p>Example links objects:</p>
<ul>
<li><p><strong>base_url</strong>: a links object representing the base URL of the implementation. Example:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;links&quot;: {
    &quot;base_url&quot;: {
      &quot;href&quot;: &quot;http://example.com/optimade&quot;,
      &quot;meta&quot;: {
        &quot;_exmpl_db_version&quot;: &quot;3.2.1&quot;
      }
    }
    // ...
  }
  // ...
}</code></pre>
</li>
</ul>
<p>The <span class="field docutils literal">links</span> field SHOULD include the following links objects:</p>
<ul>
<li><p><strong>describedby</strong>: a links object giving the URL for a schema that describes the response.
The URL SHOULD resolve into a JSON formatted response returning a JSON object with top level <span class="field docutils literal">$schema</span> and/or <span class="field docutils literal">$id</span> fields that can be used by the client to identify the schema format.</p>
<blockquote>
<p><strong>Note</strong>: This field is the standard facility in JSON:API to communicate a response schema.
It overlaps in function with the field <span class="field docutils literal">schema</span> in the top level <span class="field docutils literal">meta</span> field.</p>
</blockquote>
</li>
</ul>
<p>The following fields are REQUIRED for implementing pagination:</p>
<ul class="simple">
<li><p><strong>next</strong>: represents a link to fetch the next set of results.
When the current response is the last page of data, this field MUST be either omitted or <span class="field-val docutils literal">null</span>-valued.</p></li>
</ul>
<p>An implementation MAY also use the following reserved fields for pagination.
They represent links in a similar way as for <span class="field docutils literal">next</span>.</p>
<ul class="simple">
<li><p><strong>prev</strong>: the previous page of data. <span class="field-val docutils literal">null</span> or omitted when the current response is the first page of data.</p></li>
<li><p><strong>last</strong>: the last page of data.</p></li>
<li><p><strong>first</strong>: the first page of data.</p></li>
</ul>
<p>Finally, the <span class="field docutils literal">links</span> field MAY also include the following links object:</p>
<ul class="simple">
<li><p><strong>self</strong>: a links object giving the URL from which the response was obtained.</p></li>
</ul>
</li>
<li><p><strong>included</strong>: a list of <a class="reference external" href="http://jsonapi.org/format/1.1/#document-resource-objects">JSON:API resource objects</a> related to the primary data contained in <span class="field docutils literal">data</span>.
Responses that contain related resources under <span class="field docutils literal">included</span> are known as <a class="reference external" href="https://jsonapi.org/format/1.1/#document-compound-documents">compound documents</a> in the JSON:API.</p>
<p>The definition of this field is found in the <a class="reference external" href="http://jsonapi.org/format/1.1/#fetching-includes">JSON:API specification</a>.
Specifically, if the query parameter <span class="query-param docutils literal">include</span> is included in the request, <span class="field docutils literal">included</span> MUST NOT include unrequested resource objects.
For further information on the parameter <span class="query-param docutils literal">include</span>, see section <a class="reference internal" href="#entry-listing-url-query-parameters">Entry Listing URL Query Parameters</a>.</p>
<p>This value MUST be either an empty array or an array of related resource objects.</p>
</li>
</ul>
<p>If there were errors in producing the response all other fields MAY be present, but the top-level <span class="field docutils literal">data</span> field MUST be skipped, and the following field MUST be present:</p>
<ul class="simple">
<li><p><strong>errors</strong>: a list of <a class="reference external" href="http://jsonapi.org/format/1.1/#error-objects">JSON:API error objects</a>, where the field <span class="field docutils literal">detail</span> MUST be present.
All other fields are OPTIONAL.</p></li>
</ul>
<p>An example of a full response:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;links&quot;: {
    &quot;next&quot;: null,
    &quot;base_url&quot;: {
      &quot;href&quot;: &quot;http://example.com/optimade&quot;,
      &quot;meta&quot;: {
         &quot;_exmpl_db_version&quot;: &quot;3.2.1&quot;
      }
    }
  },
  &quot;meta&quot;: {
    &quot;query&quot;: {
      &quot;representation&quot;: &quot;/structures?filter=a=1 AND b=2&quot;
    },
    &quot;api_version&quot;: &quot;1.0.0&quot;,
    &quot;time_stamp&quot;: &quot;2007-04-05T14:30:20Z&quot;,
    &quot;data_returned&quot;: 10,
    &quot;data_available&quot;: 10,
    &quot;last_id&quot;: &quot;xy10&quot;,
    &quot;more_data_available&quot;: false,
    &quot;provider&quot;: {
      &quot;name&quot;: &quot;Example provider&quot;,
      &quot;description&quot;: &quot;Provider used for examples, not to be assigned to a real database&quot;,
      &quot;prefix&quot;: &quot;exmpl&quot;,
      &quot;homepage&quot;: {
        &quot;href&quot;: &quot;http://example.com&quot;,
        &quot;meta&quot;: {
          &quot;_exmpl_title&quot;: &quot;This is an example site&quot;
        }
      }
    },
    // &lt;OPTIONAL implementation- or database-provider-specific metadata, global to the query&gt;
  },
  &quot;data&quot;: [
    // ...
  ],
  &quot;included&quot;: [
    // ...
  ]
}</code></pre>
<ul>
<li><p><strong>&#64;context</strong>: A JSON-LD context that enables interpretation of data in the response as linked data.
If provided, it SHOULD be one of the following:</p>
<ul class="simple">
<li><p>An object conforming to a JSON-LD standard, which includes a <span class="field docutils literal">&#64;version</span> field specifying the version of the standard.</p></li>
<li><p>A string containing a URL that resolves to such an object.</p></li>
</ul>
</li>
<li><p><strong>jsonapi</strong>: A <a class="reference external" href="https://jsonapi.org/format/1.1/#document-jsonapi-object">JSON:API object</a>.
The <span class="field docutils literal">version</span> subfield SHOULD be <span class="field-val docutils literal">&quot;1.1&quot;</span>.
The <span class="field docutils literal">meta</span> subfield SHOULD be included and contain the following subfields:</p>
<ul class="simple">
<li><p><strong>api</strong>: A string with the value &quot;OPTIMADE&quot;.</p></li>
<li><p><strong>api-version</strong>: A string with the full version of the OPTIMADE standard that the processing and response adheres to.
This MAY be the version indicated at the top of this document, but MAY also be another version if the client, e.g., has used the query parameter <span class="query-param docutils literal">api_hint</span> to request processing according to another version.</p></li>
</ul>
<p>If the server is able to handle serialization in such a way that it can dictate the order of the top level object members in the response, it is RECOMMENDED to put the <span class="field docutils literal">jsonapi</span> as the first top level member to simplify identification of the response.</p>
</li>
</ul>
</section>
<section id="http-response-status-codes">
<h3><a class="toc-backref" href="#toc-entry-23" role="doc-backlink"><span class="sectnum">4.3 </span>HTTP Response Status Codes</a></h3>
<p>All HTTP response status codes MUST conform to <a class="reference external" href="http://tools.ietf.org/html/rfc7231">RFC 7231: HTTP Semantics</a>.
The code registry is maintained by IANA and can be found <a class="reference external" href="http://www.iana.org/assignments/http-status-codes">here</a>.</p>
<p>See also the JSON:API definitions of responses when <a class="reference external" href="https://jsonapi.org/format/1.1/#fetching">fetching</a> data, i.e., sending an HTTP GET request.</p>
<p><strong>Important</strong>: If a client receives an unexpected 404 error when making a query to a base URL, and is aware of the index meta-database that belongs to the database provider (as described in section <a class="reference internal" href="#index-meta-database">Index Meta-Database</a>), the next course of action SHOULD be to fetch the resource objects under the <span class="endpoint docutils literal">links</span> endpoint of the index meta-database and redirect the original query to the corresponding database ID that was originally queried, using the object's <span class="field docutils literal">base_url</span> value.</p>
</section>
<section id="http-response-headers">
<h3><a class="toc-backref" href="#toc-entry-24" role="doc-backlink"><span class="sectnum">4.4 </span>HTTP Response Headers</a></h3>
<p>There are relevant use-cases for allowing data served via OPTIMADE to be accessed from in-browser JavaScript, e.g. to enable server-less data aggregation.
For such use, many browsers need the server to include the header <span class="http-header docutils literal"><span class="pre">Access-Control-Allow-Origin:</span> *</span> in its responses, which indicates that in-browser JavaScript access is allowed from any site.</p>
</section>
<section id="warnings">
<h3><a class="toc-backref" href="#toc-entry-25" role="doc-backlink"><span class="sectnum">4.5 </span>Warnings</a></h3>
<p>Non-critical exceptional situations occurring in the implementation SHOULD be reported to the referrer as warnings.
Warnings MUST be expressed as a human-readable message, OPTIONALLY coupled with a warning code.</p>
<p>Warning codes starting with an alphanumeric character are reserved for general OPTIMADE error codes (currently, none are specified).
For implementation-specific warnings, they MUST start with <span class="docutils literal">_</span> and the database-provider-specific prefix of the implementation (see section <a class="reference internal" href="#database-provider-specific-namespace-prefixes">Database-Provider-Specific Namespace Prefixes</a>).</p>
</section>
</section>
<section id="api-endpoints">
<h2><a class="toc-backref" href="#toc-entry-26" role="doc-backlink"><span class="sectnum">5 </span>API Endpoints</a></h2>
<p>Access to API endpoints as described in the subsections below are to be provided under the versioned and/or the unversioned base URL as explained in the section <a class="reference internal" href="#base-url">Base URL</a>.</p>
<p>The endpoints are:</p>
<ul class="simple">
<li><p>a <span class="endpoint docutils literal">versions</span> endpoint</p></li>
<li><p>an &quot;entry listing&quot; endpoint</p></li>
<li><p>a &quot;single entry&quot; endpoint</p></li>
<li><p>an introspection <span class="endpoint docutils literal">info</span> endpoint</p></li>
<li><p>an &quot;entry listing&quot; introspection <span class="endpoint docutils literal">info</span> endpoint</p></li>
<li><p>a <span class="endpoint docutils literal">links</span> endpoint to discover related implementations</p></li>
<li><p>a custom <span class="endpoint docutils literal">extensions</span> endpoint prefix</p></li>
</ul>
<p>These endpoints are documented below.</p>
<section id="query-parameters">
<h3><a class="toc-backref" href="#toc-entry-27" role="doc-backlink"><span class="sectnum">5.1 </span>Query parameters</a></h3>
<p>Query parameters to the endpoints are documented in the respective subsections below.
However, in addition, all API endpoints MUST accept the <span class="query-param docutils literal">api_hint</span> parameter described under <a class="reference internal" href="#version-negotiation">Version Negotiation</a>.</p>
</section>
<section id="versions-endpoint">
<h3><a class="toc-backref" href="#toc-entry-28" role="doc-backlink"><span class="sectnum">5.2 </span>Versions Endpoint</a></h3>
<p>The <span class="endpoint docutils literal">versions</span> endpoint aims at providing a stable and future-proof way for a client to discover the major versions of the API that the implementation provides.
This endpoint is special in that it MUST be provided directly on the unversioned base URL at <span class="query-url docutils literal">/versions</span> and MUST NOT be provided under the versioned base URLs.</p>
<p>The response to a query to this endpoint is in a restricted subset of the <a class="reference external" href="https://tools.ietf.org/html/rfc4180.html">RFC 4180</a> CSV (<cite>text/csv; header=present</cite>) format.
The restrictions are: (i) field values and header names MUST NOT contain commas, newlines, or double quote characters; (ii) Field values and header names MUST NOT be enclosed by double quotes; (iii) The first line MUST be a header line.
These restrictions allow clients to parse the file line-by-line, where each line can be split on all occurrences of the comma ',' character to obtain the head names and field values.</p>
<p>In the present version of the API, the response contains only a single field that is used to list the major versions of the API that the implementation supports.
The CSV format header line MUST specify <span class="val docutils literal">version</span> as the name for this field.
However, clients MUST accept responses that include other fields that follow the version.</p>
<p>The major API versions in the response are to be ordered according to the preference of the API implementation.
If a version of the API is served on the unversioned base URL as described in the section <a class="reference internal" href="#base-url">Base URL</a>, that version MUST be the first value in the response (i.e., it MUST be on the second line of the response directly following the required CSV header).</p>
<p>It is the intent that all future versions of this specification retain this endpoint, its restricted CSV response format, and the meaning of the first field of the response.</p>
<p>Example response:</p>
<pre class="code CSV literal-block"><code>version
1
0</code></pre>
<p>The above response means that the API versions 1 and 0 are served under the versioned base URLs <span class="query-url docutils literal">/v1</span> and <span class="query-url docutils literal">/v0</span>, respectively.
The order of the versions indicates that the API implementation regards version 1 as preferred over version 0.
If the API implementation allows access to the API on the unversioned base URL, this access has to be to version 1, since the number 1 appears in the first (non-header) line.</p>
</section>
<section id="entry-listing-endpoints">
<h3><a class="toc-backref" href="#toc-entry-29" role="doc-backlink"><span class="sectnum">5.3 </span>Entry Listing Endpoints</a></h3>
<p>Entry listing endpoints return a list of resource objects representing entries of a specific type.
For example, a list of structures, or a list of calculations.</p>
<p>Each entry in the list includes a set of properties and their corresponding values.
The section <a class="reference internal" href="#entry-list">Entry list</a> specifies properties as belonging to one of three categories:</p>
<ol class="arabic simple">
<li><p>Properties marked as REQUIRED in the response.
These properties MUST always be present for all entries in the response.</p></li>
<li><p>Properties marked as REQUIRED only if the query parameter <span class="query-param docutils literal">response_fields</span> is not part of the request, or if they are explicitly requested in <span class="query-param docutils literal">response_fields</span>.
Otherwise they MUST NOT be included.
One can think of these properties as constituting a default value for <span class="query-param docutils literal">response_fields</span> when that parameter is omitted.</p></li>
<li><p>Properties not marked as REQUIRED in any case, MUST be included only if explicitly requested in the query parameter <span class="query-param docutils literal">response_fields</span>.
Otherwise they SHOULD NOT be included.</p></li>
</ol>
<p>Examples of valid entry listing endpoint URLs:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://example.com/optimade/v1/structures">http://example.com/optimade/v1/structures</a></p></li>
<li><p><a class="reference external" href="http://example.com/optimade/v1/calculations">http://example.com/optimade/v1/calculations</a></p></li>
</ul>
<p>There MAY be multiple entry listing endpoints, depending on how many types of entries an implementation provides.
Specific standard entry types are specified in section <a class="reference internal" href="#entry-list">Entry list</a>.</p>
<p>The API implementation MAY provide other entry types than the ones standardized in this specification.
Such entry types MUST be prefixed by a database-provider-specific prefix (i.e., the resource objects' <span class="property docutils literal">type</span> value should start with the database-provider-specific prefix, e.g., <span class="property docutils literal">type</span> = <span class="val docutils literal">_exmpl_workflows</span>).
Each custom entry type SHOULD be served at a corresponding entry listing endpoint under the versioned or unversioned base URL that serves the API with the same name (i.e., equal to the resource objects' <span class="property docutils literal">type</span> value, e.g., <span class="endpoint docutils literal">/_exmpl_workflows</span>).
It is RECOMMENDED to align with the OPTIMADE API specification practice of using a plural for entry resource types and entry type endpoints.
Any custom entry listing endpoint MUST also be added to the <span class="property docutils literal">available_endpoints</span> and <span class="property docutils literal">entry_types_by_format</span> attributes of the <a class="reference internal" href="#base-info-endpoint">Base Info Endpoint</a>.</p>
<p>For more on custom endpoints, see <a class="reference internal" href="#custom-extension-endpoints">Custom Extension Endpoints</a>.</p>
<section id="entry-listing-url-query-parameters">
<h4><a class="toc-backref" href="#toc-entry-30" role="doc-backlink"><span class="sectnum">5.3.1 </span>Entry Listing URL Query Parameters</a></h4>
<p>The client MAY provide a set of URL query parameters in order to alter the response and provide usage information. While these URL query parameters are OPTIONAL for clients, API implementations MUST accept and handle them.
To adhere to the requirement on implementation-specific URL query parameters of <a class="reference external" href="http://jsonapi.org/format/1.1">JSON:API v1.1</a>, query parameters that are not standardized by that specification have been given names that consist of at least two words separated by an underscore (a LOW LINE character '_').</p>
<p>Standard OPTIONAL URL query parameters standardized by the JSON:API specification:</p>
<ul>
<li><p><strong>filter</strong>: a filter string, in the format described below in section <a class="reference internal" href="#api-filtering-format-specification">API Filtering Format Specification</a>.</p></li>
<li><p><strong>page_limit</strong>: sets a numerical limit on the number of entries returned.
See <a class="reference external" href="https://jsonapi.org/format/1.1/#fetching-pagination">JSON:API 1.1</a>.
The API implementation MUST return no more than the number specified.
It MAY return fewer.
The database MAY have a maximum limit and not accept larger numbers (in which case the <span class="http-error docutils literal">403 Forbidden</span> error code MUST be returned).
The default limit value is up to the API implementation to decide.
Example: <span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/structures?page_limit=100</span></span></p></li>
<li><p><strong>page_{offset, number, cursor, above, below}</strong>: A server MUST implement pagination in the case of no user-specified <span class="query-param docutils literal">sort</span> parameter (via the <span class="field docutils literal">links</span> response field, see section <a class="reference internal" href="#json-response-schema-common-fields">JSON Response Schema: Common Fields</a>).
A server MAY implement pagination in concert with <span class="query-param docutils literal">sort</span>.
The following parameters, all prefixed by &quot;page_&quot;, are RECOMMENDED for use with pagination.
If an implementation chooses</p>
<ul class="simple">
<li><p><em>offset-based pagination</em>: using <span class="field docutils literal">page_offset</span> and <span class="field docutils literal">page_limit</span> is RECOMMENDED.</p></li>
<li><p><em>cursor-based pagination</em>: using <span class="field docutils literal">page_cursor</span> and <span class="field docutils literal">page_limit</span> is RECOMMENDED.</p></li>
<li><p><em>page-based pagination</em>: using <span class="field docutils literal">page_number</span> and <span class="field docutils literal">page_limit</span> is RECOMMENDED. It is RECOMMENDED that the first page has number 1, i.e., that <span class="field docutils literal">page_number</span> is 1-based.</p></li>
<li><p><em>value-based pagination</em>: using <span class="field docutils literal">page_above</span>/<span class="field docutils literal">page_below</span> and <span class="field docutils literal">page_limit</span> is RECOMMENDED.</p></li>
</ul>
<p>Examples (all OPTIONAL behavior a server MAY implement):</p>
<ul class="simple">
<li><p>skip 50 structures and fetch up to 100: <span class="query-url docutils literal"><span class="pre">/structures?page_offset=50&amp;page_limit=100</span></span>.</p></li>
<li><p>fetch page 2 of up to 50 structures per page: <span class="query-url docutils literal"><span class="pre">/structures?page_number=2&amp;page_limit=50</span></span>.</p></li>
<li><p>fetch up to 100 structures above sort-field value 4000 (in this example, server chooses to fetch results sorted by increasing <span class="field docutils literal">id</span>, so <span class="field docutils literal">page_above</span> value refers to an <span class="field docutils literal">id</span> value): <span class="query-url docutils literal"><span class="pre">/structures?page_above=4000&amp;page_limit=100</span></span>.</p></li>
</ul>
</li>
<li><p><strong>sort</strong>: If supporting sortable queries, an implementation MUST use the <span class="query-param docutils literal">sort</span> query parameter with format as specified by <a class="reference external" href="https://jsonapi.org/format/1.1/#fetching-sorting">JSON:API 1.1</a>.</p>
<p>An implementation MAY support multiple sort fields for a single query.
If it does, it again MUST conform to the JSON:API 1.1 specification.</p>
<p>If an implementation supports sorting for an <a class="reference internal" href="#entry-listing-endpoints">entry listing endpoint</a>, then the <span class="endpoint docutils literal"><span class="pre">/info/&lt;entries&gt;</span></span> endpoint MUST include, for each field name <span class="field docutils literal">&lt;fieldname&gt;</span> in its <span class="field docutils literal"><span class="pre">data.properties.&lt;fieldname&gt;</span></span> response value that can be used for sorting, the key <span class="field docutils literal">sortable</span> with value <span class="field-val docutils literal">true</span>.
If a field name under an entry listing endpoint supporting sorting cannot be used for sorting, the server MUST either leave out the <span class="field docutils literal">sortable</span> key or set it equal to <span class="field-val docutils literal">false</span> for the specific field name.
The set of field names, with <span class="field docutils literal">sortable</span> equal to <span class="field-val docutils literal">true</span> are allowed to be used in the &quot;sort fields&quot; list according to its definition in the JSON:API 1.1 specification.
The field <span class="field docutils literal">sortable</span> is in addition to each property description and other OPTIONAL fields.
An example is shown in section <a class="reference internal" href="#entry-listing-info-endpoints">Entry Listing Info Endpoints</a>.</p>
</li>
<li><p><strong>include</strong>: A server MAY implement the JSON:API concept of returning <a class="reference external" href="https://jsonapi.org/format/1.1/#document-compound-documents">compound documents</a> by utilizing the <span class="query-param docutils literal">include</span> query parameter as specified by <a class="reference external" href="https://jsonapi.org/format/1.1/#fetching-includes">JSON:API 1.0</a>.</p>
<p>All related resource objects MUST be returned as part of an array value for the top-level <span class="field docutils literal">included</span> field, see section <a class="reference internal" href="#json-response-schema-common-fields">JSON Response Schema: Common Fields</a>.</p>
<p>The value of <span class="query-param docutils literal">include</span> MUST be a comma-separated list of &quot;relationship paths&quot;, as defined in the <a class="reference external" href="https://jsonapi.org/format/1.1/#fetching-includes">JSON:API</a>.
If relationship paths are not supported, or a server is unable to identify a relationship path a <span class="http-error docutils literal">400 Bad Request</span> response MUST be made.</p>
<p>The <strong>default value</strong> for <span class="query-param docutils literal">include</span> is <span class="query-val docutils literal">references</span>.
This means <span class="entry docutils literal">references</span> entries MUST always be included under the top-level field <span class="field docutils literal">included</span> as default, since a server assumes if <span class="query-param docutils literal">include</span> is not specified by a client in the request, it is still specified as <span class="query-string docutils literal">include=references</span>.
Note, if a client explicitly specifies <span class="query-param docutils literal">include</span> and leaves out <span class="query-val docutils literal">references</span>, <span class="entry docutils literal">references</span> resource objects MUST NOT be included under the top-level field <span class="field docutils literal">included</span>, as per the definition of <span class="field docutils literal">included</span>, see section <a class="reference internal" href="#json-response-schema-common-fields">JSON Response Schema: Common Fields</a>.</p>
<blockquote>
<p><strong>Note</strong>: A query with the parameter <span class="query-param docutils literal">include</span> set to the empty string means no related resource objects are to be returned under the top-level field <span class="field docutils literal">included</span>.</p>
</blockquote>
</li>
</ul>
<p>Standard OPTIONAL URL query parameters not in the JSON:API specification:</p>
<ul class="simple">
<li><p><strong>response_format</strong>: the output format requested (see section <a class="reference internal" href="#response-format">Response Format</a>).
Defaults to the format string 'json', which specifies the standard output format described in this specification.
Example: <span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/structures?response_format=xml</span></span></p></li>
<li><p><strong>email_address</strong>: an email address of the user making the request.
The email SHOULD be that of a person and not an automatic system.
Example: <span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/structures?email_address=user&#64;example.com</span></span></p></li>
<li><p><strong>response_fields</strong>: a comma-delimited set of fields to be provided in the output.
If provided, these fields MUST be returned along with the REQUIRED fields.
Other OPTIONAL fields MUST NOT be returned when this parameter is present.
Example: <span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/structures?response_fields=last_modified,nsites</span></span></p></li>
</ul>
<p>Additional OPTIONAL URL query parameters not described above are not considered to be part of this standard, and are instead considered to be &quot;custom URL query parameters&quot;.
These custom URL query parameters MUST be of the format &quot;&lt;database-provider-specific prefix&gt;&lt;url_query_parameter_name&gt;&quot;.
These names adhere to the requirements on implementation-specific query parameters of <a class="reference external" href="http://jsonapi.org/format/1.1">JSON:API v1.1</a> since the database-provider-specific prefixes contain at least two underscores (a LOW LINE character '_').</p>
<p>Example uses of custom URL query parameters include providing an access token for the request, to tell the database to increase verbosity in error output, or providing a database-specific extended searching format.</p>
<p>Examples:</p>
<ul>
<li><p><span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/structures?_exmpl_key=A3242DSFJFEJE</span></span></p></li>
<li><p><span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/structures?_exmpl_warning_verbosity=10</span></span></p></li>
<li><p><span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/structures?_exmpl_filter=&quot;elements</span> all in [Al, Si, Ga]&quot;</span></p>
<blockquote>
<p><strong>Note</strong>: the specification presently makes no attempt to standardize access control mechanisms.
There are security concerns with access control based on URL tokens, and the above example is not to be taken as a recommendation for such a mechanism.</p>
</blockquote>
</li>
</ul>
</section>
<section id="entry-listing-json-response-schema">
<h4><a class="toc-backref" href="#toc-entry-31" role="doc-backlink"><span class="sectnum">5.3.2 </span>Entry Listing JSON Response Schema</a></h4>
<p>&quot;Entry listing&quot; endpoint response dictionaries MUST have a <span class="field docutils literal">data</span> key.
The value of this key MUST be a list containing dictionaries that represent individual entries.
In the default JSON response format every dictionary (<a class="reference external" href="http://jsonapi.org/format/1.1/#document-resource-objects">resource object</a>) MUST have the following fields:</p>
<ul>
<li><p><strong>type</strong>: field containing the Entry type as defined in section <a class="reference internal" href="#definition-of-terms">Definition of Terms</a></p></li>
<li><p><strong>id</strong>: field containing the ID of entry as defined in section <a class="reference internal" href="#definition-of-terms">Definition of Terms</a>. This can be the local database ID.</p></li>
<li><p><strong>attributes</strong>: a dictionary, containing key-value pairs representing the entry's properties, except for <span class="property docutils literal">type</span> and <span class="property docutils literal">id</span>.</p>
<p>Database-provider-specific and definition-provider-specific properties MUST include the corresponding prefix (see section <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>).</p>
</li>
</ul>
<p>OPTIONALLY it can also contain the following fields:</p>
<ul class="simple">
<li><p><strong>links</strong>: a <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON:API links object</a> can OPTIONALLY contain the field</p>
<ul>
<li><p><strong>self</strong>: the entry's URL</p></li>
</ul>
</li>
<li><p><strong>meta</strong>: a <a class="reference external" href="https://jsonapi.org/format/1.1/#document-meta">JSON API meta object</a> that is used to communicate metadata.
See <a class="reference internal" href="#json-response-schema-common-fields">JSON Response Schema: Common Fields</a> for more information about this field.</p></li>
<li><p><strong>relationships</strong>: a dictionary containing references to other entries according to the description in section <a class="reference internal" href="#relationships">Relationships</a> encoded as <a class="reference external" href="https://jsonapi.org/format/1.1/#document-resource-object-relationships">JSON:API Relationships</a>.
The OPTIONAL human-readable description of the relationship MAY be provided in the <span class="field docutils literal">description</span> field inside the <span class="field docutils literal">meta</span> dictionary of the JSON:API resource identifier object.
All relationships to entries of the same entry type MUST be grouped into the same JSON:API relationship object and placed in the relationships dictionary with the entry type name as key (e.g., <span class="entry docutils literal">structures</span>).</p></li>
</ul>
<p>Example:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: [
    {
      &quot;type&quot;: &quot;structures&quot;,
      &quot;id&quot;: &quot;example.db:structs:0001&quot;,
      &quot;attributes&quot;: {
        &quot;chemical_formula_descriptive&quot;: &quot;Es2 O3&quot;,
        &quot;url&quot;: &quot;http://example.db/structs/0001&quot;,
        &quot;immutable_id&quot;: &quot;http://example.db/structs/0001&#64;123&quot;,
        &quot;last_modified&quot;: &quot;2007-04-05T14:30:20Z&quot;
      }
    },
    {
      &quot;type&quot;: &quot;structures&quot;,
      &quot;id&quot;: &quot;example.db:structs:1234&quot;,
      &quot;attributes&quot;: {
        &quot;chemical_formula_descriptive&quot;: &quot;Es2&quot;,
        &quot;url&quot;: &quot;http://example.db/structs/1234&quot;,
        &quot;immutable_id&quot;: &quot;http://example.db/structs/1234&#64;123&quot;,
        &quot;last_modified&quot;: &quot;2007-04-07T12:02:20Z&quot;
      }
    }
    // ...
  ]
  // ...
}</code></pre>
</section>
</section>
<section id="single-entry-endpoints">
<h3><a class="toc-backref" href="#toc-entry-32" role="doc-backlink"><span class="sectnum">5.4 </span>Single Entry Endpoints</a></h3>
<p>A client can request a specific entry by appending a URL-encoded ID path segment to the URL of an entry listing endpoint. This will return properties for the entry with that ID.</p>
<p>In the default JSON response format, the ID component MUST be the content of the <span class="field docutils literal">id</span> field.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/structures/exmpl%3Astruct_3232823</span></span></p></li>
<li><p><span class="query-url docutils literal"><span class="pre">http://example.com/optimade/v1/calculations/232132</span></span></p></li>
</ul>
<p>The rules for which properties are to be present for an entry in the response are the same as defined in section <a class="reference internal" href="#entry-listing-endpoints">Entry Listing Endpoints</a>.</p>
<section id="single-entry-url-query-parameters">
<h4><a class="toc-backref" href="#toc-entry-33" role="doc-backlink"><span class="sectnum">5.4.1 </span>Single Entry URL Query Parameters</a></h4>
<p>The client MAY provide a set of additional URL query parameters for this endpoint type.
URL query parameters not recognized MUST be ignored.
While the following URL query parameters are OPTIONAL for clients, API implementations MUST accept and handle them:
<span class="query-param docutils literal">response_format</span>, <span class="query-param docutils literal">email_address</span>, <span class="query-param docutils literal">response_fields</span>.
The URL query parameter <span class="query-param docutils literal">include</span> is OPTIONAL for both clients and API implementations.
The meaning of these URL query parameters are as defined above in section <a class="reference internal" href="#entry-listing-url-query-parameters">Entry Listing URL Query Parameters</a>.</p>
</section>
<section id="single-entry-json-response-schema">
<h4><a class="toc-backref" href="#toc-entry-34" role="doc-backlink"><span class="sectnum">5.4.2 </span>Single Entry JSON Response Schema</a></h4>
<p>The response for a 'single entry' endpoint is the same as for 'entry listing' endpoint responses, except that the value of the <span class="field docutils literal">data</span> field MUST have only one or zero entries.
In the default JSON response format, this means the value of the <span class="field docutils literal">data</span> field MUST be a single response object or <span class="field-val docutils literal">null</span> if there is no response object to return.</p>
<p>Example:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;structures&quot;,
    &quot;id&quot;: &quot;example.db:structs:1234&quot;,
    &quot;attributes&quot;: {
      &quot;chemical_formula_descriptive&quot;: &quot;Es2&quot;,
      &quot;url&quot;: &quot;http://example.db/structs/1234&quot;,
      &quot;immutable_id&quot;: &quot;http://example.db/structs/1234&#64;123&quot;,
      &quot;last_modified&quot;: &quot;2007-04-07T12:02:20Z&quot;
    }
  },
  &quot;meta&quot;: {
    &quot;query&quot;: {
      &quot;representation&quot;: &quot;/structures/example.db:structs:1234?&quot;
    }
    // ...
  }
  // ...
}</code></pre>
</section>
</section>
<section id="info-endpoints">
<h3><a class="toc-backref" href="#toc-entry-35" role="doc-backlink"><span class="sectnum">5.5 </span>Info Endpoints</a></h3>
<p>Info endpoints provide introspective information, either about the API implementation itself, or about specific entry types.</p>
<p>There are two types of info endpoints:</p>
<ol class="arabic simple">
<li><p>Base info endpoints: placed directly under the versioned or unversioned base URL that serves the API (e.g., <a class="reference external" href="http://example.com/optimade/v1/info">http://example.com/optimade/v1/info</a> or <a class="reference external" href="http://example.com/optimade/info">http://example.com/optimade/info</a>)</p></li>
<li><p>Entry listing info endpoints: placed under the endpoints belonging to specific entry types (e.g., <a class="reference external" href="http://example.com/optimade/v1/info/structures">http://example.com/optimade/v1/info/structures</a> or <a class="reference external" href="http://example.com/optimade/info/structures">http://example.com/optimade/info/structures</a>)</p></li>
</ol>
<p>The types and output content of these info endpoints are described in more detail in the subsections below.
Common for them all are that the <span class="field docutils literal">data</span> field SHOULD return only a single resource object.
If no resource object is provided, the value of the <span class="field docutils literal">data</span> field MUST be <span class="field-val docutils literal">null</span>.</p>
<section id="base-info-endpoint">
<h4><a class="toc-backref" href="#toc-entry-36" role="doc-backlink"><span class="sectnum">5.5.1 </span>Base Info Endpoint</a></h4>
<p>The Info endpoint under a versioned or unversioned base URL serving the API (e.g. <a class="reference external" href="http://example.com/optimade/v1/info">http://example.com/optimade/v1/info</a> or <a class="reference external" href="http://example.com/optimade/info">http://example.com/optimade/info</a>) returns information relating to the API implementation.</p>
<p>The single resource object's response dictionary MUST include the following fields:</p>
<ul>
<li><p><strong>type</strong>: <span class="field-val docutils literal">&quot;info&quot;</span></p></li>
<li><p><strong>id</strong>: <span class="field-val docutils literal">&quot;/&quot;</span></p></li>
<li><p><strong>attributes</strong>: Dictionary containing the following fields:</p>
<ul>
<li><p><strong>api_version</strong>: Presently used full version of the OPTIMADE API.
The version number string MUST NOT be prefixed by, e.g., &quot;v&quot;.
Examples: <span class="field-val docutils literal">1.0.0</span>, <span class="field-val docutils literal"><span class="pre">1.0.0-rc.2</span></span>.</p></li>
<li><p><strong>available_api_versions</strong>: MUST be a list of dictionaries, each containing the fields:</p>
<ul class="simple">
<li><p><strong>url</strong>: a string specifying a versioned base URL that MUST adhere to the rules in section <a class="reference internal" href="#base-url">Base URL</a></p></li>
<li><p><strong>version</strong>: a string containing the full version number of the API served at that versioned base URL.
The version number string MUST NOT be prefixed by, e.g., &quot;v&quot;.
Examples: <span class="field-val docutils literal">1.0.0</span>, <span class="field-val docutils literal"><span class="pre">1.0.0-rc.2</span></span>.</p></li>
</ul>
</li>
<li><p><strong>formats</strong>: List of available output formats.</p></li>
<li><p><strong>entry_types_by_format</strong>: Available entry endpoints as a function of output formats.</p></li>
<li><p><strong>available_endpoints</strong>: List of available endpoints (i.e., the string to be appended to the versioned or unversioned base URL serving the API).</p></li>
<li><p><strong>license</strong>: A <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON API link</a> giving a URL to a web page containing a human-readable text describing the license (or licensing options if there are multiple) covering all the data and metadata provided by this database.</p>
<p>Clients are advised not to try automated parsing of this link or its content, but rather rely on the field <span class="field docutils literal">available_licenses</span> instead.
Example: <span class="field-val docutils literal"><span class="pre">https://example.com/licenses/example_license.html</span></span>.</p>
</li>
</ul>
<p><span class="field docutils literal">attributes</span> MAY also include the following OPTIONAL fields:</p>
<ul>
<li><p><strong>is_index</strong>: if <span class="field-val docutils literal">true</span>, this is an index meta-database base URL (see section <a class="reference internal" href="#index-meta-database">Index Meta-Database</a>).</p>
<p>If this member is <em>not</em> provided, the client MUST assume this is <strong>not</strong> an index meta-database base URL (i.e., the default is for <span class="field docutils literal">is_index</span> to be <span class="field-val docutils literal">false</span>).</p>
</li>
<li><p><strong>available_licenses</strong>: List of <a class="reference external" href="https://spdx.org/licenses/">SPDX license identifiers</a> specifying a set of alternative licenses available to the client for licensing the complete database, i.e., all the entries, metadata, and the content and structure of the database itself.
If more than one license is available to the client, the identifier of each one SHOULD be included in the list.
Inclusion of a license identifier in the list is a commitment of the database that the rights are in place to grant clients access to all the individual entries, all metadata, and the content and structure of the database itself according to the terms of any of these licenses (at the choice of the client).
If the licensing information provided via the field <span class="field docutils literal">license</span> omits licensing options specified in <span class="field docutils literal">available_licenses</span>, or if it otherwise contradicts them, a client MUST still be allowed to interpret the inclusion of a license in <span class="field docutils literal">available_licenses</span> as a full commitment from the database without exceptions, under the respective licenses.
If the database cannot make that commitment, e.g., if only part of the database is available under a license, the corresponding license identifier MUST NOT appear in <span class="field docutils literal">available_licenses</span> (but, rather, the field <span class="field docutils literal">license</span> is to be used to clarify the licensing situation.)
An empty list indicates that none of the SPDX licenses apply and that the licensing situation is clarified in human readable form in the field <span class="field docutils literal">license</span>.
An unknown value means that the database makes no commitment.</p></li>
<li><p><strong>available_licenses_for_entries</strong>: List of <a class="reference external" href="https://spdx.org/licenses/">SPDX license identifiers</a> specifying a set of additional alternative licenses available to the client for licensing individual, and non-substantial sets of, database entries, metadata, and extracts from the database that do not constitute substantial parts of the database.
Note that the definition of the field <span class="field docutils literal">available_licenses</span> implies that licenses specified in that field are available also for the licensing specified by this field, even if they are not explicitly included in the field <span class="field docutils literal">available_licenses_for_entries</span> or if it is <span class="val docutils literal">null</span> (however, the opposite relationship does not hold).
If <span class="field docutils literal">available_licenses</span> is unknown, only the licenses in <span class="field docutils literal">available_licenses_for_entries</span> apply.</p></li>
</ul>
</li>
</ul>
<p>If this is an index meta-database base URL (see section <a class="reference internal" href="#index-meta-database">Index Meta-Database</a>), then the response dictionary MUST also include the field:</p>
<ul>
<li><p><strong>relationships</strong>: Dictionary that MAY contain a single <a class="reference external" href="https://jsonapi.org/format/1.1/#document-resource-object-relationships">JSON:API relationships object</a>:</p>
<ul class="simple">
<li><p><strong>default</strong>: Reference to the links identifier object under the <span class="endpoint docutils literal">links</span> endpoint that the provider has chosen as their &quot;default&quot; OPTIMADE API database.
A client SHOULD present this database as the first choice when an end-user chooses this provider.
This MUST include the field:</p>
<ul>
<li><p><strong>data</strong>: <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON:API resource linkage</a>.
It MUST be either <span class="field-val docutils literal">null</span> or contain a single links identifier object with the fields:</p>
<ul>
<li><p><strong>type</strong>: <span class="field-val docutils literal">links</span></p></li>
<li><p><strong>id</strong>: ID of the provider's chosen default OPTIMADE API database.
MUST be equal to a valid child object's <span class="field docutils literal">id</span> under the <span class="field docutils literal">links</span> endpoint.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Lastly, <span class="field docutils literal">is_index</span> MUST also be included in <span class="field docutils literal">attributes</span> and be <span class="field-val docutils literal">true</span>.</p>
</li>
</ul>
<p>Example:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;info&quot;,
    &quot;id&quot;: &quot;/&quot;,
    &quot;attributes&quot;: {
      &quot;api_version&quot;: &quot;1.0.0&quot;,
      &quot;available_api_versions&quot;: [
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v0/&quot;, &quot;version&quot;: &quot;0.9.5&quot;},
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v0.9/&quot;, &quot;version&quot;: &quot;0.9.5&quot;},
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v0.9.2/&quot;, &quot;version&quot;: &quot;0.9.2&quot;},
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v0.9.5/&quot;, &quot;version&quot;: &quot;0.9.5&quot;},
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v1/&quot;, &quot;version&quot;: &quot;1.0.0&quot;},
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v1.0/&quot;, &quot;version&quot;: &quot;1.0.0&quot;}
      ],
      &quot;formats&quot;: [
        &quot;json&quot;,
        &quot;xml&quot;
      ],
      &quot;entry_types_by_format&quot;: {
        &quot;json&quot;: [
          &quot;structures&quot;,
          &quot;calculations&quot;
        ],
        &quot;xml&quot;: [
          &quot;structures&quot;
        ]
      },
      &quot;available_endpoints&quot;: [
        &quot;structures&quot;,
        &quot;calculations&quot;,
        &quot;info&quot;,
        &quot;links&quot;
      ],
      &quot;is_index&quot;: false
    }
  }
  // ...
}</code></pre>
<p>Example for an index meta-database:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;info&quot;,
    &quot;id&quot;: &quot;/&quot;,
    &quot;attributes&quot;: {
      &quot;api_version&quot;: &quot;1.0.0&quot;,
      &quot;available_api_versions&quot;: [
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v0/&quot;, &quot;version&quot;: &quot;0.9.5&quot;},
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v0.9/&quot;, &quot;version&quot;: &quot;0.9.5&quot;},
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v0.9.2/&quot;, &quot;version&quot;: &quot;0.9.2&quot;},
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v1/&quot;, &quot;version&quot;: &quot;1.0.0&quot;},
        {&quot;url&quot;: &quot;http://db.example.com/optimade/v1.0/&quot;, &quot;version&quot;: &quot;1.0.0&quot;}
        ],
      &quot;formats&quot;: [
        &quot;json&quot;,
        &quot;xml&quot;
      ],
      &quot;entry_types_by_format&quot;: {
        &quot;json&quot;: [],
        &quot;xml&quot;: []
      },
      &quot;available_endpoints&quot;: [
        &quot;info&quot;,
        &quot;links&quot;
      ],
      &quot;is_index&quot;: true
    },
    &quot;relationships&quot;: {
      &quot;default&quot;: {
        &quot;data&quot;: { &quot;type&quot;: &quot;links&quot;, &quot;id&quot;: &quot;perovskites&quot; }
      }
    }
  }
  // ...
}</code></pre>
</section>
<section id="entry-listing-info-endpoints">
<h4><a class="toc-backref" href="#toc-entry-37" role="doc-backlink"><span class="sectnum">5.5.2 </span>Entry Listing Info Endpoints</a></h4>
<p>Entry listing info endpoints are accessed under the versioned or unversioned base URL serving the API as <span class="endpoint docutils literal"><span class="pre">/info/&lt;entry_type&gt;</span></span> (e.g., <a class="reference external" href="http://example.com/optimade/v1/info/structures">http://example.com/optimade/v1/info/structures</a> or <a class="reference external" href="http://example.com/optimade/info/structures">http://example.com/optimade/info/structures</a>).
They return information related to the specific entry types served by the API.
The response for these endpoints MUST include the following information in the <span class="field docutils literal">data</span> field:</p>
<ul>
<li><p><strong>type</strong>: <span class="field-val docutils literal">&quot;info&quot;</span>.</p></li>
<li><p><strong>id</strong>: This MUST precisely match the entry type name, e.g., <span class="field-val docutils literal">&quot;structures&quot;</span> for the <span class="endpoint docutils literal">/info/structures</span>.</p></li>
<li><p><strong>description</strong>: Description of the entry.</p></li>
<li><p><strong>properties</strong>: A dictionary describing properties for this entry type, where each key is a property name and the value is an OPTIMADE Property Definition described in detail in the section <a class="reference internal" href="#property-definitions">Property Definitions</a>.</p></li>
<li><p><strong>formats</strong>: List of output formats available for this type of entry (see section <a class="reference internal" href="#response-format">Response Format</a>)</p></li>
<li><p><strong>output_fields_by_format</strong>: Dictionary of available output fields for this entry type, where the keys are the values of the <span class="field docutils literal">formats</span> list and the values are the keys of the <span class="field docutils literal">properties</span> dictionary.</p>
<blockquote>
<p><strong>Note</strong>: Future versions of the OPTIMADE API will deprecate this format and require all keys that are not <span class="field docutils literal">type</span> or <span class="field docutils literal">id</span> to be under the <span class="field docutils literal">attributes</span> key.</p>
</blockquote>
</li>
</ul>
<p>An example of the data part of the entry listing info endpoint response follows below, however, note that:</p>
<ul class="simple">
<li><p>The description strings have been wrapped for readability only (newline characters are not allowed inside JSON strings)</p></li>
<li><p>The properties in the example, 'nelements' and 'lattice_vectors', mimick OPTIMADE standard properties, but are given here with simplified definitions compared to the standard definitions for these properties.</p></li>
</ul>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;info&quot;,
    &quot;id&quot;: &quot;structures&quot;,
    &quot;description&quot;: &quot;a structures entry&quot;,
    &quot;properties&quot;: {
      &quot;nelements&quot;: {
        &quot;$id&quot;: &quot;urn:uuid:10a05e55-0c20-4f68-89ad-35a18eb7076f&quot;,
        &quot;title&quot;: &quot;Number of elements&quot;,
        &quot;x-optimade-type&quot;: &quot;integer&quot;,
        &quot;type&quot;: [&quot;integer&quot;, &quot;null&quot;],
        &quot;description&quot;: &quot;Number of different elements in the structure as an integer.\n
         \n
         -  Note: queries on this property can equivalently be formulated using `elements LENGTH`.\n
         -  A filter that matches structures that have exactly 4 elements: `nelements=4`.\n
         -  A filter that matches structures that have between 2 and 7 elements: `nelements&gt;=2 AND nelements&lt;=7`.&quot;,
        &quot;examples&quot;: [
          3
        ],
        &quot;x-optimade-property&quot;: {
           &quot;property-format&quot;: &quot;1.2&quot;
        },
        &quot;x-optimade-unit&quot;: &quot;dimensionless&quot;,
        &quot;x-optimade-implementation&quot;: {
          &quot;sortable&quot;: true,
          &quot;query-support&quot;: &quot;all mandatory&quot;
        },
        &quot;x-optimade-requirements&quot;: {
          &quot;support&quot;: &quot;should&quot;,
          &quot;sortable&quot;: false,
          &quot;query-support&quot;: &quot;all mandatory&quot;
        }
      },
      &quot;lattice_vectors&quot;: {
        &quot;$id&quot;: &quot;urn:uuid:81edf372-7b1b-4518-9c14-7d482bd67834&quot;,
        &quot;title&quot;: &quot;Lattice vectors&quot;,
        &quot;x-optimade-definition&quot;: {
          &quot;label&quot;: &quot;lattice_vectors_optimade_structures&quot;,
          &quot;kind&quot;: &quot;property&quot;,
          &quot;format&quot;: &quot;1.2&quot;,
          &quot;version&quot;: &quot;1.2.0&quot;,
          &quot;name&quot;: &quot;lattice_vectors&quot;
        },
        &quot;x-optimade-type&quot;: &quot;list&quot;,
        &quot;x-optimade-dimensions&quot;: {
           &quot;names&quot;: [&quot;dim_lattice&quot;, &quot;dim_spatial&quot;],
           &quot;lengths&quot;: [3, 3]
        },
        &quot;x-optimade-unit-definitions&quot;: [
            {
              &quot;symbol&quot;: &quot;angstrom&quot;,
              &quot;title&quot;: &quot;ångström&quot;,
              &quot;description&quot;: &quot;The ångström unit of length.&quot;,
              &quot;standard&quot;: {
                &quot;name&quot;: &quot;gnu units&quot;,
                &quot;version&quot;: &quot;3.09&quot;,
                &quot;symbol&quot;: &quot;angstrom&quot;
              }
            }
          ],
        &quot;x-optimade-unit&quot;: &quot;inapplicable&quot;,
        &quot;x-optimade-implementation&quot;: {
          &quot;sortable&quot;: false,
          &quot;query-support&quot;: &quot;none&quot;
        },
        &quot;x-optimade-requirements&quot;: {
          &quot;support&quot;: &quot;should&quot;,
          &quot;sortable&quot;: false,
          &quot;query-support&quot;: &quot;none&quot;
        },
        &quot;type&quot;: [&quot;array&quot;, &quot;null&quot;],
        &quot;description&quot;: &quot;The three lattice vectors in Cartesian coordinates, in ångström (Å).\n
        \n
        - MUST be a list of three vectors *a*, *b*, and *c*, where each of the vectors MUST BE a
          list of the vector's coordinates along the x, y, and z Cartesian coordinates.
        &quot;,
        &quot;examples&quot;: [
          [[4.0, 0.0, 0.0], [0.0, 4.0, 0.0], [0.0, 1.0, 4.0]]
        ],
        &quot;items&quot;: {
          &quot;type&quot;: &quot;array&quot;,
          &quot;x-optimade-type&quot;: &quot;list&quot;,
          &quot;x-optimade-unit&quot;: &quot;inapplicable&quot;,
          &quot;x-optimade-dimensions&quot;: {
            &quot;names&quot;: [&quot;dim_spatial&quot;],
            &quot;lengths&quot;: [3]
          },
          &quot;items&quot;: {
            &quot;type&quot;: &quot;number&quot;,
            &quot;x-optimade-type&quot;: &quot;float&quot;,
            &quot;x-optimade-unit&quot;: &quot;angstrom&quot;,
            &quot;x-optimade-implementation&quot;: {
              &quot;sortable&quot;: true,
              &quot;query-support&quot;: &quot;none&quot;
            },
            &quot;x-optimade-requirements&quot;: {
              &quot;sortable&quot;: false,
              &quot;query-support&quot;: &quot;none&quot;
            }
          }
        }
      }
      // ... &lt;other property descriptions&gt;
    },
    &quot;formats&quot;: [&quot;json&quot;, &quot;xml&quot;],
    &quot;output_fields_by_format&quot;: {
      &quot;json&quot;: [
        &quot;nelements&quot;,
        &quot;lattice_vectors&quot;,
        // ...
      ],
      &quot;xml&quot;: [&quot;nelements&quot;]
    }
  }
  // ...
}</code></pre>
</section>
</section>
<section id="links-endpoint">
<h3><a class="toc-backref" href="#toc-entry-38" role="doc-backlink"><span class="sectnum">5.6 </span>Links Endpoint</a></h3>
<p>This endpoint exposes information on other OPTIMADE API implementations that are related to the current implementation.
The links endpoint MUST be provided under the versioned or unversioned base URL serving the API at <span class="endpoint docutils literal">/links</span>.</p>
<section id="link-types">
<h4><a class="toc-backref" href="#toc-entry-39" role="doc-backlink"><span class="sectnum">5.6.1 </span>Link Types</a></h4>
<p>Each link has a <span class="property docutils literal">link_type</span> attribute that specifies the type of the linked relation.</p>
<p>The <span class="property docutils literal">link_type</span> MUST be one of the following values:</p>
<ul class="simple">
<li><p><span class="field-val docutils literal">child</span>: a link to another OPTIMADE implementation that MUST be within the same provider.
This allows the creation of a tree-like structure of databases by pointing to children sub-databases.</p></li>
<li><p><span class="field-val docutils literal">root</span>: a link to the root implementation within the same provider.
This is RECOMMENDED to be an <a class="reference internal" href="#index-meta-database">Index Meta-Database</a>.
There MUST be only one <span class="val docutils literal">root</span> implementation per provider and all implementations MUST have a link to this <span class="val docutils literal">root</span> implementation.
If the provider only supplies a single implementation, the <span class="val docutils literal">root</span> link links to the implementation itself.</p></li>
<li><p><span class="field-val docutils literal">external</span>: a link to an external OPTIMADE implementation.
This MAY be used to point to any other implementation, also in a different provider.</p></li>
<li><p><span class="field-val docutils literal">providers</span>: a link to a <a class="reference internal" href="#list-of-providers-links">List of Providers Links</a> implementation that includes the current implementation, e.g. <a class="reference external" href="https://providers.optimade.org/">providers.optimade.org</a>.</p></li>
</ul>
<p>Limiting to the <span class="val docutils literal">root</span> and <span class="val docutils literal">child</span> link types, links can be used as an introspective endpoint, similar to the <a class="reference internal" href="#info-endpoints">Info Endpoints</a>, but at a higher level, i.e., <a class="reference internal" href="#info-endpoints">Info Endpoints</a> provide information on the given implementation, while the <span class="endpoint docutils literal">/links</span> endpoint provides information on the links between immediately related implementations (in particular, an array of none or a single object with link type <span class="val docutils literal">root</span> and none or more objects with link type <span class="val docutils literal">child</span>, see section <a class="reference internal" href="#internal-links-root-and-child-links">Internal Links: Root and Child Links</a>).</p>
<p>For <span class="endpoint docutils literal">/links</span> endpoints, the API implementation MAY ignore any provided query parameters.
Alternatively, it MAY handle the parameters specified in section <a class="reference internal" href="#entry-listing-url-query-parameters">Entry Listing URL Query Parameters</a> for entry listing endpoints.</p>
</section>
<section id="links-endpoint-json-response-schema">
<h4><a class="toc-backref" href="#toc-entry-40" role="doc-backlink"><span class="sectnum">5.6.2 </span>Links Endpoint JSON Response Schema</a></h4>
<p>The resource objects' response dictionaries MUST include the following fields:</p>
<ul>
<li><p><strong>type</strong>: MUST be <span class="field-val docutils literal">&quot;links&quot;</span>.</p></li>
<li><p><strong>id</strong>: MUST be unique.</p></li>
<li><p><strong>attributes</strong>: Dictionary that MUST contain the following fields:</p>
<ul>
<li><p><strong>name</strong>: Human-readable name for the OPTIMADE API implementation, e.g., for use in clients to show the name to the end-user.</p></li>
<li><p><strong>description</strong>: Human-readable description for the OPTIMADE API implementation, e.g., for use in clients to show a description to the end-user.</p></li>
<li><p><strong>base_url</strong>: <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON API link</a>, pointing to the base URL for this implementation, either directly as a string, or as an object, which can contain the following fields:</p>
<ul class="simple">
<li><p><strong>href</strong>: a string containing the OPTIMADE base URL.</p></li>
<li><p><strong>meta</strong>: a meta object containing non-standard meta-information about the implementation.</p></li>
</ul>
</li>
<li><p><strong>homepage</strong>: a <a class="reference external" href="http://jsonapi.org/format/1.1/#document-links">JSON API link</a>, pointing to a homepage URL for this implementation, either directly as a string, or as an object, which can contain the following fields:</p>
<ul class="simple">
<li><p><strong>href</strong>: a string containing the implementation homepage URL.</p></li>
<li><p><strong>meta</strong>: a meta object containing non-standard meta-information about the homepage.</p></li>
</ul>
</li>
<li><p><strong>link_type</strong>: a string containing the link type.
It MUST be one of the values listed above in section <a class="reference internal" href="#link-types">Link Types</a>.</p></li>
<li><p><strong>aggregate</strong>: a string indicating whether a client that is following links to aggregate results from different OPTIMADE implementations should follow this link or not. This flag SHOULD NOT be indicated for links where <span class="property docutils literal">link_type</span> is not <span class="val docutils literal">child</span>.</p>
<p>If not specified, clients MAY assume that the value is <span class="val docutils literal">ok</span>.
If specified, and the value is anything different than <span class="val docutils literal">ok</span>, the client MUST assume that the server is suggesting not to follow the link during aggregation by default (also if the value is not among the known ones, in case a future specification adds new accepted values).</p>
<p>Specific values indicate the reason why the server is providing the suggestion.
A client MAY follow the link anyway if it has reason to do so (e.g., if the client is looking for all test databases, it MAY follow the links where <span class="property docutils literal">aggregate</span> has value <span class="val docutils literal">test</span>).</p>
<p>If specified, it MUST be one of the values listed in section <a class="reference internal" href="#link-aggregate-options">Link Aggregate Options</a>.</p>
</li>
<li><p><strong>no_aggregate_reason</strong>: an OPTIONAL human-readable string indicating the reason for suggesting not to aggregate results following the link. It SHOULD NOT be present if <span class="property docutils literal">aggregate</span> has value <span class="val docutils literal">ok</span>.</p></li>
</ul>
</li>
</ul>
<p>Example:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: [
    {
      &quot;type&quot;: &quot;links&quot;,
      &quot;id&quot;: &quot;index&quot;,
      &quot;attributes&quot;: {
        &quot;name&quot;: &quot;Index&quot;,
        &quot;description&quot;: &quot;Index for example's OPTIMADE databases&quot;,
        &quot;base_url&quot;: &quot;http://example.com/optimade&quot;,
        &quot;homepage&quot;: &quot;http://example.com&quot;,
        &quot;link_type&quot;: &quot;root&quot;
      }
    },
    {
      &quot;type&quot;: &quot;links&quot;,
      &quot;id&quot;: &quot;cat_zeo&quot;,
      &quot;attributes&quot;: {
        &quot;name&quot;: &quot;Catalytic Zeolites&quot;,
        &quot;description&quot;: &quot;Zeolites for deNOx catalysis&quot;,
        &quot;base_url&quot;: {
          &quot;href&quot;: &quot;http://example.com/optimade/denox/zeolites&quot;,
          &quot;meta&quot;: {
            &quot;_exmpl_catalyst_group&quot;: &quot;denox&quot;
          }
        },
        &quot;homepage&quot;: &quot;http://example.com&quot;,
        &quot;link_type&quot;: &quot;child&quot;
      }
    },
    {
      &quot;type&quot;: &quot;links&quot;,
      &quot;id&quot;: &quot;frameworks&quot;,
      &quot;attributes&quot;: {
        &quot;name&quot;: &quot;Zeolitic Frameworks&quot;,
        &quot;description&quot;: &quot;&quot;,
        &quot;base_url&quot;: &quot;http://example.com/zeo_frameworks/optimade&quot;,
        &quot;homepage&quot;: &quot;http://example.com&quot;,
        &quot;link_type&quot;: &quot;child&quot;
      }
    },
    {
      &quot;type&quot;: &quot;links&quot;,
      &quot;id&quot;: &quot;testdb&quot;,
      &quot;attributes&quot;: {
        &quot;name&quot;: &quot;Test database&quot;,
        &quot;description&quot;: &quot;A test database&quot;,
        &quot;base_url&quot;: &quot;http://example.com/testdb/optimade&quot;,
        &quot;homepage&quot;: &quot;http://example.com&quot;,
        &quot;link_type&quot;: &quot;child&quot;,
        &quot;aggregate&quot;: &quot;test&quot;
      }
    },
    {
      &quot;type&quot;: &quot;links&quot;,
      &quot;id&quot;: &quot;internaldb&quot;,
      &quot;attributes&quot;: {
        &quot;name&quot;: &quot;Database for internal use&quot;,
        &quot;description&quot;: &quot;An internal database&quot;,
        &quot;base_url&quot;: &quot;http://example.com/internaldb/optimade&quot;,
        &quot;homepage&quot;: &quot;http://example.com&quot;,
        &quot;link_type&quot;: &quot;child&quot;,
        &quot;aggregate&quot;: &quot;no&quot;,
        &quot;no_aggregate_reason&quot;: &quot;This is a database for internal use and might contain nonsensical data&quot;
      }
    },
    {
      &quot;type&quot;: &quot;links&quot;,
      &quot;id&quot;: &quot;frameworks&quot;,
      &quot;attributes&quot;: {
        &quot;name&quot;: &quot;Some other DB&quot;,
        &quot;description&quot;: &quot;A DB by the example2 provider&quot;,
        &quot;base_url&quot;: &quot;http://example2.com/some_db/optimade&quot;,
        &quot;homepage&quot;: &quot;http://example2.com&quot;,
        &quot;link_type&quot;: &quot;external&quot;
      }
    },
    {
      &quot;type&quot;: &quot;links&quot;,
      &quot;id&quot;: &quot;optimade&quot;,
      &quot;attributes&quot;: {
        &quot;name&quot;: &quot;Materials Consortia&quot;,
        &quot;description&quot;: &quot;List of OPTIMADE providers maintained by the Materials Consortia organisation&quot;,
        &quot;base_url&quot;: &quot;https://providers.optimade.org&quot;,
        &quot;homepage&quot;: &quot;https://optimade.org&quot;,
        &quot;link_type&quot;: &quot;providers&quot;
      }
    }
  ]
}</code></pre>
</section>
<section id="internal-links-root-and-child-links">
<h4><a class="toc-backref" href="#toc-entry-41" role="doc-backlink"><span class="sectnum">5.6.3 </span>Internal Links: Root and Child Links</a></h4>
<p>Any number of resource objects with <span class="property docutils literal">link_type</span> equal to <span class="val docutils literal">child</span> MAY be present as part of the <span class="field docutils literal">data</span> list.
A <span class="val docutils literal">child</span> object represents a &quot;link&quot; to an OPTIMADE implementation within the same provider exactly one layer <strong>below</strong> the current implementation's layer.</p>
<p>Exactly one resource object with <span class="property docutils literal">link_type</span> equal to <span class="val docutils literal">root</span> MUST be present as part of the <span class="field docutils literal">data</span> list.
Note: the same implementation may of course be linked by other implementations via a <span class="endpoint docutils literal">/links</span> endpoint with <span class="property docutils literal">link_type</span> equal to <span class="val docutils literal">external</span>.</p>
<p>The <span class="val docutils literal">root</span> resource object represents a link to the topmost OPTIMADE implementation of the current provider.
By following <span class="val docutils literal">child</span> links from the <span class="val docutils literal">root</span> object recursively, it MUST be possible to reach the current OPTIMADE implementation.</p>
<p>In practice, this forms a tree structure for the OPTIMADE implementations of a provider.
<strong>Note</strong>: The RECOMMENDED number of layers is two.</p>
</section>
<section id="list-of-providers-links">
<h4><a class="toc-backref" href="#toc-entry-42" role="doc-backlink"><span class="sectnum">5.6.4 </span>List of Providers Links</a></h4>
<p>Resource objects with <span class="property docutils literal">link_type</span> equal to <span class="val docutils literal">providers</span> MUST point to an <a class="reference internal" href="#index-meta-database">Index Meta-Database</a> that supplies a list of OPTIMADE database providers.
The intention is to be able to auto-discover all providers of OPTIMADE implementations.</p>
<p>A list of known database providers can be retrieved as described in section <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>.
This section also describes where to find information for how a provider can be added to this list.</p>
</section>
<section id="index-meta-database-links-endpoint">
<h4><a class="toc-backref" href="#toc-entry-43" role="doc-backlink"><span class="sectnum">5.6.5 </span>Index Meta-Database Links Endpoint</a></h4>
<p>If the provider implements an <a class="reference internal" href="#index-meta-database">Index Meta-Database</a>, it is RECOMMENDED to adopt a structure where the index meta-database is the <span class="val docutils literal">root</span> implementation of the provider.</p>
<p>This will make all OPTIMADE databases and implementations by the provider discoverable as links with <span class="val docutils literal">child</span> link type, under the <span class="endpoint docutils literal">links</span> endpoint of the <a class="reference internal" href="#index-meta-database">Index Meta-Database</a>.</p>
</section>
<section id="link-aggregate-options">
<h4><a class="toc-backref" href="#toc-entry-44" role="doc-backlink"><span class="sectnum">5.6.6 </span>Link Aggregate Options</a></h4>
<p>If specified, the <span class="property docutils literal">aggregate</span> attributed MUST have one of the following values:</p>
<ul class="simple">
<li><p><span class="val docutils literal">ok</span> (default value, if unspecified): it is ok to follow this link when aggregating OPTIMADE results.</p></li>
<li><p><span class="val docutils literal">test</span>: the linked database is a test database,  whose content might not be correct or might not represent physically-meaningful data. Therefore by default the link should not be followed.</p></li>
<li><p><span class="val docutils literal">staging</span>: the linked database is almost production-ready, but final checks on its content are being performed, so the content might still contain errors. Therefore by default the link should not be followed.</p></li>
<li><p><span class="val docutils literal">no</span>: any other reason to suggest not to follow the link during aggregation of OPTIMADE results. The implementation MAY provide mode details in a human-readable form via the attribute <span class="property docutils literal"><span class="pre">no-aggregate-reason</span></span>.</p></li>
</ul>
</section>
</section>
<section id="custom-extension-endpoints">
<h3><a class="toc-backref" href="#toc-entry-45" role="doc-backlink"><span class="sectnum">5.7 </span>Custom Extension Endpoints</a></h3>
<p>API implementations MAY provide custom endpoints under the Extensions endpoint.
Custom extension endpoints MUST be placed under the versioned or unversioned base URL serving the API at <span class="endpoint docutils literal">/extensions</span>.
The API implementation is free to define roles of further URL path segments under this URL.</p>
</section>
</section>
<section id="api-filtering-format-specification">
<h2><a class="toc-backref" href="#toc-entry-46" role="doc-backlink"><span class="sectnum">6 </span>API Filtering Format Specification</a></h2>
<p>An OPTIMADE filter expression is passed in the parameter <span class="query-param docutils literal">filter</span> as a URL query parameter as <a class="reference external" href="https://jsonapi.org/format/1.1/#fetching-filtering">specified by JSON:API</a>.
The filter expression allows desired properties to be compared against search values; several such comparisons can be combined using the logical conjunctions AND, OR, NOT, and parentheses, with their usual semantics.</p>
<p>All properties marked as REQUIRED in section <a class="reference internal" href="#entry-list">Entry list</a> MUST be queryable with all mandatory filter features.
The level of query support REQUIRED for other properties is described in <a class="reference internal" href="#entry-list">Entry list</a>.</p>
<p>When provided as a URL query parameter, the contents of the <span class="query-param docutils literal">filter</span> parameter is URL-encoded by the client in the HTTP GET request, and then URL-decoded by the API implementation before any further parsing takes place.
In particular, this means the client MUST escape special characters in string values as described below for <a class="reference internal" href="#string-values">String values</a> before the URL encoding, and the API implementation MUST first URL-decode the <span class="query-param docutils literal">filter</span> parameter before reversing the escaping of string tokens.</p>
<p>Examples of syntactically correct query strings embedded in queries:</p>
<ul class="simple">
<li><p><span class="query-url docutils literal"><span class="pre">http://example.org/optimade/v1/structures?filter=_exmpl_melting_point%3C300+AND+nelements=4+AND+chemical_formula_descriptive=&quot;SiO2&quot;&amp;response_format=xml</span></span></p></li>
</ul>
<p>Or, fully URL encoded:</p>
<ul class="simple">
<li><p><span class="query-url docutils literal"><span class="pre">http://example.org/optimade/v1/structures?filter=_exmpl_melting_point%3C300+AND+nelements%3D4+AND+chemical_formula_descriptive%3D%22SiO2%22&amp;response_format=xml</span></span></p></li>
</ul>
<section id="lexical-tokens">
<h3><a class="toc-backref" href="#toc-entry-47" role="doc-backlink"><span class="sectnum">6.1 </span>Lexical Tokens</a></h3>
<p>The following tokens are used in the filter query component:</p>
<ul>
<li><p><strong>Property names</strong>: the first character MUST be a lowercase letter, the subsequent symbols MUST be composed of lowercase letters or digits; the underscore (&quot;_&quot;, ASCII 95 dec (0x5F)) is considered to  be a lower-case letter when defining identifiers.
The length of the identifiers is not limited, except that when passed as a URL query parameter the whole query SHOULD NOT be longer than the limits imposed by the URI specification.
This definition is similar to one used in most widespread programming languages, except that OPTIMADE limits allowed letter set to lowercase letters only.
This allows to tell OPTIMADE identifiers and operator keywords apart unambiguously without consulting a reserved word table and to encode this distinction concisely in the EBNF Filter Language grammar.</p>
<p>Examples of valid property names:</p>
<ul class="simple">
<li><p><span class="property docutils literal">band_gap</span></p></li>
<li><p><span class="property docutils literal">cell_length_a</span></p></li>
<li><p><span class="property docutils literal">cell_volume</span></p></li>
</ul>
<p>Examples of incorrect property names:</p>
<ul class="simple">
<li><p><span class="property-fail docutils literal">0_kvak</span> (starts with a number);</p></li>
<li><p><span class="property-fail docutils literal">&quot;foo bar&quot;</span> (contains space; contains quotes)</p></li>
<li><p><span class="property-fail docutils literal">BadLuck</span> (contains upper-case letters)</p></li>
</ul>
<p>Identifiers that start with an underscore are specific to a database or definition provider, and MUST be on the format of a namespace prefix (see section <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>).</p>
<p>Examples:</p>
<ul class="simple">
<li><p><span class="property docutils literal">_exmpl_formula_sum</span> (a property specific to that database)</p></li>
<li><p><span class="property docutils literal">_exmpl_band_gap</span></p></li>
<li><p><span class="property docutils literal">_exmpl_supercell</span></p></li>
<li><p><span class="property docutils literal">_exmpl_trajectory</span></p></li>
<li><p><span class="property docutils literal">_exmpl_workflow_id</span></p></li>
</ul>
</li>
<li><p><strong>Nested property names</strong> A nested property name is composed of at least two identifiers separated by periods (<span class="docutils literal">.</span>).</p></li>
</ul>
<ul id="string-values">
<li><p><strong>String values</strong> MUST be surrounded by double quote characters (<span class="docutils literal">&quot;</span>, ASCII symbol 34 dec, 0x22 hex).
A double quote that is a part of the value, not a delimiter, MUST be escaped by prepending it with a backslash character (<span class="docutils literal">\\</span>, ASCII symbol 92 dec, 0x5C hex).
A backslash character that is part of the value (i.e., not used to escape a double quote) MUST be escaped by prepending it with another backslash.
An example of an escaped string value, including the enclosing double quotes, is given below:</p>
<ul class="simple">
<li><p>&quot;A double quote character (\&quot;, ASCII symbol 34 dec) MUST be prepended by a backslash (\\, ASCII symbol 92 dec) when it is a part of the value and not a delimiter; the backslash character \&quot;\\\&quot; itself MUST be preceded by another backslash, forming a double backslash: \\\\&quot;</p></li>
</ul>
<p>(Note that at the end of the string value above the four final backslashes represent the two terminal backslashes in the value, and the final double quote is a terminator, it is not escaped.)</p>
<p>String value tokens are also used to represent <strong>timestamps</strong> in form of the <a class="reference external" href="https://tools.ietf.org/html/rfc3339#section-5.6">RFC 3339 Internet Date/Time Format</a>.</p>
</li>
<li><p><strong>Numeric values</strong> are represented as decimal integers or in scientific notation, using the usual programming language conventions.
A regular expression giving the number syntax is given below as a <a class="reference external" href="https://en.wikipedia.org/w/index.php?title=Regular_expression&amp;oldid=786659796#Standards">POSIX Extended Regular Expression (ERE)</a> or as a <a class="reference external" href="http://www.pcre.org">Perl-Compatible Regular Expression (PCRE)</a>:</p>
<ul class="simple">
<li><p>ERE: <span class="ere docutils literal"><span class="pre">[-+]?([0-9]+(.[0-9]*)?|.[0-9]+)([eE][-+]?[0-9]+)?</span></span></p></li>
<li><p>PCRE: <span class="pcre docutils literal"><span class="pre">[-+]?(?:d+(.d*)?|.d+)(?:[eE][-+]?d+)?</span></span></p></li>
</ul>
</li>
</ul>
<p>An implementation of the search filter MAY reject numbers that are outside the machine representation of the underlying hardware; in such case it MUST return the error <span class="http-error docutils literal">501 Not Implemented</span> with an appropriate error message that indicates the cause of the error and an acceptable number range.</p>
<ul class="simple">
<li><p>Examples of valid numbers:</p>
<ul>
<li><p>12345, +12, -34, 1.2, .2E7, -.2E+7, +10.01E-10, 6.03e23, .1E1, -.1e1, 1.e-12, -.1e-12, 1000000000.E1000000000, 1., .1</p></li>
</ul>
</li>
<li><p>Examples of <em>invalid</em> numbers (although they MAY contain correct numbers as substrings):</p>
<ul>
<li><p>1.234D12, .e1, -.E1, +.E2, 1.23E+++, +-123</p></li>
</ul>
</li>
<li><p><strong>Note</strong>: this number representation is more general than the number representation in JSON (for instance, <span class="docutils literal">1.</span> is a valid numeric value for the filtering language specified here, but is not a valid float number in JSON, where the correct format is <span class="docutils literal">1.0</span> instead).</p></li>
</ul>
<p>While the filtering language supports tests for equality between properties of floating point type and decimal numbers given in the filter string, such comparisons come with the usual caveats for testing for equality of floating point numbers.
Normally, a client cannot rely on that a floating point number stored in a database takes on a representation that exactly matches the one obtained for a number given in the filtering string as a decimal number or as an integer.
However, testing for equality to zero MUST be supported.</p>
<p>More examples of the number tokens and machine-readable definitions and tests can be found in the <a class="reference external" href="https://github.com/Materials-Consortia/API/">Materials-Consortia API Git repository</a> (files <a class="reference external" href="https://github.com/Materials-Consortia/API/blob/master/tests/inputs/integers.lst">integers.lst</a>, <a class="reference external" href="https://github.com/Materials-Consortia/API/blob/master/tests/inputs/not-numbers.lst">not-numbers.lst</a>, <a class="reference external" href="https://github.com/Materials-Consortia/API/blob/master/tests/inputs/numbers.lst">numbers.lst</a>, and <a class="reference external" href="https://github.com/Materials-Consortia/API/blob/master/tests/inputs/reals.lst">reals.lst</a>).</p>
<ul>
<li><p><strong>Boolean values</strong> are represented with the tokens <span class="filter-op docutils literal">TRUE</span> and <span class="filter-op docutils literal">FALSE</span>.</p></li>
<li><p><strong>Operator tokens</strong> are represented by usual mathematical relation symbols or by case-sensitive keywords.
Currently the following operators are supported: <span class="filter-op docutils literal">=</span>, <span class="filter-op docutils literal">!=</span>, <span class="filter-op docutils literal">&lt;=</span>, <span class="filter-op docutils literal">&gt;=</span>, <span class="filter-op docutils literal">&lt;</span>, <span class="filter-op docutils literal">&gt;</span> for tests of number, string (lexicographical) or timestamp (temporal) equality, inequality, less-than, more-than, less, and more relations; <span class="filter-op docutils literal">AND</span>, <span class="filter-op docutils literal">OR</span>, <span class="filter-op docutils literal">NOT</span> for logical conjunctions, and a number of keyword operators discussed in the next section.</p>
<p>In future extensions, operator tokens that are words MUST contain only upper-case letters.
This requirement guarantees that no operator token will ever clash with a property name.</p>
</li>
</ul>
</section>
<section id="the-filter-language-syntax">
<h3><a class="toc-backref" href="#toc-entry-48" role="doc-backlink"><span class="sectnum">6.2 </span>The Filter Language Syntax</a></h3>
<p>All filtering expressions MUST follow the <a class="reference external" href="http://standards.iso.org/ittf/PubliclyAvailableStandards/s026153_ISO_IEC_14977_1996(E).zip">EBNF</a> grammar of appendix <a class="reference internal" href="#the-filter-language-ebnf-grammar">The Filter Language EBNF Grammar</a> of this specification.
The appendix contains a complete machine-readable EBNF, including the definition of the lexical tokens described above in section <a class="reference internal" href="#lexical-tokens">Lexical Tokens</a>. The EBNF is enclosed in special strings constructed as <span class="docutils literal">BEGIN</span> and <span class="docutils literal">END</span>, both followed by <span class="docutils literal">EBNF GRAMMAR Filter</span>, to enable automatic extraction.</p>
<section id="basic-boolean-operations">
<h4><a class="toc-backref" href="#toc-entry-49" role="doc-backlink"><span class="sectnum">6.2.1 </span>Basic boolean operations</a></h4>
<p>The filter language supports conjunctions of comparisons using the boolean algebra operators &quot;AND&quot;, &quot;OR&quot;, and &quot;NOT&quot; and parentheses to group conjunctions.
A comparison clause prefixed by NOT matches entries for which the comparison is false.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="filter">NOT ( chemical_formula_hill = &quot;Al&quot; AND chemical_formula_anonymous = &quot;A&quot; OR chemical_formula_anonymous = &quot;H2O&quot; AND NOT chemical_formula_hill = &quot;Ti&quot; )</code></p></li>
</ul>
</section>
<section id="numeric-and-string-comparisons">
<h4><a class="toc-backref" href="#toc-entry-50" role="doc-backlink"><span class="sectnum">6.2.2 </span>Numeric and String comparisons</a></h4>
<p>Comparisons involving Numeric and String properties can be expressed using the usual comparison operators: '&lt;', '&gt;', '&lt;=', '&gt;=', '=', '!='.
Implementations MUST support comparisons in the forms:</p>
<pre class="literal-block">identifier &lt;operator&gt; constant
constant &lt;operator&gt; identifier</pre>
<p>Where <span class="filter-fragment docutils literal">identifier</span> is a property name and <span class="filter-fragment docutils literal">constant</span> is either a numerical or string type constant.</p>
<p>Implementations MAY also support comparisons with identifiers on both sides, and comparisons with numerical type constants on both sides, i.e., in the forms:</p>
<pre class="literal-block">identifier &lt;operator&gt; identifier
constant &lt;operator&gt; constant</pre>
<p>However, the latter form, <span class="filter-fragment docutils literal">constant &lt;operator&gt; constant</span> where the constants are strings MUST return the error <span class="http-error docutils literal">501 Not Implemented</span>.</p>
<blockquote>
<p><strong>Note:</strong> The motivation to exclude the form <span class="filter-fragment docutils literal">constant &lt;operator&gt; constant</span> for strings is that filter language strings can refer to data of different data types (e.g., strings and timestamps), and thus this construct is not unambiguous.
The OPTIMADE specification will strive to address this issue in a future version.</p>
</blockquote>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="filter">nelements &gt; 3</code></p></li>
<li><p><code class="filter">chemical_formula_hill = &quot;H2O&quot; AND chemical_formula_anonymous != &quot;AB&quot;</code></p></li>
<li><p><code class="filter">_exmpl_aax &lt;= +.1e8 OR nelements &gt;= 10 AND NOT ( _exmpl_x != &quot;Some string&quot; OR NOT _exmpl_a = 7)</code></p></li>
<li><p><code class="filter">_exmpl_spacegroup=&quot;P2&quot;</code></p></li>
<li><p><code class="filter">_exmpl_cell_volume&lt;100.0</code></p></li>
<li><p><code class="filter">_exmpl_band_gap &gt; 5.0 AND _exmpl_molecular_weight &lt; 350</code></p></li>
<li><p><code class="filter">_exmpl_melting_point&lt;300 AND nelements=4 AND chemical_formula_descriptive=&quot;SiO2&quot;</code></p></li>
<li><p><code class="filter">_exmpl_some_string_property = 42</code> (This is syntactically allowed without putting 42 in quotation marks, see the notes about comparisons of values of different types below.)</p></li>
<li><p><code class="filter">5 &lt; _exmpl_a</code></p></li>
<li><p>OPTIONAL: <code class="filter">((NOT (_exmpl_a&gt;_exmpl_b)) AND _exmpl_x&gt;0)</code></p></li>
<li><p>OPTIONAL: <code class="filter">5 &lt; 7</code></p></li>
</ul>
</section>
<section id="substring-comparisons">
<h4><a class="toc-backref" href="#toc-entry-51" role="doc-backlink"><span class="sectnum">6.2.3 </span>Substring comparisons</a></h4>
<p>In addition to the standard equality and inequality operators, matching of partial strings is provided by keyword operators:</p>
<ul class="simple">
<li><p><code class="filter">identifier CONTAINS x</code>: Is true if the substring value x is found anywhere within the property.</p></li>
<li><p><code class="filter">identifier STARTS WITH x</code>: Is true if the property starts with the substring value x. The <span class="filter-op docutils literal">WITH</span> keyword MAY be omitted.</p></li>
<li><p><code class="filter">identifier ENDS WITH x</code>: Is true if the property ends with the substring value x. The <span class="filter-op docutils literal">WITH</span> keyword MAY be omitted.</p></li>
</ul>
<p>OPTIONAL features:</p>
<ul class="simple">
<li><p>Support for x to be an identifier, rather than a string is OPTIONAL.</p></li>
</ul>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="filter">chemical_formula_anonymous CONTAINS &quot;C2&quot; AND chemical_formula_anonymous STARTS WITH &quot;A2&quot;</code></p></li>
<li><p><code class="filter">chemical_formula_anonymous STARTS &quot;A2&quot; AND chemical_formula_anonymous ENDS WITH &quot;D1&quot;</code></p></li>
</ul>
</section>
<section id="comparisons-of-boolean-values">
<h4><a class="toc-backref" href="#toc-entry-52" role="doc-backlink"><span class="sectnum">6.2.4 </span>Comparisons of boolean values</a></h4>
<p>Straightforward comparisons ('=' and '!=') MUST be supported for boolean values.
Other comparison operators ('&lt;', '&gt;', '&lt;=', '&gt;=') MUST NOT be supported.
Boolean values are only supposed to be used in direct comparisons with properties, but not compound comparisons.
For example, <code class="filter">(nsites = 3 AND nelements = 3) = FALSE</code> is not supported.</p>
<p>Boolean property <span class="filter-fragment docutils literal">property</span> MAY be compared with <span class="filter-fragment docutils literal">TRUE</span> by omitting the <span class="filter-fragment docutils literal">= TRUE</span> altogether: <code class="filter">property</code>.
Conversely, it MAY be compared with <span class="filter-fragment docutils literal">FALSE</span> by negating the comparison with <span class="filter-fragment docutils literal">TRUE</span>: <code class="filter">NOT property</code>.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="filter">property = TRUE</code></p></li>
<li><p><code class="filter">property != FALSE</code></p></li>
<li><p><code class="filter">_exmpl_has_inversion_symmetry AND NOT _exmpl_is_primitive</code></p></li>
</ul>
</section>
<section id="comparisons-of-list-properties">
<h4><a class="toc-backref" href="#toc-entry-53" role="doc-backlink"><span class="sectnum">6.2.5 </span>Comparisons of list properties</a></h4>
<p>In the following, <span class="property docutils literal">list</span> is a list-type property, and <span class="filter-fragment docutils literal">values</span> is one or more <span class="filter-fragment docutils literal">value</span> separated by commas (&quot;,&quot;), i.e., strings or numbers.
An implementation MAY also support property names and nested property names in <span class="filter-fragment docutils literal">values</span>.</p>
<p>The following constructs MUST be supported:</p>
<ul class="simple">
<li><p><code class="filter">list HAS value</code>: matches if at least one element in <span class="filter-fragment docutils literal">list</span> is equal to <span class="filter-fragment docutils literal">value</span>. (If <span class="filter-fragment docutils literal">list</span> has no duplicate elements, this implements the set operator IN.)</p></li>
<li><p><code class="filter">list HAS ALL values</code>: matches if, for each <span class="filter-fragment docutils literal">value</span>, there is at least one element in <span class="filter-fragment docutils literal">list</span> equal to that value. (If both <span class="filter-fragment docutils literal">list</span> and <span class="filter-fragment docutils literal">values</span> do not contain duplicate values, this implements the set operator &gt;=.)</p></li>
<li><p><code class="filter">list HAS ANY values</code>: matches if at least one element in <span class="filter-fragment docutils literal">list</span> is equal to at least one <span class="filter-fragment docutils literal">value</span>. (This is equivalent to a number of HAS statements separated by OR.)</p></li>
<li><p><code class="filter">list LENGTH value</code>: matches if the number of items in the <span class="filter-fragment docutils literal">list</span> property is equal to <span class="filter-fragment docutils literal">value</span>.</p></li>
</ul>
<p>The <span class="filter-fragment docutils literal">HAS ONLY</span> construct MAY be supported:</p>
<ul class="simple">
<li><p>OPTIONAL: <code class="filter">list HAS ONLY values</code>: matches if all elements in <span class="filter-fragment docutils literal">list</span> are equal to at least one <span class="filter-fragment docutils literal">value</span>.
(If both <span class="filter-fragment docutils literal">list</span> and <span class="filter-fragment docutils literal">values</span> do not contain duplicate values, this implements the &lt;= set operator.)</p></li>
</ul>
<p>This construct is OPTIONAL as it can be difficult to realize in some underlying database implementations.
However, if the desired search is over a property that can only take on a finite set of values (e.g., chemical elements) a client can formulate an equivalent search by inverting the list of values into <span class="filter-fragment docutils literal">inverse</span> and express the filter as <code class="filter">NOT list HAS inverse</code>.</p>
<p>Furthermore, there is a set of OPTIONAL constructs that allows filters to be formulated over the values in <em>correlated positions</em> in multiple list properties.
An implementation MAY support this syntax selectively only for specific properties.
This type of filter is useful for, e.g., filtering on elements and correlated element counts available as two separate list properties.</p>
<ul class="simple">
<li><p><span class="filter-fragment docutils literal"><span class="pre">list1:list2:...</span> HAS <span class="pre">val1:val2:...</span></span></p></li>
<li><p><span class="filter-fragment docutils literal"><span class="pre">list1:list2:...</span> HAS ALL <span class="pre">val1:val2:...</span></span></p></li>
<li><p><span class="filter-fragment docutils literal"><span class="pre">list1:list2:...</span> HAS ANY <span class="pre">val1:val2:...</span></span></p></li>
<li><p><span class="filter-fragment docutils literal"><span class="pre">list1:list2:...</span> HAS ONLY <span class="pre">val1:val2:...</span></span></p></li>
</ul>
<p>Finally, all the above constructs that allow a value or lists of values on the right-hand side MAY allow <span class="filter-fragment docutils literal">&lt;operator&gt; value</span> in each place a value can appear.
In that case, a match requires that the <span class="filter-fragment docutils literal">&lt;operator&gt;</span> comparison is fulfilled instead of equality.
Strictly, the definitions of the <span class="filter-fragment docutils literal">HAS</span>, <span class="filter-fragment docutils literal">HAS ALL</span>, <span class="filter-fragment docutils literal">HAS ANY</span>, <span class="filter-fragment docutils literal">HAS ONLY</span> and <span class="filter-fragment docutils literal">LENGTH</span> operators as written above apply, but with the word 'equal' replaced with the <span class="filter-fragment docutils literal">&lt;operator&gt;</span> comparison.</p>
<p>For example:</p>
<ul class="simple">
<li><p>OPTIONAL: <code class="filter">list HAS &lt; 3</code>: matches all entries for which <span class="filter-fragment docutils literal">list</span> contains at least one element that is less than three.</p></li>
<li><p>OPTIONAL: <code class="filter">list HAS ALL &lt; 3, &gt; 3</code>: matches only those entries for which <span class="filter-fragment docutils literal">list</span> simultaneously contains at least one element less than three and one element greater than three.</p></li>
</ul>
<p>An implementation MAY support combining the operator syntax with the syntax for correlated lists in particularly on a list correlated with itself. For example:</p>
<ul class="simple">
<li><p>OPTIONAL: <code class="filter">list:list HAS &gt;=2:&lt;=5</code>: matches all entries for which <span class="filter-fragment docutils literal">list</span> contains at least one element that is between the values 2 and 5.</p></li>
</ul>
<p>Further examples of various comparisons of list properties:</p>
<ul class="simple">
<li><p>OPTIONAL: <code class="filter">elements HAS &quot;H&quot; AND elements HAS ALL &quot;H&quot;,&quot;He&quot;,&quot;Ga&quot;,&quot;Ta&quot; AND elements HAS ONLY &quot;H&quot;,&quot;He&quot;,&quot;Ga&quot;,&quot;Ta&quot; AND elements HAS ANY &quot;H&quot;, &quot;He&quot;, &quot;Ga&quot;, &quot;Ta&quot;</code></p></li>
<li><p>OPTIONAL: <code class="filter">elements HAS ONLY &quot;H&quot;,&quot;He&quot;,&quot;Ga&quot;,&quot;Ta&quot;</code></p></li>
<li><p>OPTIONAL: <code class="filter">elements:_exmpl_element_counts HAS &quot;H&quot;:6 AND elements:_exmpl_element_counts HAS ALL &quot;H&quot;:6,&quot;He&quot;:7 AND elements:_exmpl_element_counts HAS ONLY &quot;H&quot;:6 AND elements:_exmpl_element_counts HAS ANY &quot;H&quot;:6,&quot;He&quot;:7 AND elements:_exmpl_element_counts HAS ONLY &quot;H&quot;:6,&quot;He&quot;:7</code></p></li>
<li><p>OPTIONAL: <code class="filter">_exmpl_element_counts HAS &lt; 3 AND _exmpl_element_counts HAS ANY &gt; 3, = 6, 4, != 8</code>
(note: specifying the = operator after HAS ANY is redundant here, if no operator is given, the test is for equality.)</p></li>
<li><p>OPTIONAL: <code class="filter">elements:_exmpl_element_counts:_exmpl_element_weights HAS ANY &gt; 3:&quot;He&quot;:&gt;55.3 , = 6:&gt;&quot;Ti&quot;:&lt;37.6 , 8:&lt;&quot;Ga&quot;:0</code></p></li>
</ul>
</section>
<section id="nested-property-names">
<h4><a class="toc-backref" href="#toc-entry-54" role="doc-backlink"><span class="sectnum">6.2.6 </span>Nested property names</a></h4>
<p>Everywhere in a filter string where a property name is accepted, the API implementation MAY accept nested property names as described in section <a class="reference internal" href="#lexical-tokens">Lexical Tokens</a>, consisting of identifiers separated by periods ('.').
A filter on a nested property name consisting of two identifiers <span class="filter-fragment docutils literal">identifier1.identifier2</span> matches if either one of these points are true:</p>
<ul class="simple">
<li><p><span class="filter-fragment docutils literal">identifier1</span> references a dictionary-type property that contains as an identifier <span class="filter-fragment docutils literal">identifier2</span> and the filter matches for the content of <span class="filter-fragment docutils literal">identifier2</span>.</p></li>
<li><p><span class="filter-fragment docutils literal">identifier1</span> references a list of dictionaries that contain as an identifier <span class="filter-fragment docutils literal">identifier2</span> and the filter matches for a flat list containing only the contents of <span class="filter-fragment docutils literal">identifier2</span> for every dictionary in the list.
E.g., if <span class="filter-fragment docutils literal">identifier1</span> is the list <span class="filter-fragment docutils literal"><span class="pre">[{&quot;identifier2&quot;:42,</span> <span class="pre">&quot;identifier3&quot;:36},</span> <span class="pre">{&quot;identifier2&quot;:96,</span> <span class="pre">&quot;identifier3&quot;:66}]</span></span>, then <span class="filter-fragment docutils literal">identifier1.identifier2</span> is understood in the filter as the list <span class="filter-fragment docutils literal">[42, 96]</span>.</p></li>
</ul>
<p>The API implementation MAY allow this notation to generalize to arbitrary depth.
A nested property name that combines more than one list MUST, if accepted, be interpreted as a completely flattened list.</p>
</section>
<section id="filtering-on-relationships">
<h4><a class="toc-backref" href="#toc-entry-55" role="doc-backlink"><span class="sectnum">6.2.7 </span>Filtering on relationships</a></h4>
<p>As described in the section <a class="reference internal" href="#relationships">Relationships</a>, it is possible for the API implementation to describe relationships between entries of the same, or different, entry types.
The API implementation MAY support queries on relationships with an entry type <span class="filter-fragment docutils literal">&lt;entry type&gt;</span> by using special nested property names:</p>
<ul class="simple">
<li><p><span class="filter-fragment docutils literal">&lt;entry <span class="pre">type&gt;.id</span></span> references a list of IDs of relationships with entries of the type <span class="filter-fragment docutils literal">&lt;entry type&gt;</span>.</p></li>
<li><p><span class="filter-fragment docutils literal">&lt;entry <span class="pre">type&gt;.description</span></span> references a correlated list of the human-readable descriptions of these relationships.</p></li>
</ul>
<p>Hence, the filter language acts as, for every entry type, there is a property with that name which contains a list of dictionaries with two keys, <span class="filter-fragment docutils literal">id</span> and <span class="filter-fragment docutils literal">description</span>.
For example: a client queries the <span class="endpoint docutils literal">structures</span> endpoint with a filter that references <span class="filter-fragment docutils literal">calculations.id</span>.
For a specific structures entry, the nested property behaves as the list <span class="filter-fragment docutils literal"><span class="pre">[&quot;calc-id-43&quot;,</span> <span class="pre">&quot;calc-id-96&quot;]</span></span> and would then, e.g., match the filter <code class="filter">calculations.id HAS &quot;calc-id-96&quot;</code>.
This means that the structures entry has a relationship with the calculations entry of that ID.</p>
<blockquote>
<p><strong>Note</strong>: formulating queries on relationships with entries that have specific property values is a multi-step process.
For example, to find all structures with bibliographic references where one of the authors has the last name &quot;Schmidt&quot; is performed by the following two steps:</p>
<ul class="simple">
<li><p>Query the <span class="endpoint docutils literal">references</span> endpoint with a filter <code class="filter">authors.lastname HAS &quot;Schmidt&quot;</code> and store the <span class="filter-fragment docutils literal">id</span> values of the returned entries.</p></li>
<li><p>Query the <span class="endpoint docutils literal">structures</span> endpoint with a filter <span class="filter-fragment docutils literal">references.id HAS ANY <span class="pre">&lt;list-of-IDs&gt;</span></span>, where <span class="filter-fragment docutils literal"><span class="pre">&lt;list-of-IDs&gt;</span></span> are the IDs retrieved from the first query separated by commas.</p></li>
</ul>
<p>(Note: the type of query discussed here corresponds to a &quot;join&quot;-type operation in a relational data model.)</p>
</blockquote>
</section>
<section id="filtering-on-properties-with-an-unknown-value">
<h4><a class="toc-backref" href="#toc-entry-56" role="doc-backlink"><span class="sectnum">6.2.8 </span>Filtering on Properties with an unknown value</a></h4>
<p>Properties can have an unknown value, see section <a class="reference internal" href="#properties-with-an-unknown-value">Properties with an unknown value</a>.</p>
<p>Filters that match when the property is known, or unknown, respectively can be constructed using the following syntax:</p>
<pre class="literal-block">identifier IS KNOWN
identifier IS UNKNOWN</pre>
<p>Except for the above constructs, filters that use any form of comparison that involve properties of unknown values MUST NOT match.
Hence, by definition, an <span class="filter-fragment docutils literal">identifier</span> of value <span class="filter-fragment docutils literal">null</span> never matches equality (<span class="filter-op docutils literal">=</span>), inequality (<span class="filter-op docutils literal">&lt;</span>, <span class="filter-op docutils literal">&lt;=</span>, <span class="filter-op docutils literal">&gt;</span>, <span class="filter-op docutils literal">&gt;=</span>, <span class="filter-op docutils literal">!=</span>) or other comparison operators besides <code class="filter">identifier IS UNKNOWN</code> and <code class="filter">NOT identifier IS KNOWN</code>.
In particular, a filter that compares two properties that are both <span class="val docutils literal">null</span> for equality or inequality does not match.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="filter">chemical_formula_hill IS KNOWN AND NOT chemical_formula_anonymous IS UNKNOWN</code></p></li>
</ul>
</section>
<section id="precedence">
<h4><a class="toc-backref" href="#toc-entry-57" role="doc-backlink"><span class="sectnum">6.2.9 </span>Precedence</a></h4>
<p>The precedence (priority) of the operators MUST be as indicated in the list below:</p>
<ol class="arabic simple">
<li><p>Comparison and keyword operators (<span class="filter-op docutils literal">&lt;</span>, <span class="filter-op docutils literal">&lt;=</span>, <span class="filter-op docutils literal">=</span>, <span class="filter-op docutils literal">HAS</span>, <span class="filter-op docutils literal">STARTS</span>, etc.) -- highest priority;</p></li>
<li><p><span class="filter-op docutils literal">NOT</span></p></li>
<li><p><span class="filter-op docutils literal">AND</span></p></li>
<li><p><span class="filter-op docutils literal">OR</span> -- lowest priority.</p></li>
</ol>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="filter">NOT a &gt; b OR c = 100 AND f = &quot;C2 H6&quot;</code>: this is interpreted as <code class="filter">(NOT (a &gt; b)) OR ( (c = 100) AND (f = &quot;C2 H6&quot;) )</code> when fully braced.</p></li>
<li><p><code class="filter">a &gt;= 0 AND NOT b &lt; c OR c = 0</code>: this is interpreted as <code class="filter">((a &gt;= 0) AND (NOT (b &lt; c))) OR (c = 0)</code> when fully braced.</p></li>
</ul>
</section>
<section id="type-handling-and-conversions-in-comparisons">
<h4><a class="toc-backref" href="#toc-entry-58" role="doc-backlink"><span class="sectnum">6.2.10 </span>Type handling and conversions in comparisons</a></h4>
<p>The definitions of specific properties in this standard define their types.
Similarly, for <a class="reference internal" href="#custom-properties">custom properties</a>, the database provider decides their types.
In the syntactic constructs that can accommodate values of more than one type, types of all participating values are REQUIRED to match, with a single exception of timestamps (see below).
Different types of values MUST be reported as <span class="http-error docutils literal">501 Not Implemented</span> errors, meaning that type conversion is not implemented in the specification.</p>
<p>As the filter language syntax does not define a lexical token for timestamps, values of this type are expressed using string tokens in <a class="reference external" href="https://tools.ietf.org/html/rfc3339#section-5.6">RFC 3339 Internet Date/Time Format</a>.
In a comparison with a timestamp property, a string token represents a timestamp value that would result from parsing the string according to RFC 3339 Internet Date/Time Format.
Interpretation failures MUST be reported with error <span class="http-error docutils literal">400 Bad Request</span>.</p>
</section>
<section id="optional-filter-features">
<h4><a class="toc-backref" href="#toc-entry-59" role="doc-backlink"><span class="sectnum">6.2.11 </span>Optional filter features</a></h4>
<p>Some features of the filtering language are marked OPTIONAL.
An implementation that encounters an OPTIONAL feature that it does not support MUST respond with error <span class="docutils literal">501 Not Implemented</span> with an explanation of which OPTIONAL construct the error refers to.</p>
</section>
</section>
</section>
<section id="property-definitions">
<h2><a class="toc-backref" href="#toc-entry-60" role="doc-backlink"><span class="sectnum">7 </span>Property Definitions</a></h2>
<p>An OPTIMADE <em>Property Definition</em> defines a specific property, which will be referred to as <em>the defined property</em> throughout this section.
The definition uses a dictionary-based construct that, when represented in the JSON output format, is compatible with the JSON Schema standard (for more information, see <a class="reference internal" href="#property-definition-keys-from-json-schema">Property Definition keys from JSON Schema</a>).
The format of Property Definitions defined below allows nesting inner Property Definitions to define properties that are comprised by values organized in lists and dictionaries to arbitrary depth.</p>
<p>To make a property definition expressible in any output format, the fields of the property definition below are specified using OPTIMADE data types.
When a property definition is communicated using a specific data format (e.g., JSON), the property definition is implemented in that data format by mapping the OPTIMADE data types into the corresponding data types for that output format.</p>
<p>Clients are meant to be able to rely on the fact that properties with the same <span class="field docutils literal">$id</span> fields represents equivalently defined properties.
Hence, when a Property Definition that has been published previously is updated, it is of major importance to decide if the updates merely amend, annotate, or clarify the definition in a way that leaves it functionally the same and thus can retain the <span class="field docutils literal">$id</span>, or whether the property is redefined.
An example of an update that does not functionally change the definition is the addition or modification of the examples given in the <span class="field docutils literal">examples</span> field.
If a property is redefined, the redefinition MUST change the <span class="field docutils literal">$id</span>.
The nature of an updated definition can also be reflected in the subfield <span class="field docutils literal">version</span> of <span class="field docutils literal"><span class="pre">x-optimade-definition</span></span>, which allows definitions to be versioned using the <a class="reference external" href="https://semver.org/spec/v2.0.0.html">semantic versioning v2</a> standard where the update is categorized on the levels of a patch, minor, or major change.</p>
<p>A Property Definition MUST be composed according to the combination of the requirements in the subsection <a class="reference internal" href="#property-definition-keys-from-json-schema">Property Definition keys from JSON Schema</a> below and the following additional requirements:</p>
<p><strong>REQUIRED keys for the outermost level of the Property Definition and OPTIONAL for other levels:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">$id</span>: String, <span class="field docutils literal">$schema</span>: String, <span class="field docutils literal">title</span>: String, and <span class="field docutils literal">description</span>: String.
See the subsection <a class="reference internal" href="#property-definition-keys-from-json-schema">Property definition keys from JSON Schema</a> for the definitions of these fields.
They are defined in that subsection as OPTIONAL on any level of the Property Definition, but are REQUIRED on the outermost level.</p></li>
</ul>
<ul id="definition-of-the-x-optimade-definition-field">
<li><p><span class="field docutils literal"><span class="pre">x-optimade-definition</span></span>: Dictionary.
Additional information about the definition that is not covered by fields in the JSON Schema standard.</p>
<p><strong>REQUIRED keys:</strong></p>
</li>
</ul>
<ul id="definition-of-the-property-format-field">
<li><p><span class="field docutils literal">format</span>: String.
A string that declares the OPTIMADE definition format the definition adheres to.
Currently, this is expressed as the minor version of the OPTIMADE specification that describes the property definition format used.
The string MUST be of the format &quot;MAJOR.MINOR&quot;, referring to the version of the OPTIMADE standard that describes the format in which this property definition is expressed.
The version number string MUST NOT be prefixed by, e.g., &quot;v&quot;.
In implementations of the present version of the standard, the value MUST be exactly <span class="field-val docutils literal">1.2</span>.
A client MUST disregard the property definition if the field is not a string of the format MAJOR.MINOR or if the MAJOR version number is unrecognized.
This field allows future versions of this standard to support implementations keeping definitions that adhere to older versions of the property definition format.</p></li>
<li><p><span class="field docutils literal">kind</span>: String.
A string specifying what entity is being defined.
For Property Definitions this MUST be the string &quot;property&quot;.</p></li>
<li><p><span class="field docutils literal">name</span>: String.
An short identifier (as defined in <a class="reference internal" href="#definition-of-terms">Definition of Terms</a>) that provides a reasonable short non-unique name for the entity being defined.</p></li>
<li><p><span class="field docutils literal">label</span>: String.
An extended identifier (as defined in <a class="reference internal" href="#definition-of-terms">Definition of Terms</a>) that describes the entity being defined in a way that is unique within a set of definitions provided together.
The label SHOULD start with the name.</p>
<blockquote>
<p>Implementation notes:</p>
<p>The name and label fields ensure implementations will be able to give meaningful names to definitions if they are translated into other formats with various requirements on human-readable names, e.g., as <a class="reference external" href="https://www.w3.org/TR/rdf-schema/">RDF data</a> (see, e.g., rdfs:label).</p>
</blockquote>
</li>
</ul>
<p><strong>OPTIONAL keys:</strong></p>
<ul>
<li><p><span class="field docutils literal">version</span>: String.
This string indicates the version of the definition.
The string SHOULD be in the format described by the <a class="reference external" href="https://semver.org/spec/v2.0.0.html">semantic versioning v2</a> standard.
When a definition is changed in a way that consitutes a redefinition it SHOULD indicate this by incrementing the MAJOR version number.</p></li>
<li><p><span class="field docutils literal">resources</span>: List.
A list of dictionaries that references remote resources that describe the property.
The format of each dictionary is:</p>
<p><strong>REQUIRED keys:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">relation</span>: String.
A human-readable description of the relationship between the property and the remote resource, e.g., a &quot;natural language description&quot;.</p></li>
<li><p><span class="field docutils literal"><span class="pre">resource-id</span></span>: String.
An IRI of the external resource, which MAY be a resolvable URL.</p></li>
</ul>
</li>
</ul>
<p><strong>REQUIRED keys for all levels of the Property Definition:</strong></p>
<ul class="simple" id="definition-of-the-x-optimade-type-field">
<li><p><span class="field docutils literal"><span class="pre">x-optimade-type</span></span>: String.
Specifies the OPTIMADE data type for this level of the defined property.
MUST be one of <span class="val docutils literal">&quot;string&quot;</span>, <span class="val docutils literal">&quot;integer&quot;</span>, <span class="val docutils literal">&quot;float&quot;</span>, <span class="val docutils literal">&quot;boolean&quot;</span>, <span class="val docutils literal">&quot;timestamp&quot;</span>, <span class="val docutils literal">&quot;list&quot;</span>, or <span class="val docutils literal">&quot;dictionary&quot;</span>.</p></li>
<li><p><span class="field docutils literal"><span class="pre">x-optimade-unit</span></span>: String.
A (compound) symbol for the physical unit in which the value of the defined property is given or one of the strings <span class="val docutils literal">dimensionless</span> or <span class="val docutils literal">inapplicable</span>.
See subsection <a class="reference internal" href="#physical-units-in-property-definitions">Physical Units in Property Definitions</a> for the details on how compound units are represented in OPTIMADE Property Definitions and the precise format of this string.</p></li>
</ul>
<p><strong>OPTIONAL keys at all nested levels of the Property Definition:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal"><span class="pre">x-optimade-unit-definitions</span></span>: List.
A list of definitions of the symbols used in the Property Definition (including its nested levels) for physical units given as values of the <span class="field docutils literal"><span class="pre">x-optimade-unit</span></span> field.
This field <strong>MUST be included at the outermost level of a property definition</strong> if the defined property, at any level, includes an <span class="field docutils literal"><span class="pre">x-optimade-unit</span></span> with a value that is not <span class="val docutils literal">dimensionless</span> or <span class="val docutils literal">inapplicable</span>, and it MUST include definitions of all units used on all levels in the property definition.
The field MAY also occur at deeper nesting levels (but this is not required).
If it does, the unit definitions provided MUST be redundant with those provided at higher nesting levels.
See subsection <a class="reference internal" href="#physical-units-in-property-definitions">Physical Units in Property Definitions</a> for the details on how units are represented in OPTIMADE Property Definitions and the precise format of this dictionary.</p></li>
</ul>
<ul id="definition-of-the-x-optimade-dimensions-field">
<li><p><span class="field docutils literal"><span class="pre">x-optimade-dimensions</span></span>: Dictionary.
Specification of the dimensions of one or multi-dimensional data represented as multiple levels of lists.
Each dimension is given a name and optionally a fixed size.</p>
<p><strong>REQUIRED keys:</strong></p>
<ul>
<li><p><span class="field docutils literal">names</span>: List of Strings.
A list of names of the dimensions of the underlying one or multi-dimensionsional data represented as mutiple levels of lists.
The order is that the the first name applies to the outermost list, the next name to the lists embedded in that list, etc.</p></li>
<li><p><span class="field docutils literal">sizes</span>: List of Integers or <span class="val docutils literal">null</span>.
A list of fixed length requirements on the underlying one or multi-dimensionsional data represented as mutiple levels of lists.
The order is that the the first name applies to the outermost list, the next name to the lists embedded in that list, etc.
The data only validates if the respective level consists of lists of exactly this length.
A value of <span class="val docutils literal">null</span> allows arbitrary-length lists at the corresponding level.</p>
<p>Note: OPTIMADE Property Definitions use this field, and MUST NOT use the JSON Schema validating fields minItems and maxItems since that would require reprocessing the schema to handle requests using the OPTIMADE features that requests partial data in lists.
Instead, the length of lists can be validated against the length information provided in the <span class="field docutils literal">sizes</span> subfield of <span class="field docutils literal"><span class="pre">x-optimade-dimensions</span></span> (which, at this time, can only specify a fixed length requirement.)</p>
</li>
</ul>
</li>
<li><p><span class="field docutils literal"><span class="pre">x-optimade-implementation</span></span>: Dictionary.
A dictionary describing the level of OPTIMADE API functionality provided by the present implementation.
If an implementation omits this field in its response, a client interacting with that implementation SHOULD NOT make any assumptions about the availability of these features.</p>
<p>The dictionary has the following format:</p>
<p><strong>OPTIONAL keys:</strong></p>
<ul>
<li><p><span class="field docutils literal">sortable</span>: Boolean.
If <span class="val docutils literal">TRUE</span>, specifies that results can be sorted on this property (see <a class="reference internal" href="#entry-listing-url-query-parameters">Entry Listing URL Query Parameters</a> for more information on this field).
If <span class="val docutils literal">FALSE</span>, specifies that results cannot be sorted on this property.
Omitting the field is equivalent to <span class="val docutils literal">FALSE</span>.</p></li>
<li><p><span class="field docutils literal"><span class="pre">query-support</span></span>: String.
Defines a required level of support in formulating queries on this field.
The string MUST be one of the following:</p>
<ul class="simple">
<li><p><span class="val docutils literal">all mandatory</span>: the defined property MUST be queryable using the OPTIMADE filter language with support for all mandatory filter features.</p></li>
<li><p><span class="val docutils literal">equality only</span>: the defined property MUST be queryable using the OPTIMADE filter language equality and inequality operators. Other filter language features do not need to be available.</p></li>
<li><p><span class="val docutils literal">partial</span>: the defined property MUST be queryable with support for a subset of the filter language operators as specified by the field <span class="field docutils literal"><span class="pre">query-support-operators</span></span>.</p></li>
<li><p><span class="val docutils literal">none</span>: the defined property does not need to be queryable with any features of the filter language.</p></li>
</ul>
<p>Omitting the field or <span class="val docutils literal">null</span> is equivalent to <span class="val docutils literal">none</span>.</p>
</li>
<li><p><span class="field docutils literal"><span class="pre">query-support-operators</span></span>: List of Strings.
Defines the filter language features supported on this property.
MUST be present and not <span class="val docutils literal">null</span> if and only if <span class="field docutils literal"><span class="pre">query-support</span></span> is <span class="val docutils literal">partial</span>.</p>
<p>Each string in the list MUST be one of <span class="val docutils literal">&lt;</span>, <span class="val docutils literal">&lt;=</span>, <span class="val docutils literal">&gt;</span>, <span class="val docutils literal">&gt;=</span>, <span class="val docutils literal">=</span>, <span class="val docutils literal">!=</span>, <span class="val docutils literal">CONTAINS</span>, <span class="val docutils literal">STARTS WITH</span>, <span class="val docutils literal">ENDS WITH</span>, <span class="val docutils literal">HAS</span>, <span class="val docutils literal">HAS ALL</span>, <span class="val docutils literal">HAS ANY</span>, <span class="val docutils literal">HAS ONLY</span>, <span class="val docutils literal">IS KNOWN</span>, <span class="val docutils literal">IS UNKNOWN</span> with the following meanings:</p>
<ul class="simple">
<li><p><span class="val docutils literal">&lt;</span>, <span class="val docutils literal">&lt;=</span>, <span class="val docutils literal">&gt;</span>, <span class="val docutils literal">&gt;=</span>, <span class="val docutils literal">=</span>, <span class="val docutils literal">!=</span>: indicating support for filtering this property using the respective operator.
If the property is of Boolean type, support for <span class="val docutils literal">=</span> also designates support for boolean comparisons with the property being true that omit &quot;<span class="filter-fragment docutils literal">= TRUE</span>&quot;, e.g., specifying that filtering for &quot;<code class="filter">is_yellow = TRUE</code>&quot; is supported also implies support for &quot;<code class="filter">is_yellow</code>&quot; (which means the same thing).
Support for &quot;<code class="filter">NOT is_yellow</code>&quot; also follows.</p></li>
<li><p><span class="val docutils literal">CONTAINS</span>, <span class="val docutils literal">STARTS WITH</span>, <span class="val docutils literal">ENDS WITH</span>: indicating support for substring filtering of this property using the respective operator. MUST NOT appear if the property is not of type String.</p></li>
<li><p><span class="val docutils literal">HAS</span>, <span class="val docutils literal">HAS ALL</span>, <span class="val docutils literal">HAS ANY</span>: indicating support of the MANDATORY features for list property comparison using the respective operator. MUST NOT appear if the property is not of type List.</p></li>
<li><p><span class="val docutils literal">HAS ONLY</span>: indicating support for list property comparison with all or a subset of the OPTIONAL constructs using this operator. MUST NOT appear if the property is not of type List.</p></li>
<li><p><span class="val docutils literal">IS KNOWN</span>, <span class="val docutils literal">IS UNKNOWN</span>: indicating support for filtering this property on unknown values using the respective operator.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal"><span class="pre">response-default</span></span>: Boolean.
The value <span class="val docutils literal">TRUE</span> means the implementation includes the property in responses by default, i.e., when not specifically requested.
The value <span class="val docutils literal">FALSE</span> means that the property is only included when requested.
Omitting the field or <span class="val docutils literal">null</span> means the implementation does not declare if the property will be included in responses by default or not.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal"><span class="pre">x-optimade-requirements</span></span>: Dictionary.
A dictionary describing the level of OPTIMADE API functionality required by all implementations of this property.
Omitting this field means the corresponding functionality is OPTIONAL.
The dictionary has the same format as <span class="field docutils literal"><span class="pre">x-optimade-implementation</span></span>, <em>except that</em> the <span class="field docutils literal"><span class="pre">response-default</span></span> field SHOULD NOT appear, and the following additional OPTIONAL fields are allowed:</p>
<ul>
<li><p><span class="field docutils literal">support</span>: String.
Describes the minimal required level of support for the Property by an implementation.
This field only has meaning for the defined property when appearing in the <span class="field docutils literal"><span class="pre">x-optimade-requirements</span></span> at the outermost level of the definition.
Nevertheless, it MAY appear in other places, e.g., if a nested property definition has been inserted that references its own <span class="field docutils literal">$id</span>.
The string MUST be one of the following:</p>
<ul class="simple">
<li><p><span class="val docutils literal">must</span>: the defined property MUST be recognized by the implementation (e.g., in filter strings) and MUST NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><span class="val docutils literal">should</span>: the defined property MUST be recognized by the implementation (e.g., in filter strings) and SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><span class="val docutils literal">may</span>: it is OPTIONAL for the implementation to recognize the defined property and it MAY be equal to <span class="val docutils literal">null</span>.</p></li>
</ul>
<p>Omitting the field is equivalent to <span class="val docutils literal">may</span>.</p>
<p>Note: the specification by this field of whether the defined property can be <span class="val docutils literal">null</span> or not MUST match the value of the <span class="field docutils literal">type</span> field.
If <span class="val docutils literal">null</span> values are allowed, that field must be a list where the string <span class="val docutils literal">&quot;null&quot;</span> is the second element.</p>
</li>
<li><p><span class="field docutils literal"><span class="pre">response-default-level</span></span>: String.
Expresses if an implementation of this property is required to include or exclude it in responses when not specifically requested.
This field only has meaning for the defined property when appearing in the <span class="field docutils literal"><span class="pre">x-optimade-requirements</span></span> at the outermost level of the definition.
Nevertheless, it MAY appear in other places, e.g., if a nested property definition has been inserted that references its own <span class="field docutils literal">$id</span>.</p>
<p>The string MUST be one of the following:</p>
<ul class="simple">
<li><p><span class="val docutils literal">always</span>: the defined property MUST always be included in responses and cannot be excluded even by request via, e.g., the <span class="query-param docutils literal">response_fields</span> query parameter.
This is primarily intended for the <span class="field docutils literal">id</span> and <span class="field docutils literal">type</span> fields, which are required for the JSON:API response format to be valid.</p></li>
<li><p><span class="val docutils literal">must</span>: the defined property MUST be included in responses unless specifically excluded.</p></li>
<li><p><span class="val docutils literal">should</span>: the defined property SHOULD be included in responses unless specifically excluded.</p></li>
<li><p><span class="val docutils literal">may</span>: it is OPTIONAL for the implementation to include the defined property in responses.</p></li>
<li><p><span class="val docutils literal">should not</span>: the defined property SHOULD NOT be included in responses unless specifically requested.</p></li>
<li><p><span class="val docutils literal">must not</span>: the defined property MUST NOT be included in responses unless specifically requested.</p></li>
</ul>
<p>Omitting the field is equivalent to <span class="val docutils literal">may</span>.</p>
</li>
</ul>
</li>
</ul>
<section id="property-definition-keys-from-json-schema">
<h3><a class="toc-backref" href="#toc-entry-61" role="doc-backlink"><span class="sectnum">7.1 </span>Property Definition keys from JSON Schema</a></h3>
<p>In addition to the requirements on the format of a Property Definition in the previous section, it MUST also adhere to the OPTIONAL and REQUIRED keys described in this subsection.
The format described in this subsection forms a subset of the <a class="reference external" href="https://json-schema.org/draft/2020-12/json-schema-validation.html">JSON Schema Validation Draft 2020-12</a> and <a class="reference external" href="https://json-schema.org/draft/2020-12/json-schema-core.html">JSON Schema Core Draft 2020-12</a> standards.</p>
<p><strong>REQUIRED keys</strong></p>
<ul id="definition-of-the-type-field">
<li><p><span class="field docutils literal">type</span>: List.
Specifies the corresponding JSON type for this level of the defined property and whether the property can be <span class="val docutils literal">null</span> or not.
The value is directly correlated with <span class="field docutils literal"><span class="pre">x-optimade-type</span></span> (cf. the <a class="reference internal" href="#definition-of-the-x-optimade-type-field">definition of the x-optimade-type field</a>).</p>
<p>It MUST be a list of one or two elements where the first element is a string correlated with <span class="field docutils literal"><span class="pre">x-optimade-type</span></span> as follows; if <span class="field docutils literal"><span class="pre">x-optimade-type</span></span> is:</p>
<ul class="simple">
<li><p><span class="val docutils literal">&quot;boolean&quot;</span>, <span class="val docutils literal">&quot;string&quot;</span>, or <span class="val docutils literal">&quot;integer&quot;</span> then <span class="field docutils literal">type</span> is the same string.</p></li>
<li><p><span class="val docutils literal">&quot;dictionary&quot;</span> then <span class="field docutils literal">type</span> is <cite>&quot;object&quot;</cite>.</p></li>
<li><p><span class="val docutils literal">&quot;list&quot;</span> then <span class="field docutils literal">type</span> is <cite>&quot;array&quot;</cite>.</p></li>
<li><p><span class="val docutils literal">&quot;float&quot;</span> then <span class="field docutils literal">type</span> is <cite>&quot;number&quot;</cite>.</p></li>
<li><p><span class="val docutils literal">&quot;timestamp&quot;</span> then <span class="field docutils literal">type</span> is <cite>&quot;string&quot;</cite>.</p></li>
</ul>
<p>If the second element is included, it MUST be the string <span class="val docutils literal">&quot;null&quot;</span>.
This two element form specifies that the defined property can be <span class="val docutils literal">null</span>.</p>
<p>The inclusion or not of <span class="val docutils literal">&quot;null&quot;</span> in the field <span class="field docutils literal">type</span> for a subfield defined at a nested level by a Property Definition declares if that subfield is nullable.
Property Definitions for which the nullability of a subfield differs MUST NOT share the same <span class="field docutils literal">$id</span>.
However, the nullability of the subfield SHOULD NOT be taken into account when comparing the nested Property Definition for that subfield with other definitions, i.e., a nullable and non-nullable subfield that are otherwise defined the same SHOULD share the same <span class="field docutils literal">$id</span>.
Hence, formally OPTIMADE Property Definitions regard nullability of a subfield to belong one level <em>above</em> where it appears in the JSON Schema definition.</p>
<p><strong>Implementation notes:</strong></p>
<ul class="simple">
<li><p>The field <span class="field docutils literal">type</span> can be derived from the field <span class="field docutils literal"><span class="pre">x-optimade-type</span></span> and its role is only to provide the JSON type names corresponding to <span class="field docutils literal"><span class="pre">x-optimade-type</span></span>.
The motivation to include these type names is that it makes the JSON representation of a Property Definition a fully valid standard JSON Schema.
Nevertheless, for consistency across formats, these JSON type names MUST still be included when a property definition is represented in other output formats (i.e., the JSON names MUST NOT be translated into the type names of that output format).</p></li>
<li><p>The allowed values of the <span class="field docutils literal">type</span> field are highly restricted compared to what is permitted using the full JSON Schema standard.
Values can only be defined to be a single OPTIMADE data type or, optionally, <span class="val docutils literal">null</span>.
This restriction is intended to reduce the complexity of possible data types that implementations have to handle in different formats and database backends.</p></li>
</ul>
</li>
</ul>
<p><strong>Keys that are REQUIRED on the outermost level of a Property Definition, but otherwise OPTIONAL:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">$schema</span>: String.
A URL for a meta schema that describes the Property Definitions format.
For Property Definitions adhering to the format described in this document, it should be set to: <span class="val docutils literal"><span class="pre">https://schemas.optimade.org/meta/v1.2/optimade/property_definition.json</span></span>.</p></li>
</ul>
<ul class="simple" id="definition-of-the-id-field">
<li><p><span class="field docutils literal">$id</span>: String.
A static IRI identifier that is a URN or URL representing the specific version of this level of the defined property.
(If it is a URL, clients SHOULD NOT assign any interpretation to the response when resolving that URL.)
It SHOULD NOT be changed as long as the property definition remains the same, and MUST be changed when the property definition changes.</p></li>
<li><p><span class="field docutils literal">title</span>: String.
A short single-line human-readable explanation of the defined property appropriate to show as part of a user interface.</p></li>
</ul>
<ul class="simple" id="definition-of-the-description-field">
<li><p><span class="field docutils literal">description</span>: String.
A human-readable multi-line description that explains the purpose, requirements, and conventions of the defined property.
The format SHOULD be a one-line description, followed by a new paragraph (two newlines), followed by a more detailed description of all the requirements and conventions of the defined property.
Formatting in the text SHOULD use Markdown in the <a class="reference external" href="https://spec.commonmark.org/0.30/">CommonMark v0.3 format</a> format, with mathematical expressions written to render correctly with the LaTeX mode of <a class="reference external" href="https://docs.mathjax.org/en/v3.2-latest/">Mathjax 3.2</a>.
When possible, it is preferable for mathematical expressions to use as straightforward notation as possible to make them readable also when not rendered.</p></li>
</ul>
<p><strong>OPTIONAL keys</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">$comment</span>: String.
A human-readable comment relevant in the context of the raw definition data.
These comments should normally not be shown to the end users.
Comments pertaining to the Property Definition that are relevant to end users should go into the field <span class="field docutils literal">description</span>.
Formatting in the text SHOULD use Markdown using the format described in the <a class="reference internal" href="#definition-of-the-description-field">definition of the description field</a>.</p></li>
<li><p><span class="field docutils literal">deprecated</span>: Boolean.
If <span class="val docutils literal">TRUE</span>, implementations SHOULD not use the defined property, and it MAY be removed in the future.
If <span class="val docutils literal">FALSE</span>, the defined property is not deprecated.
The field not being present means <span class="val docutils literal">FALSE</span>.
A Property Definition marked as deprecated is generally considered to be the same as its non-deprecated counterpart, i.e., it SHOULD retain its <span class="field docutils literal">$id</span>.</p></li>
<li><p><span class="field docutils literal">examples</span>: List.
A list of example values that the defined property can have.
These examples MUST all be of a data type that matches the <span class="field docutils literal">type</span> field and otherwise adhere to the rest of the Property Definition.</p></li>
<li><p><span class="field docutils literal">enum</span>: List.
The defined property MUST take one of the values given in the provided list.
The items in the list MUST all be of a data type that matches the <span class="field docutils literal">type</span> field and otherwise adhere to the rest of the Property Definition.
If this key is given, for <span class="val docutils literal">null</span> to be a valid value of the defined property, the list MUST contain a <span class="val docutils literal">null</span> value and the <span class="field docutils literal">type</span> MUST be a list where the second value is the string <span class="val docutils literal">&quot;null&quot;</span>.</p></li>
</ul>
<p>Furthermore, depending on what string the <span class="field docutils literal">type</span> is equal to, or contains as first element, the following additional requirements also apply:</p>
<ul>
<li><p><span class="val docutils literal">&quot;object&quot;</span>:</p>
<p><strong>REQUIRED</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">properties</span>: Dictionary.
Gives key-value pairs where each value is an inner Property Definition.
The defined property is a dictionary that can only contain keys present in this dictionary, and, if so, the corresponding value is described by the respective inner Property Definition.
(Or, if the <span class="field docutils literal">type</span> field is the list &quot;object&quot; and &quot;null&quot;, it can also be <span class="val docutils literal">null</span>.)</p></li>
</ul>
<p><strong>OPTIONAL</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">required</span>: List.
The list MUST only contain strings.
The defined property MUST have keys that match all the strings in this list.
Other keys present in the <span class="field docutils literal">properties</span> field are OPTIONAL in the defined property.
If not present or empty, all keys in <span class="field docutils literal">properties</span> are regarded as OPTIONAL.</p></li>
<li><p><span class="field docutils literal">maxProperties</span>: Integer.
The defined property is a dictionary where the number of keys MUST be less than or equal to the number given.</p></li>
<li><p><span class="field docutils literal">minProperties</span>: Integer.
The defined property is a dictionary where the number of keys MUST be greater than or equal to the number given.</p></li>
<li><p><span class="field docutils literal">dependentRequired</span>: Dictionary.
The dictionary keys are strings and the values are lists of unique strings.
If the defined property has a key that is equal to a key in the given dictionary, the defined property MUST also have keys that match each of the corresponding values.
No restriction is inferred from this field for keys in the defined property that do not match any key in the given dictionary.</p></li>
</ul>
</li>
<li><p><span class="val docutils literal">&quot;array&quot;</span>:</p>
<p><strong>REQUIRED</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">items</span>: Dictionary.
Specifies an inner Property Definition.
The defined property is a list where each item MUST match this inner Property Definition.</p></li>
</ul>
<p><strong>OPTIONAL</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">uniqueItems</span>: Boolean.
If <span class="val docutils literal">TRUE</span>, the defined property is an array that MUST only contain unique items.
If <span class="val docutils literal">FALSE</span>, this field sets no limitation on the defined property.</p></li>
</ul>
<p>Furthermore, despite being defined in the JSON Schema standard, the fields <span class="field docutils literal">minItems</span> and <span class="field docutils literal">maxItems</span> MUST NOT be used to indicate limits of the number of items of a list.
See the <a class="reference internal" href="#definition-of-the-x-optimade-dimensions-field">definition of the x-optimade-dimensions field</a> for more information.</p>
</li>
<li><p><span class="val docutils literal">&quot;integer&quot;</span>:</p>
<p><strong>OPTIONAL</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">multipleOf</span>: Integer.
An integer is strictly greater than 0.
The defined property MUST have an integer value that when divided by the given integer results in an integer (i.e., it must be even divisible by this integer without a fractional part).</p></li>
<li><p><span class="field docutils literal">maximum</span>: Integer.
The defined property is an integer that MUST be less than or equal to this number.</p></li>
<li><p><span class="field docutils literal">exclusiveMaximum</span>: Integer.
The defined property is an integer that MUST be strictly less than this number; it cannot be equal to the number.</p></li>
<li><p><span class="field docutils literal">minimum</span>: Integer.
The defined property is an integer that MUST be greater than or equal to this number.</p></li>
<li><p><span class="field docutils literal">exclusiveMinimum</span>: Integer.
The defined property is an integer that MUST be strictly greater than this number; it cannot be equal to the number.</p></li>
</ul>
</li>
<li><p><span class="val docutils literal">&quot;number&quot;</span>:</p>
<p><strong>OPTIONAL</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">multipleOf</span>: Float.
An integer is strictly greater than 0.
The defined property MUST have an integer value that when divided by the given integer results in an integer (i.e., it must be even divisible by this integer without a fractional part).</p></li>
<li><p><span class="field docutils literal">maximum</span>: Float.
The defined property is a float that MUST be less than or equal to this number.</p></li>
<li><p><span class="field docutils literal">exclusiveMaximum</span>: Float.
The defined property is a float that MUST be strictly less than this number; it cannot be equal to the number.</p></li>
<li><p><span class="field docutils literal">minimum</span>: Float.
The defined property is a float that MUST be greater than or equal to this number.</p></li>
<li><p><span class="field docutils literal">exclusiveMinimum</span>: Float.
The defined property is a float that MUST be strictly greater than this number; it cannot be equal to the number.</p></li>
</ul>
</li>
<li><p><span class="val docutils literal">&quot;string&quot;</span>:</p>
<p><strong>OPTIONAL</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">maxLength</span>: Integer.
A non-negative integer.
The defined property is a string that MUST have a length that is less than or equal to the given integer.
(The length of the string is the number of individual Unicode characters it is composed of.)</p></li>
<li><p><span class="field docutils literal">minLength</span>: Integer.
A non-negative integer.
The defined property is a string that MUST have a length that is less than or equal to the given integer.
(The definition of the length of a string is the same as in the field <span class="field docutils literal">maxLength</span>.)</p></li>
<li><p><span class="field docutils literal">format</span>: String.
Choose one of the following values to indicate that the defined property is a string that MUST adhere to the specified format:</p>
<ul>
<li><p><span class="val docutils literal"><span class="pre">&quot;date-time&quot;</span></span>: the date-time production in <a class="reference external" href="https://tools.ietf.org/html/rfc3339.html">RFC 3339</a> section 5.6.</p></li>
<li><p><span class="val docutils literal">&quot;date&quot;</span>: the full-date production in <a class="reference external" href="https://tools.ietf.org/html/rfc3339.html">RFC 3339</a> section 5.6.</p></li>
<li><p><span class="val docutils literal">&quot;time&quot;</span>: the full-time production in <a class="reference external" href="https://tools.ietf.org/html/rfc3339.html">RFC 3339</a> section 5.6.</p></li>
<li><p><span class="val docutils literal">&quot;duration&quot;</span>: the duration production in <a class="reference external" href="https://tools.ietf.org/html/rfc3339.html">RFC 3339</a> Appendix A.</p></li>
<li><p><span class="val docutils literal">&quot;email&quot;</span>: the &quot;Mailbox&quot; ABNF rule in <a class="reference external" href="https://tools.ietf.org/html/rfc5321.html">RFC 5321</a> section 4.1.2.</p></li>
<li><p><span class="val docutils literal">&quot;uri&quot;</span>: a string instance is valid against this attribute if it is a valid URI according to <a class="reference external" href="https://tools.ietf.org/html/rfc3986.html">RFC 3986</a>.</p></li>
<li><p><span class="val docutils literal">&quot;iri&quot;</span>: a string instance is valid against this attribute if it is a valid IRI according to <a class="reference external" href="https://tools.ietf.org/html/rfc3987.html">RFC 3987</a>.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal">pattern</span>: String.
This string SHOULD be a valid regular expression, according to the ECMA-262 regular expression dialect.
A string instance is considered valid if the regular expression matches the instance successfully.
The regular expression is not implicitly anchored, i.e., it can match the string at any position unless the expression contains a leading '^' or a trailing '$'.</p></li>
</ul>
</li>
</ul>
<p>A complete example of a Property Definition is found in the appendix <a class="reference internal" href="#property-definition-example">Property Definition Example</a>.</p>
</section>
<section id="physical-units-in-property-definitions">
<h3><a class="toc-backref" href="#toc-entry-62" role="doc-backlink"><span class="sectnum">7.2 </span>Physical Units in Property Definitions</a></h3>
<p>In OPTIMADE, there is no facility to allow a property to be represented in a choice of units, e.g., either ångström (Å) or meter (m).
The unit is always permanently fixed by the Property Definition.
Clients and servers that use other units internally thus have to do unit conversions as part of preparing and processing OPTIMADE responses.</p>
<p>The physical unit of a property, the embedded items of a list, or values of a dictionary, are defined with the field <span class="field docutils literal"><span class="pre">x-optimade-unit</span></span> with the following requirements:</p>
<ul class="simple">
<li><p>The field MUST be given with a non-<span class="val docutils literal">null</span> value both at the highest level in the OPTIMADE Property Definition and all inner Property Definitions.</p></li>
<li><p>If the property refers to a physical quantity that is dimensionless and unitless (often also referred to as having the dimension 1) or refers to a dimensionless and unitless count of something (e.g., the number of protons in a nucleus) the field MUST have the value <span class="val docutils literal">dimensionless</span>.
However, quantities that use counting units, e.g., the mole, or quantities that use dimensionless units, e.g., the radian MUST NOT set the field to <span class="val docutils literal">dimensionless</span>.</p></li>
<li><p>If the property refers to an entity for which the assignment of a unit would not make sense, e.g., a string representing a chemical formula or a serial number the field MUST have the value <span class="val docutils literal">inapplicable</span>.</p></li>
<li><p>If the field does not take the value <span class="val docutils literal">dimensionless</span> or <span class="val docutils literal">inapplicable</span>, it MUST be set to a single unit symbol or a Compound Unit Expressions from a set of unit symbols using the format described in <a class="reference internal" href="#compound-unit-expressions">Compound Unit Expressions</a>.</p></li>
<li><p>All unit symbols used in <span class="field docutils literal"><span class="pre">x-optimade-unit</span></span> fields at any level in a Property Definition MUST be defined in the <span class="field docutils literal">units</span> field inside the <span class="field docutils literal"><span class="pre">x-optimade-property</span></span> field in the outermost level of the Property Definition, or in the <span class="field docutils literal">units</span> field in the Entry info endpoint (the latter is only possible for Property Definitions embedded in such a response).</p></li>
<li><p>The <span class="field docutils literal">units</span> MUST be a list of dictionaries using the format for OPTIMADE Physical Unit Definitions described in <a class="reference internal" href="#physical-unit-definitions">Physical Unit Definitions</a>.</p></li>
</ul>
</section>
<section id="compound-unit-expressions">
<h3><a class="toc-backref" href="#toc-entry-63" role="doc-backlink"><span class="sectnum">7.3 </span>Compound Unit Expressions</a></h3>
<p>A Compound Unit Expression is formed by a sequence of symbols for units or constants separated by a single multiplication <span class="docutils literal">*</span> character.
Each symbol can also be suffixed by a single <span class="docutils literal">^</span> character followed by a positive or negative integer to indicate the power of the preceding symbol, e.g., <span class="docutils literal">m^3</span> for cubic meter, <span class="docutils literal"><span class="pre">m^-3</span></span> for inverse cubic meter.
(Positive integers MUST NOT be preceded by a plus sign.)
Each unit or constant symbol MAY be directly prefixed by a prefix symbol.
A prefix symbol MUST be directly followed by a unit symbol, i.e., it MUST NOT be used on its own, and MUST NOT be followed by <span class="docutils literal">^</span> to indicate a power.
When defining prefix symbols it is important to ensure that they do not introduce ambiguity.
If there are ambiguous interpretations of a symbol as either having or not having a prefix, it MUST be interpreted as a unit without a prefix.</p>
<p>Furthermore:</p>
<ul class="simple">
<li><p>No whitespace, parentheses, or other symbols than specified above are permitted.</p></li>
<li><p>The (prefixed) unit and constant symbols MUST appear in alphabetical order.</p></li>
</ul>
</section>
<section id="physical-unit-definitions">
<h3><a class="toc-backref" href="#toc-entry-64" role="doc-backlink"><span class="sectnum">7.4 </span>Physical Unit Definitions</a></h3>
<p>An OPTIMADE Physical Unit Definition is a dictionary adhering to the following format:</p>
<p><strong>REQUIRED keys:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">$schema</span>: String.
A URL for a meta schema that describes the Physical Unit Definitions format.
For Property Definitions adhering to the format described in this document, it should be set to: <span class="val docutils literal"><span class="pre">https://schemas.optimade.org/meta/v1.2/optimade/physical_unit_definition.json</span></span>.</p></li>
<li><p><span class="field docutils literal"><span class="pre">x-optimade-definition</span></span>: Dictionary.
The same field as defined in the <a class="reference internal" href="#definition-of-the-x-optimade-definition-field">definition of the x-optimade-definition field</a> for Property Definitions but where the <span class="field docutils literal">kind</span> subfield MUST be <span class="val docutils literal">unit</span>.</p></li>
</ul>
<ul id="definition-of-the-id-field-in-physical-unit-definitions">
<li><p><span class="field docutils literal">$id</span>: String.
A static IRI identifier that is a URN or URL representing the specific version of the Physical Unit Definition.
(If it is a URL, clients SHOULD NOT assign any interpretation to the response when resolving that URL.)
It SHOULD NOT be changed as long as the Physical Unit Definition remains the same, and SHOULD be changed when the definition changes.
Physical Unit Definitions SHOULD be regarded as the same if they only differ by:</p>
<ul class="simple">
<li><p>Additions of annotating notes to end of the <span class="field docutils literal">description</span> field.</p></li>
<li><p>Changes to the following specific fields at any level: <span class="field docutils literal">deprecated</span> and <span class="field docutils literal">$comment</span>.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal">symbol</span>: String.
Specifies the symbol to be used in <span class="field docutils literal"><span class="pre">x-optimade-unit</span></span> to reference this unit.</p></li>
<li><p><span class="field docutils literal">title</span>: String.
A human-readable single-line string name for the unit.</p></li>
<li><p><span class="field docutils literal">description</span>: String.
A human-readable multiple-line detailed description of the unit.</p>
<p>Additions appended to the end of the <span class="field docutils literal">description</span> field that are clearly marked as notes that clarify the definition without changing it are viewed as annotations to the Physical Unit Definition rather than an integral part of it.
Such annotations SHOULD only be added to the end of an otherwise unmodified <span class="field docutils literal">description</span> and MUST NOT change the meaning or interpretation of the text above them.
The purpose is to provide a way to add explanations and clarifications to a definition without having to regard it as a new definition.
For example, these annotations to the description MAY be used to explain why a definition has been deprecated.</p>
</li>
</ul>
<p><strong>OPTIONAL keys:</strong></p>
<ul>
<li><p><span class="field docutils literal">standard</span>: Dictionary.
This field is used to express that the unit is part of a preexisting standard.
The dictionary has the following format:</p>
<p><strong>REQUIRED keys:</strong></p>
<ul>
<li><p><span class="field docutils literal">name</span>: String.
The abbreviated name of the standard being referenced.
One of the following:</p>
<ul>
<li><p><span class="val docutils literal">&quot;si&quot;</span>: the symbol is defined as part of the SI standard of unit symbols and prefixes.</p></li>
<li><p><span class="val docutils literal">&quot;codata&quot;</span>: the symbol is defined as part of one of the CODATA series of publications.</p></li>
<li><p><span class="val docutils literal"><span class="pre">&quot;iso-iec-80000&quot;</span></span>: the symbol is defined in the iso-iec-80000 standard.</p></li>
<li><p><span class="val docutils literal">&quot;gnu units&quot;</span>: the symbol is a (compound) unit expression based on the symbols in the file <span class="docutils literal">definitions.units</span> distributed with <a class="reference external" href="https://www.gnu.org/software/units/">GNU Units software</a>.</p>
<p>A standard set of symbols for units and prefixes for OPTIMADE is taken from version 3.15 of the (separately versioned) unit database <span class="docutils literal">definitions.units</span> included with the <a class="reference external" href="http://ftp.gnu.org/gnu/units/">source distribution</a> of <a class="reference external" href="https://www.gnu.org/software/units/">GNU Units</a> version 2.22.
A prefix is indicated in the file by a trailing <span class="docutils literal">-</span>, but that trailing character MUST NOT be included when using it as a prefix.
If the unit is available in this database, or if it can be expressed as a Compound Unit Expression using these units and prefixes, the value of <span class="field docutils literal"><span class="pre">x-optimade-unit</span></span> SHOULD use the (compound) string symbol.
If there are multiple prefixes in the file with the same meaning, an implementation SHOULD use the <em>shortest one</em> consisting of only lowercase letters a-z and underscores, but no other symbols.
If there are multiple ones with the same shortest length, then the first one of those SHOULD be used.
For example, the GNU Units database defines the symbol <span class="val docutils literal">&quot;km&quot;</span> for kilometers by a combination of the <span class="docutils literal">k-</span> SI kilo prefix and the <span class="docutils literal">m</span> symbol for the SI meter unit.</p>
</li>
<li><p><span class="val docutils literal">&quot;ucum&quot;</span>: the symbol is defined in <a class="reference external" href="https://unitsofmeasure.org/ucum.html">The Unified Code for Units of Measure</a> (UCUM) standard.</p></li>
<li><p><span class="val docutils literal">&quot;qudt&quot;</span>: the symbol is defined in the <a class="reference external" href="http://qudt.org/">QUDT</a> standard.
Not only symbols strictly defined within the standard are allowed, but also other compound unit expressions created according to the scheme for how new such symbols are formed in this standard.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal">symbol</span>: String.
The symbol to use from the referenced standard, expressed according to that standard.
The field MAY use mathematical expressions written the same way as described in the <a class="reference internal" href="#definition-of-the-description-field">definition of the description field</a>.
This field MAY be different from the symbol being defined via the definition if the unit will be referenced in <span class="field docutils literal"><span class="pre">x-optimade-unit</span></span> field using a different symbol than the one used in the standard or if the symbol is expressed in the standard in a way that requires mathematical notation.
However, if possible, the <span class="field docutils literal">symbol</span> field SHOULD be the same.</p></li>
</ul>
<p><strong>OPTIONAL keys:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">version</span>: String.
The version string of the referenced standard.</p></li>
<li><p><span class="field docutils literal">year</span>: Integer.
The year that the standard adopted the definition.</p></li>
<li><p><span class="field docutils literal">category</span>
The category of the definition in case the standard uses categories to organize definitions.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal"><span class="pre">alternate-symbols</span></span>: List of String.
A list of other symbols that are commonly associated with the unit.
The stings MAY use mathematical expressions written the same way as described in the <a class="reference internal" href="#definition-of-the-description-field">definition of the description field</a>.</p></li>
<li><p><span class="field docutils literal"><span class="pre">property-format</span></span>: String.
Specifies the minor version of the Property Definitions format that the Physical Units Definition is expressed in.
(The Physical Units Definition format is not versioned independently.)
The format is the same as described above for the <a class="reference internal" href="#definition-of-the-property-format-field">definition of the property-format field</a> in Property Definitions.
This field MUST be included when Physical Unit Definitions are used standalone, i.e., when they are not embedded inside a Property Definition that already declares a <span class="field docutils literal"><span class="pre">property-format</span></span> at the top level.</p></li>
<li><p><span class="field docutils literal">version</span>: String.
This string indicates the version of the Physical Unit Definition.
The string SHOULD be in the format described by the <a class="reference external" href="https://semver.org/spec/v2.0.0.html">semantic versioning v2</a> standard.</p></li>
<li><p><span class="field docutils literal">resources</span>: List of Dictionaries.
A list of dictionaries that reference remote resources that describe the unit.
The format of each dictionary is:</p>
<p><strong>REQUIRED keys:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">relation</span>: String.
A human-readable description of the relationship between the unit and the remote resource, e.g., a &quot;natural language description&quot;.</p></li>
<li><p><span class="field docutils literal"><span class="pre">resource-id</span></span>: String.
An IRI of the external resource (which MAY be a resolvable URL).</p></li>
</ul>
</li>
</ul>
<ul id="definition-of-defining-relation">
<li><p><span class="field docutils literal"><span class="pre">defining-relation</span></span>: Dictionary.
A dictionary that encodes a defining relation to another unit or set of units, with the primary intended use of relating a unit to its definition in SI units, if such a relationship exists.
Some units, e.g., the atomic mass unit (also known as dalton, commonly denoted <span class="docutils literal">u</span>), only has an approximate relationship to SI units, in which case the <span class="field docutils literal"><span class="pre">defining-relation</span></span> MUST be omitted or <span class="val docutils literal">null</span>.
The dictionary MUST adhere to the following format:</p>
<p><strong>OPTIONAL keys:</strong></p>
<ul>
<li><p><span class="field docutils literal"><span class="pre">base-units</span></span>: List of Dictionaries.
A list specifying the base IRIs and unit symbols for the units in which the dimensional formula for the defining relation is expressed.
Each item MUST be a dictionary that adheres to the following format:</p>
<p><strong>REQUIRED keys:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">symbol</span>: String.
The symbol used to reference this unit in the dimensional formula.</p></li>
<li><p><span class="field docutils literal">id</span>: String.
The IRI of one of the units referenced in the dimensional formula for the defining relation.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal"><span class="pre">base-units-expression</span></span>: String.
A string expressing the base units part of the defining relation for the unit being defined.
It MUST adhere to the format for compound unit expression described in <a class="reference internal" href="#physical-units-in-property-definitions">Physical Units in Property Definitions</a>.
If the field is missing or <span class="val docutils literal">null</span> the base-units-expression is taken to be equal to 1, i.e., the defining relation is dimensionless.</p></li>
<li><p><span class="field docutils literal">scale</span>: Dictionary.
A dictionary specifying the scale in the defining relation, adhering to the following format:</p>
<p><strong>OPTIONAL keys:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">numerator</span>: Integer.</p></li>
<li><p><span class="field docutils literal">denominator</span>: Integer.</p></li>
<li><p><span class="field docutils literal">base</span>: Integer.</p></li>
<li><p><span class="field docutils literal">exponent</span>: Integer.</p></li>
</ul>
<p>These four fields specify the value as the rational number <span class="field docutils literal">numerator</span> / <span class="field docutils literal">denominator</span>, multiplied by <span class="field docutils literal">base</span> to the power of <span class="field docutils literal">exponent</span>.
If omitted or <span class="val docutils literal">null</span>, the defaults for the <span class="field docutils literal">numerator</span>, <span class="field docutils literal">denominator</span>, <span class="field docutils literal">base</span>, and <span class="field docutils literal">exponent</span> are respectively 1, 1, 10, and 0.</p>
<ul class="simple">
<li><p><span class="field docutils literal">standard_uncertainty</span>: Float.
The standard uncertainty of the value used in the defining relation.
Some definitions define an entity (e.g. a constant) to a specific value along with an uncertainty of that value.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal">offset</span>: Dictionary.
A dictionary specifying the offset value, adhering to the same format as <span class="field docutils literal">scale</span>.
If omitted or <span class="val docutils literal">null</span>, the defaults for the <span class="field docutils literal">numerator</span>, <span class="field docutils literal">denominator</span>, and <span class="field docutils literal">exponent</span> are respectively 0, 1, and 0.</p></li>
</ul>
<p>If the fields in <span class="field docutils literal">scale</span> are designated as <span class="docutils literal">sn</span>, <span class="docutils literal">sd</span>, and <span class="docutils literal">se</span>; and the fields in <span class="field docutils literal">offset</span> are designated as <span class="docutils literal">on</span>, <span class="docutils literal">od</span>, and <span class="docutils literal">oe</span>; and <span class="field docutils literal"><span class="pre">base-units-expression</span></span> is designated as <span class="docutils literal">b</span>, these fields state the following defining relation: a value <span class="docutils literal">v</span> multiplied by the unit being defined is equal to the following expression <span class="docutils literal">(v * (sn/sd) * <span class="pre">10**se</span> + (on/od) * <span class="pre">10**oe)*b</span></span>, where <span class="docutils literal">*</span> designates multiplication and <span class="docutils literal">**</span> designates exponentiation.
For example, the defining relation of the temperature unit Fahrenheit <span class="docutils literal">F</span> in Celsius <span class="docutils literal">C</span>, that says that <span class="docutils literal">x F = (x - 32) * (5/9) C = 5/9 x + <span class="pre">(-160/9)</span> C</span> could be expressed as follows:</p>
<pre class="code jsonc literal-block"><code>&quot;defining-relation&quot;: {
  &quot;base-units&quot;: [
    {
      &quot;symbol&quot;: &quot;C&quot;,
      &quot;id&quot;: &quot;https://units.example.com/celsius&quot;
    }
  ],
  &quot;base-units-expression&quot;: &quot;C&quot;,
  &quot;scale&quot;: {
    &quot;numerator&quot;: 5,
    &quot;denominator&quot;: 9
  },
  &quot;offset&quot;: {
    &quot;numerator&quot;: -160,
    &quot;denominator&quot;: 9
  }
}</code></pre>
</li>
<li><p><span class="field docutils literal"><span class="pre">approximate-relations</span></span>: List of Dictionary.
A list of dictionaries that encode approximate relations to another unit or set of units.
The intended use is to express one or a few approximate relationships from the unit being defined to other unit systems (primarily intended to be SI).
This field is useful for units not defined by such a relationship, in which case the <span class="field docutils literal"><span class="pre">defining-relation</span></span> field would be used.
For example, the atomic mass unit (also known as dalton, commonly denoted <span class="docutils literal">u</span>) is defined as one twelfth of the mass of a free carbon-12 atom at rest and only has an approximate relationship to the SI kilogram.
While this field allows expressing multiple relationships, the intent is only to provide the most relevant relationships (e.g., to an SI base unit) from which other relationships can be derived.</p>
<p>Each element in the list MUST be a dictionary adhering to the following format:</p>
<p><strong>OPTIONAL keys:</strong></p>
<ul>
<li><p><span class="field docutils literal"><span class="pre">base-units</span></span>: List of Dictionaries, and <span class="field docutils literal"><span class="pre">base-units-expression</span></span>: String.
These fields take the same format and roles as in the <a class="reference internal" href="#definition-of-defining-relation">definition of defining-relation</a></p></li>
<li><p><span class="field docutils literal">scale</span>: Dictionary.
A dictionary specifying the scale in the approximate relation.
It MUST adhere to the following format:</p>
<p><strong>REQUIRED keys:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">value</span>: Float.
The value of the scale in the approximate relation.</p></li>
</ul>
<p><strong>OPTIONAL keys:</strong></p>
<ul class="simple">
<li><p><span class="field docutils literal">standard_uncertainty</span>: Float.
The standard uncertainty of the value in the approximate relation.</p></li>
<li><p><span class="field docutils literal">relative_standard_uncertainty</span>: Float.
The relative standard uncertainty of the value in the approximate relation.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal">offset</span>: Dictionary.
A dictionary specifying the offset in the approximate relation.
It MUST adhere to the same format as the <span class="field docutils literal">scale</span> field above.</p></li>
</ul>
<p>The values for <span class="field docutils literal">scale</span> and <span class="field docutils literal">offset</span> take the same meaning as in the <a class="reference internal" href="#definition-of-defining-relation">definition of defining-relation</a> to express a relationship between the unit being defined and the compound unit expression in <span class="field docutils literal"><span class="pre">base-units-expression</span></span>.</p>
</li>
<li><p><span class="field docutils literal">deprecated</span>: Boolean.
If <span class="val docutils literal">TRUE</span>, implementations SHOULD not use the unit defined in this Physical Unit Definition.
If <span class="val docutils literal">FALSE</span>, the unit defined in this Physical Unit Definition is not deprecated.
The field not being present means <span class="val docutils literal">FALSE</span>.</p></li>
<li><p><span class="field docutils literal">$comment</span>: String.
A human-readable comment relevant in the context of the raw definition data.
These comments should normally not be shown to the end users.
Comments pertaining to the Property Definition that are relevant to end users should go into the field <span class="field docutils literal">description</span>.
Formatting in the text SHOULD use Markdown using the format described in the <a class="reference internal" href="#definition-of-the-description-field">definition of the description field</a> of Property Definitions.</p></li>
</ul>
<p>An example of a Physical Unit Definition, including a defining relation that involves more than one other unit, is embedded in the example of a Property Definition in the appendix <a class="reference internal" href="#property-definition-example">Property Definition Example</a>.</p>
</section>
<section id="prefixes-and-constants">
<h3><a class="toc-backref" href="#toc-entry-65" role="doc-backlink"><span class="sectnum">7.5 </span>Prefixes and constants</a></h3>
<p>Prefixes and constants are defined in OPTIMADE using nearly identical schemas as the one for units in <a class="reference internal" href="#physical-unit-definitions">Physical Unit Definitions</a>.
The only difference is that for prefixes:</p>
<ul class="simple">
<li><p>The <span class="field docutils literal">$schema</span> SHOULD be set to: &quot;<a class="reference external" href="https://schemas.optimade.org/meta/v1.2/optimade/prefix_definition.json">https://schemas.optimade.org/meta/v1.2/optimade/prefix_definition.json</a>&quot;.</p></li>
<li><p>The subfield <span class="field docutils literal">kind</span> of the field <span class="field docutils literal"><span class="pre">x-optimade-definition</span></span> MUST be <span class="val docutils literal">prefix</span>.</p></li>
</ul>
<p>And for Constants:</p>
<ul class="simple">
<li><p>The <span class="field docutils literal">$schema</span> SHOULD be set to: &quot;<a class="reference external" href="https://schemas.optimade.org/meta/v1.2/optimade/constant_definition.json">https://schemas.optimade.org/meta/v1.2/optimade/constant_definition.json</a>&quot;.</p></li>
<li><p>The subfield <span class="field docutils literal">kind</span> of the field <span class="field docutils literal"><span class="pre">x-optimade-definition</span></span> MUST be <span class="val docutils literal">constant</span>.</p></li>
</ul>
</section>
<section id="unrecognized-keys-in-property-definitions">
<h3><a class="toc-backref" href="#toc-entry-66" role="doc-backlink"><span class="sectnum">7.6 </span>Unrecognized keys in property definitions</a></h3>
<p>Implementations MAY add their own keys in Property Definitions, both inside and outside of the fields <span class="field docutils literal"><span class="pre">x-optimade-property</span></span>, <span class="field docutils literal"><span class="pre">x-optimade-implementation</span></span>, and <span class="field docutils literal"><span class="pre">x-optimade-requirements</span></span> in the form of <span class="field docutils literal"><span class="pre">x-exmpl-name</span></span> where <span class="field docutils literal">exmpl</span> is the database-specific prefix (without underscore characters) and <span class="field docutils literal">name</span> is the part of the key chosen by the implementation.
Implementations MUST NOT add keys to property definitions on other formats.</p>
<p>Client and server implementations that interpret an OPTIMADE Property Definition and encounter unrecognized keys starting with <span class="field docutils literal"><span class="pre">x-exmpl-</span></span> where <span class="field docutils literal">exmpl</span> is a recognized database prefix MAY issue errors or warnings.
Other unrecognized keys starting with <span class="field docutils literal">x-</span> MUST NOT issue errors, SHOULD NOT issue warnings, and MUST otherwise be ignored.</p>
<p>To allow forward compatibility with future versions of both OPTIMADE and the JSON Schema standards, unrecognized keys that do not start with <span class="field docutils literal">x-</span> SHOULD issue a warning but MUST otherwise be ignored.</p>
</section>
</section>
<section id="entry-list">
<h2><a class="toc-backref" href="#toc-entry-67" role="doc-backlink"><span class="sectnum">8 </span>Entry List</a></h2>
<p>This section defines standard entry types and their properties.</p>
<section id="properties-used-by-multiple-entry-types">
<h3><a class="toc-backref" href="#toc-entry-68" role="doc-backlink"><span class="sectnum">8.1 </span>Properties Used by Multiple Entry Types</a></h3>
<section id="id">
<h4><a class="toc-backref" href="#toc-entry-69" role="doc-backlink"><span class="sectnum">8.1.1 </span>id</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: An entry's ID as defined in section <a class="reference internal" href="#definition-of-terms">Definition of Terms</a>.</p></li>
<li><p><strong>Type</strong>: string.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: MUST be supported by all implementations, MUST NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
<li><p><strong>Response</strong>: REQUIRED in the response.</p></li>
<li><p>See section <a class="reference internal" href="#definition-of-terms">Definition of Terms</a>.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">&quot;db/1234567&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;cod/2000000&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;cod/2000000&#64;1234567&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;nomad/L1234567890&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;42&quot;</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="type">
<h4><a class="toc-backref" href="#toc-entry-70" role="doc-backlink"><span class="sectnum">8.1.2 </span>type</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: The name of the type of an entry.</p></li>
<li><p><strong>Type</strong>: string.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: MUST be supported by all implementations, MUST NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
<li><p><strong>Response</strong>: REQUIRED in the response.</p></li>
<li><p>MUST be an existing entry type.</p></li>
<li><p>The entry of type <span class="docutils literal">&lt;type&gt;</span> and ID <span class="docutils literal">&lt;id&gt;</span> MUST be returned in response to a request for <span class="endpoint docutils literal"><span class="pre">/&lt;type&gt;/&lt;id&gt;</span></span> under the versioned or unversioned base URL serving the API.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">&quot;structures&quot;</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="immutable-id">
<h4><a class="toc-backref" href="#toc-entry-71" role="doc-backlink"><span class="sectnum">8.1.3 </span>immutable_id</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: The entry's immutable ID (e.g., a UUID). This is important for databases having preferred IDs that point to &quot;the latest version&quot; of a record, but still offer access to older variants. This ID maps to the version-specific record, in case it changes in the future.</p></li>
<li><p><strong>Type</strong>: string.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal"><span class="pre">&quot;8bd3e750-b477-41a0-9b11-3a799f21b44f&quot;</span></span></p></li>
<li><p><span class="val docutils literal"><span class="pre">&quot;fjeiwoj,54;&#64;=%&lt;&gt;#32&quot;</span></span> (Strings that are not URL-safe are allowed.)</p></li>
</ul>
</li>
</ul>
</section>
<section id="last-modified">
<h4><a class="toc-backref" href="#toc-entry-72" role="doc-backlink"><span class="sectnum">8.1.4 </span>last_modified</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Date and time representing when the entry was last modified.</p></li>
<li><p><strong>Type</strong>: timestamp.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
<li><p><strong>Response</strong>: REQUIRED in the response unless the query parameter <span class="query-param docutils literal">response_fields</span> is present and does not include this property.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p>As part of JSON response format: <span class="val docutils literal"><span class="pre">&quot;2007-04-05T14:30:20Z&quot;</span></span> (i.e., encoded as an <a class="reference external" href="https://tools.ietf.org/html/rfc3339#section-5.6">RFC 3339 Internet Date/Time Format</a> string.)</p></li>
</ul>
</li>
</ul>
</section>
<section id="custom-properties">
<h4><a class="toc-backref" href="#toc-entry-73" role="doc-backlink"><span class="sectnum">8.1.5 </span>Custom properties</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Providers are able to add database-provider-specific and definition-provider-specific properties in the output of both standard entry types and custom entry types.
Similarly, an implementation MAY add keys with a namespace prefix to dictionary properties and their sub-dictionaries.
For example, the database-provider-specific property <span class="property docutils literal">_exmpl_oxidation_state</span>, can be placed within the OPTIMADE property <span class="property docutils literal">species</span>.</p></li>
<li><p><strong>Type</strong>: Decided by the API implementation.
MUST be one of the OPTIMADE <a class="reference internal" href="#data-types">Data types</a>.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: Support for database-provider-specific properties is fully OPTIONAL.</p></li>
<li><p><strong>Query</strong>: Support for queries on these properties are OPTIONAL.
If supported, only a subset of the filter features MAY be supported.</p></li>
<li><p><strong>Response</strong>: API implementations are free to choose whether database-provider-specific properties are only included when requested using the query parameter <span class="query-param docutils literal">response_fields</span>, or if they are included also when <span class="query-param docutils literal">response_fields</span> is not present.
Implementations are thus allowed to decide that some of these properties are part of what can be seen as the default value of <span class="query-param docutils literal">response_fields</span> when that query parameter is omitted.
Implementations SHOULD NOT include database-provider-specific properties when the query parameter <span class="query-param docutils literal">response_fields</span> is present but does not list them.</p></li>
<li><p>These MUST be prefixed by a database-provider-specific prefix (see appendix <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>).</p></li>
<li><p>Implementations MUST add the properties to the list of <span class="property docutils literal">properties</span> under the respective entry listing <span class="endpoint docutils literal">info</span> endpoint (see <a class="reference internal" href="#entry-listing-info-endpoints">Entry Listing Info Endpoints</a>).</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>: A few examples of valid database-provided-specific property names, for a predefined prefix <span class="docutils literal">_exmpl</span>, are as follows:</p>
<ul>
<li><p><span class="property docutils literal">_exmpl_formula_sum</span></p></li>
<li><p><span class="property docutils literal">_exmpl_band_gap</span></p></li>
<li><p><span class="property docutils literal">_exmpl_supercell</span></p></li>
<li><p><span class="property docutils literal">_exmpl_trajectory</span></p></li>
<li><p><span class="property docutils literal">_exmpl_workflow_id</span></p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="structures-entries">
<h3><a class="toc-backref" href="#toc-entry-74" role="doc-backlink"><span class="sectnum">8.2 </span>Structures Entries</a></h3>
<p><span class="entry docutils literal">structures</span> entries (or objects) have the properties described above in section <a class="reference internal" href="#properties-used-by-multiple-entry-types">Properties Used by Multiple Entry Types</a>, as well as the following properties:</p>
<section id="elements">
<h4><a class="toc-backref" href="#toc-entry-75" role="doc-backlink"><span class="sectnum">8.2.1 </span>elements</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: The chemical symbols of the different elements present in the structure.</p></li>
<li><p><strong>Type</strong>: list of strings.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
<li><p>The strings are the chemical symbols, i.e., either a single uppercase letter or an uppercase letter followed by a number of lowercase letters.</p></li>
<li><p>The order MUST be alphabetical.</p></li>
<li><p>MUST refer to the same elements in the same order, and therefore be of the same length, as <a class="reference internal" href="#elements-ratios">elements_ratios</a>, if the latter is provided.</p></li>
<li><p>Note: This property SHOULD NOT contain the string &quot;X&quot; to indicate non-chemical elements or &quot;vacancy&quot; to indicate vacancies (in contrast to the field <span class="field docutils literal">chemical_symbols</span> for the <span class="property docutils literal">species</span> property).</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">[&quot;Si&quot;]</span></p></li>
<li><p><span class="val docutils literal"><span class="pre">[&quot;Al&quot;,&quot;O&quot;,&quot;Si&quot;]</span></span></p></li>
</ul>
</li>
<li><p><strong>Query examples</strong>:</p>
<ul>
<li><p>A filter that matches all records of structures that contain Si, Al <strong>and</strong> O, and possibly other elements: <code class="filter">elements HAS ALL &quot;Si&quot;, &quot;Al&quot;, &quot;O&quot;</code>.</p></li>
<li><p>To match structures with exactly these three elements, use <code class="filter">elements HAS ALL &quot;Si&quot;, &quot;Al&quot;, &quot;O&quot; AND elements LENGTH 3</code>.</p></li>
<li><p>Note: length queries on this property can be equivalently formulated by filtering on the <a class="reference internal" href="#nelements">nelements</a> property directly.</p></li>
</ul>
</li>
</ul>
</section>
<section id="nelements">
<h4><a class="toc-backref" href="#toc-entry-76" role="doc-backlink"><span class="sectnum">8.2.2 </span>nelements</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Number of different elements in the structure as an integer.</p></li>
<li><p><strong>Type</strong>: integer</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
<li><p>MUST be equal to the lengths of the list properties <a class="reference internal" href="#elements">elements</a> and <a class="reference internal" href="#elements-ratios">elements_ratios</a>, if they are provided.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">3</span></p></li>
</ul>
</li>
<li><p><strong>Querying</strong>:</p>
<ul>
<li><p>Note: queries on this property can equivalently be formulated using <span class="filter-fragment docutils literal">elements LENGTH</span>.</p></li>
<li><p>A filter that matches structures that have exactly 4 elements: <code class="filter">nelements=4</code>.</p></li>
<li><p>A filter that matches structures that have between 2 and 7 elements: <code class="filter">nelements&gt;=2 AND nelements&lt;=7</code>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="elements-ratios">
<h4><a class="toc-backref" href="#toc-entry-77" role="doc-backlink"><span class="sectnum">8.2.3 </span>elements_ratios</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Relative proportions of different elements in the structure.</p></li>
<li><p><strong>Type</strong>: list of floats</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
<li><p>Composed by the proportions of elements in the structure as a list of floating point numbers.</p></li>
<li><p>The sum of the numbers MUST be 1.0 (within floating point accuracy)</p></li>
<li><p>MUST refer to the same elements in the same order, and therefore be of the same length, as <a class="reference internal" href="#elements">elements</a>, if the latter is provided.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">[1.0]</span></p></li>
<li><p><span class="val docutils literal">[0.3333333333333333, 0.2222222222222222, 0.4444444444444444]</span></p></li>
</ul>
</li>
<li><p><strong>Query examples</strong>:</p>
<ul>
<li><p>Note: Useful filters can be formulated using the set operator syntax for correlated values.
However, since the values are floating point values, the use of equality comparisons is generally inadvisable.</p></li>
<li><p>OPTIONAL: a filter that matches structures where approximately 1/3 of the atoms in the structure are the element Al is: <code class="filter">elements:elements_ratios HAS ALL &quot;Al&quot;:&gt;0.3333, &quot;Al&quot;:&lt;0.3334</code>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="chemical-formula-descriptive">
<h4><a class="toc-backref" href="#toc-entry-78" role="doc-backlink"><span class="sectnum">8.2.4 </span>chemical_formula_descriptive</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: The chemical formula for a structure as a string in a form chosen by the API implementation.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
<li><p>The chemical formula is given as a string consisting of properly capitalized element symbols followed by integers or decimal numbers, balanced parentheses, square, and curly brackets <span class="docutils literal">(</span>,<span class="docutils literal">)</span>, <span class="docutils literal">[</span>,<span class="docutils literal">]</span>, <span class="docutils literal">{</span>, <span class="docutils literal">}</span>, commas, the <span class="docutils literal">+</span>, <span class="docutils literal">-</span>, <span class="docutils literal">:</span> and <span class="docutils literal">=</span> symbols.
The parentheses are allowed to be followed by a number.
Spaces are allowed anywhere except within chemical symbols.
The order of elements and any groupings indicated by parentheses or brackets are chosen freely by the API implementation.</p></li>
<li><p>The string SHOULD be arithmetically consistent with the element ratios in the <span class="property docutils literal">chemical_formula_reduced</span> property.</p></li>
<li><p>It is RECOMMENDED, but not mandatory, that symbols, parentheses and brackets, if used, are used with the meanings prescribed by <a class="reference external" href="https://www.qmul.ac.uk/sbcs/iupac/bibliog/blue.html">IUPAC's Nomenclature of Organic Chemistry</a>.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">&quot;(H2O)2 Na&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;NaCl&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;CaCO3&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;CCaO3&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;(CH3)3N+ - <span class="pre">[CH2]2-OH</span> = Me3N+ - CH2 - CH2OH&quot;</span></p></li>
</ul>
</li>
<li><p><strong>Query examples</strong>:</p>
<ul>
<li><p>Note: the free-form nature of this property is likely to make queries on it across different databases inconsistent.</p></li>
<li><p>A filter that matches an exactly given formula: <code class="filter">chemical_formula_descriptive=&quot;(H2O)2 Na&quot;</code>.</p></li>
<li><p>A filter that does a partial match: <code class="filter">chemical_formula_descriptive CONTAINS &quot;H2O&quot;</code>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="chemical-formula-reduced">
<h4><a class="toc-backref" href="#toc-entry-79" role="doc-backlink"><span class="sectnum">8.2.5 </span>chemical_formula_reduced</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: The reduced chemical formula for a structure as a string with element symbols and integer chemical proportion numbers.
The proportion number MUST be omitted if it is 1.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property.
However, support for filters using partial string matching with this property is OPTIONAL (i.e., BEGINS WITH, ENDS WITH, and CONTAINS).
Intricate queries on formula components are instead suggested to be formulated using set-type filter operators on the multi valued <span class="property docutils literal">elements</span> and <span class="property docutils literal">elements_ratios</span> properties.</p></li>
<li><p>Element symbols MUST have proper capitalization (e.g., <span class="val docutils literal">&quot;Si&quot;</span>, not <span class="val docutils literal">&quot;SI&quot;</span> for &quot;silicon&quot;).</p></li>
<li><p>Elements MUST be placed in alphabetical order, followed by their integer chemical proportion number.</p></li>
<li><p>For structures with no partial occupation, the chemical proportion numbers are the smallest integers for which the chemical proportion is exactly correct.</p></li>
<li><p>For structures with partial occupation, the chemical proportion numbers are integers that within reasonable approximation indicate the correct chemical proportions. The precise details of how to perform the rounding is chosen by the API implementation.</p></li>
<li><p>No spaces or separators are allowed.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">&quot;H2NaO&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;ClNa&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;CCaO3&quot;</span></p></li>
</ul>
</li>
<li><p><strong>Query examples</strong>:</p>
<ul>
<li><p>A filter that matches an exactly given formula is <code class="filter">chemical_formula_reduced=&quot;H2NaO&quot;</code>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="chemical-formula-hill">
<h4><a class="toc-backref" href="#toc-entry-80" role="doc-backlink"><span class="sectnum">8.2.6 </span>chemical_formula_hill</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: The chemical formula for a structure in <a class="reference external" href="https://dx.doi.org/10.1021/ja02046a005">Hill form</a> with element symbols followed by integer chemical proportion numbers.
The proportion number MUST be omitted if it is 1.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.
If supported, only a subset of the filter features MAY be supported.</p></li>
<li><p>The overall scale factor of the chemical proportions is chosen such that the resulting values are integers that indicate the most chemically relevant unit of which the system is composed.
For example, if the structure is a repeating unit cell with four hydrogens and four oxygens that represents two hydroperoxide molecules, <span class="property docutils literal">chemical_formula_hill</span> is <span class="val docutils literal">&quot;H2O2&quot;</span> (i.e., not <span class="val docutils literal">&quot;HO&quot;</span>, nor <span class="val docutils literal">&quot;H4O4&quot;</span>).</p></li>
<li><p>If the chemical insight needed to ascribe a Hill formula to the system is not present, the property MUST be handled as unset.</p></li>
<li><p>Element symbols MUST have proper capitalization (e.g., <span class="val docutils literal">&quot;Si&quot;</span>, not <span class="val docutils literal">&quot;SI&quot;</span> for &quot;silicon&quot;).</p></li>
<li><p>Elements MUST be placed in <a class="reference external" href="https://dx.doi.org/10.1021/ja02046a005">Hill order</a>, followed by their integer chemical proportion number.
Hill order means: if carbon is present, it is placed first, and if also present, hydrogen is placed second.
After that, all other elements are ordered alphabetically.
If carbon is not present, all elements are ordered alphabetically.</p></li>
<li><p>If the system has sites with partial occupation and the total occupations of each element do not all sum up to integers, then the Hill formula SHOULD be handled as unset.</p></li>
<li><p>No spaces or separators are allowed.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">&quot;H2O2&quot;</span></p></li>
</ul>
</li>
<li><p><strong>Query examples</strong>:</p>
<ul>
<li><p>A filter that matches an exactly given formula is <code class="filter">chemical_formula_hill=&quot;H2O2&quot;</code>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="chemical-formula-anonymous">
<h4><a class="toc-backref" href="#toc-entry-81" role="doc-backlink"><span class="sectnum">8.2.7 </span>chemical_formula_anonymous</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: The anonymous formula is the <span class="property docutils literal">chemical_formula_reduced</span>, but where the elements are instead first ordered by their chemical proportion number, and then, in order left to right, replaced by anonymous symbols A, B, C, ..., Z, Aa, Ba, ..., Za, Ab, Bb, ... and so on.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property.
However, support for filters using partial string matching with this property is OPTIONAL (i.e., BEGINS WITH, ENDS WITH, and CONTAINS).</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">&quot;A2B&quot;</span></p></li>
<li><p><span class="val docutils literal">&quot;A42B42C16D12E10F9G5&quot;</span></p></li>
</ul>
</li>
<li><p><strong>Querying</strong>:</p>
<ul>
<li><p>A filter that matches an exactly given formula is <code class="filter">chemical_formula_anonymous=&quot;A2B&quot;</code>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="dimension-types">
<h4><a class="toc-backref" href="#toc-entry-82" role="doc-backlink"><span class="sectnum">8.2.8 </span>dimension_types</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: List of three integers describing the periodicity of the boundaries of the unit cell.
For each direction indicated by the three <a class="reference internal" href="#lattice-vectors">lattice_vectors</a>, this list indicates if the direction is periodic (value <span class="val docutils literal">1</span>) or non-periodic (value <span class="val docutils literal">0</span>).
Note: the elements in this list each refer to the direction of the corresponding entry in <a class="reference internal" href="#lattice-vectors">lattice_vectors</a> and <em>not</em> the Cartesian x, y, z directions.</p></li>
<li><p><strong>Type</strong>: list of integers.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>MUST be a list of length 3.</p></li>
<li><p>Each integer element MUST assume only the value 0 or 1.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p>A nonperiodic structure, for example, for a single molecule: <span class="val docutils literal">[0, 0, 0]</span></p></li>
<li><p>A unit cell that is periodic in the direction of the third lattice vector, for example for a carbon nanotube: <span class="val docutils literal">[0, 0, 1]</span></p></li>
<li><p>For a 2D surface/slab, with a unit cell that is periodic in the direction of the first and third lattice vectors: <span class="val docutils literal">[1, 0, 1]</span></p></li>
<li><p>For a bulk 3D system with a unit cell that is periodic in all directions: <span class="val docutils literal">[1, 1, 1]</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="nperiodic-dimensions">
<h4><a class="toc-backref" href="#toc-entry-83" role="doc-backlink"><span class="sectnum">8.2.9 </span>nperiodic_dimensions</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: An integer specifying the number of periodic dimensions in the structure, equivalent to the number of non-zero entries in <a class="reference internal" href="#dimension-types">dimension_types</a>.</p></li>
<li><p><strong>Type</strong>: integer</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
<li><p>The integer value MUST be between 0 and 3 inclusive and MUST be equal to the sum of the items in the <a class="reference internal" href="#dimension-types">dimension_types</a> property.</p></li>
<li><p>This property only reflects the treatment of the lattice vectors provided for the structure, and not any physical interpretation of the dimensionality of its contents.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">2</span> should be indicated in cases where <span class="property docutils literal">dimension_types</span> is any of <span class="val docutils literal">[1, 1, 0]</span>, <span class="val docutils literal">[1, 0, 1]</span>, <span class="val docutils literal">[0, 1, 1]</span>.</p></li>
</ul>
</li>
<li><p><strong>Query examples</strong>:</p>
<ul>
<li><p>Match only structures with exactly 3 periodic dimensions: <code class="filter">nperiodic_dimensions=3</code></p></li>
<li><p>Match all structures with 2 or fewer periodic dimensions: <code class="filter">nperiodic_dimensions&lt;=2</code></p></li>
</ul>
</li>
</ul>
</section>
<section id="lattice-vectors">
<h4><a class="toc-backref" href="#toc-entry-84" role="doc-backlink"><span class="sectnum">8.2.10 </span>lattice_vectors</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: The three lattice vectors in Cartesian coordinates, in ångström (Å).</p></li>
<li><p><strong>Type</strong>: list of list of floats or unknown values.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.
If supported, filters MAY support only a subset of comparison operators.</p></li>
<li><p>MUST be a list of three vectors <em>a</em>, <em>b</em>, and <em>c</em>, where each of the vectors MUST BE a list of the vector's coordinates along the x, y, and z Cartesian coordinates.
(Therefore, the first index runs over the three lattice vectors and the second index runs over the x, y, z Cartesian coordinates).</p></li>
<li><p>For databases that do not define an absolute Cartesian system (e.g., only defining the length and angles between vectors), the first lattice vector SHOULD be set along <em>x</em> and the second on the <em>xy</em>-plane.</p></li>
<li><p>MUST always contain three vectors of three coordinates each, independently of the elements of property <a class="reference internal" href="#dimension-types">dimension_types</a>.
The vectors SHOULD by convention be chosen so the determinant of the <span class="property docutils literal">lattice_vectors</span> matrix is different from zero.
The vectors in the non-periodic directions have no significance beyond fulfilling these requirements.</p></li>
<li><p>The coordinates of the lattice vectors of non-periodic dimensions (i.e., those dimensions for which <a class="reference internal" href="#dimension-types">dimension_types</a> is <span class="val docutils literal">0</span>) MAY be given as a list of all <span class="val docutils literal">null</span> values.
If a lattice vector contains the value <span class="val docutils literal">null</span>, all coordinates of that lattice vector MUST be <span class="val docutils literal">null</span>.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal"><span class="pre">[[4.0,0.0,0.0],[0.0,4.0,0.0],[0.0,1.0,4.0]]</span></span> represents a cell, where the first vector is <span class="val docutils literal">(4, 0, 0)</span>, i.e., a vector aligned along the <span class="val docutils literal">x</span> axis of length 4 Å; the second vector is <span class="val docutils literal">(0, 4, 0)</span>; and the third vector is <span class="val docutils literal">(0, 1, 4)</span>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="space-group-symmetry-operations-xyz">
<h4><a class="toc-backref" href="#toc-entry-85" role="doc-backlink"><span class="sectnum">8.2.11 </span>space_group_symmetry_operations_xyz</a></h4>
<ul>
<li><p><strong>Description</strong>: a list of symmetry operations given as general position x, y and z coordinates in algebraic form.</p></li>
<li><p><strong>Type</strong> list of strings</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul class="simple">
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p>
<ul>
<li><p>The property is RECOMMENDED if coordinates are returned in a form to which these operations can or must be applied (e.g. fractional atom coordinates of an asymmetric unit).</p></li>
<li><p>The property is REQUIRED if symmetry operations are necessary to reconstruct the full model of the material and no other symmetry information (e.g., the Hall symbol) is provided that would allow the user to derive symmetry operations unambiguously.</p></li>
</ul>
</li>
<li><p><strong>Query</strong>: Support for queries on this property is not required and in fact is NOT RECOMMENDED.</p></li>
<li><p>MUST be <span class="val docutils literal">null</span> if <span class="property docutils literal">nperiodic_dimensions</span> is equal to 0.</p></li>
<li><p>Each symmetry operation is described by a string that gives that symmetry operation in Jones' faithful representation (Bradley &amp; Cracknell, 1972: pp. 35-37), adapted for computer string notation.</p></li>
<li><p>The letters <span class="val docutils literal">x</span>, <span class="val docutils literal">y</span> and <span class="val docutils literal">z</span> that are typesetted with overbars in printed text represent coordinate values multiplied by -1 and are encoded as <span class="val docutils literal"><span class="pre">-x</span></span>, <span class="val docutils literal"><span class="pre">-y</span></span> and <span class="val docutils literal"><span class="pre">-z</span></span>, respectively.</p></li>
<li><p>The syntax of the strings representing symmetry operations MUST conform to regular expressions given in appendix <a class="reference internal" href="#the-symmetry-operation-string-regular-expressions">The Symmetry Operation String Regular Expressions</a>.</p></li>
<li><p>The interpretation of the strings MUST follow the conventions of the IUCr CIF core dictionary (IUCr, 2023).
In particular, this property MUST explicitly provide all symmetry operations needed to generate all the atoms in the unit cell from the atoms in the asymmetric unit, for the setting used.</p></li>
<li><p>This symmetry operation set MUST always include the <span class="val docutils literal">x,y,z</span> identity operation.</p></li>
<li><p>The symmetry operations are to be applied to fractional atom coordinates.
In case only Cartesian coordinates are available, these Cartesian coordinates must be converted to fractional coordinates before the application of the provided symmetry operations.</p></li>
<li><p>If the symmetry operation list is present, it MUST be compatible with other space group specifications (e.g. the ITC space group number, the Hall symbol, the Hermann-Mauguin symbol) if these are present.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul class="simple">
<li><p>Space group operations for the space group with ITC number 3 (H-M symbol <span class="val docutils literal">P 2</span>, extended H-M symbol <span class="val docutils literal">P 1 2 1</span>, Hall symbol <span class="val docutils literal">P 2y</span>): <span class="val docutils literal">[&quot;x,y,z&quot;, <span class="pre">&quot;-x,y,-z&quot;]</span></span></p></li>
<li><p>Space group operations for the space group with ITC number 5 (H-M symbol <span class="val docutils literal">C 2</span>, extended H-M symbol <span class="val docutils literal">C 1 2 1</span>, Hall symbol <span class="val docutils literal">C 2y</span>): <span class="val docutils literal">[&quot;x,y,z&quot;, <span class="pre">&quot;-x,y,-z&quot;,</span> &quot;x+1/2,y+1/2,z&quot;, <span class="pre">&quot;-x+1/2,y+1/2,-z&quot;]</span></span></p></li>
</ul>
</li>
<li><p><strong>Notes:</strong> The list of space group symmetry operations applies to the whole periodic array of atoms and together with the lattice translations given in the <span class="property docutils literal">lattice_vectors</span> property provides the necessary information to reconstruct all atom site positions of the periodic material.
Thus, the symmetry operations described in this property are only applicable to material models with at least one periodic dimension.
This property is not meant to represent arbitrary symmetries of molecules, non-periodic (finite) collections of atoms or non-crystallographic symmetry.</p></li>
<li><p><strong>Bibliographic References</strong>:</p>
<p>Bradley, C. J. and Cracknell, A. P. (1972) The Mathematical Theory of Symmetry in Solids. Oxford, Clarendon Press (paperback edition 2010) 745 p. ISBN <a class="reference external" href="https://isbnsearch.org/isbn/9780199582587">978-0-19-958258-7</a>.</p>
<p>IUCr (2023) Core dictionary (coreCIF) version 2.4.5; data name <cite>_space_group_symop_operation_xyz</cite>. Available from: <a class="reference external" href="https://www.iucr.org/__data/iucr/cifdic_html/1/cif_core.dic/Ispace_group_symop_operation_xyz.html">https://www.iucr.org/__data/iucr/cifdic_html/1/cif_core.dic/Ispace_group_symop_operation_xyz.html</a> [Accessed 2023-06-18T16:46+03:00].</p>
</li>
</ul>
</section>
<section id="space-group-symbol-hall">
<h4><a class="toc-backref" href="#toc-entry-86" role="doc-backlink"><span class="sectnum">8.2.12 </span>space_group_symbol_hall</a></h4>
<ul>
<li><p><strong>Description</strong>: A Hall space group symbol representing the symmetry of the structure as defined in (Hall, 1981, 1981a).</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul class="simple">
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>The change-of-basis operations are used as defined in the International Tables of Crystallography (ITC) Vol. B, Sect. 1.4, Appendix A1.4.2 (IUCr, 2001).</p></li>
<li><p>Each component of the Hall symbol MUST be separated by a single space symbol.</p></li>
<li><p>If there exists a standard Hall symbol which represents the symmetry it SHOULD be used.</p></li>
<li><p>MUST be <span class="val docutils literal">null</span> if <span class="property docutils literal">nperiodic_dimensions</span> is not equal to 3.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul class="simple">
<li><p>Space group symbols with explicit origin (the Hall symbols):</p>
<ul>
<li><p><span class="val docutils literal">P 2c <span class="pre">-2ac</span></span></p></li>
<li><p><span class="val docutils literal"><span class="pre">-I</span> 4bd 2ab 3</span></p></li>
</ul>
</li>
<li><p>Space group symbols with change-of-basis operations:</p>
<ul>
<li><p><span class="val docutils literal">P 2yb <span class="pre">(-1/2*x+z,1/2*x,y)</span></span></p></li>
<li><p><span class="val docutils literal"><span class="pre">-I</span> 4 2 <span class="pre">(1/2*x+1/2*y,-1/2*x+1/2*y,z)</span></span></p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Bibliographic References</strong>:</p>
<p>Hall, S. R. (1981) Space-group notation with an explicit origin. Acta Crystallographica Section A, 37, 517-525, International Union of Crystallography (IUCr), DOI: <a class="reference external" href="https://doi.org/10.1107/s0567739481001228">https://doi.org/10.1107/s0567739481001228</a></p>
<p>Hall, S. R. (1981a) Space-group notation with an explicit origin; erratum.  Acta Crystallographica Section A, 37, 921-921, International Union of Crystallography (IUCr), DOI: <a class="reference external" href="https://doi.org/10.1107/s0567739481001976">https://doi.org/10.1107/s0567739481001976</a></p>
<p>IUCr (2001). International Tables for Crystallography vol. B. Reciprocal Space. Ed. U. Shmueli. 2-nd edition. Dordrecht/Boston/London, Kluwer Academic Publishers.</p>
</li>
</ul>
</section>
<section id="space-group-symbol-hermann-mauguin">
<h4><a class="toc-backref" href="#toc-entry-87" role="doc-backlink"><span class="sectnum">8.2.13 </span>space_group_symbol_hermann_mauguin</a></h4>
<ul>
<li><p><strong>Description</strong> A human- and machine-readable string containing the short Hermann-Mauguin (H-M) symbol which specifies the space group of the structure in the response.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul class="simple">
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>The H-M symbol SHOULD aim to convey the closest representation of the symmetry information that can be specified using the short format used in the International Tables for Crystallography vol. A (IUCr, 2005), Table 4.3.2.1 as described in the accompanying text.</p></li>
<li><p>The symbol MAY be a non-standard short H-M symbol.</p></li>
<li><p>The H-M symbol does not unambiguously communicate the axis, cell, and origin choice, and the given symbol SHOULD NOT be amended to convey this information.</p></li>
<li><p>To encode as character strings, the following adaptations MUST be made when representing H-M symbols given in their typesetted form:</p>
<ul>
<li><p>the overbar above the numbers MUST be changed to the minus sign in front of the digit (e.g. '-2');</p></li>
<li><p>subscripts that denote screw axes are written as digits immediately after the axis designator without a space (e.g. 'P 32')</p></li>
<li><p>the space group generators MUST be separated by a single space (e.g. 'P 21 21 2');</p></li>
<li><p>there MUST be no spaces in the space group generator designation (i.e. use 'P 21/m', not the 'P 21 / m');</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul class="simple">
<li><p><span class="val docutils literal">C 2</span></p></li>
<li><p><span class="val docutils literal">P 21 21 21</span></p></li>
</ul>
</li>
<li><p><strong>Bibliographic References</strong>:</p>
<p>IUCr (2005). International Tables for Crystallography vol. A. Space-Group Symmetry. Ed. Theo Hahn. 5-th edition. Dordrecht, Springer.</p>
</li>
</ul>
</section>
<section id="space-group-symbol-hermann-mauguin-extended">
<h4><a class="toc-backref" href="#toc-entry-88" role="doc-backlink"><span class="sectnum">8.2.14 </span>space_group_symbol_hermann_mauguin_extended</a></h4>
<ul>
<li><p><strong>Description</strong> A human- and machine-readable string containing the extended Hermann-Mauguin (H-M) symbol which specifies the space group of the structure in the response.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul class="simple">
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>The H-M symbols SHOULD be given as specified in the International Tables for Crystallography vol. A (IUCr, 2005), Table 4.3.2.1.</p></li>
<li><p>The change-of-basis operation SHOULD be provided for the non-standard axis and cell choices.</p></li>
<li><p>The extended H-M symbol does not unambiguously communicate the origin choice, and the given symbol SHOULD NOT be amended to convey this information.</p></li>
<li><p>The description of the change-of-basis SHOULD follow conventions of the ITC Vol. B, Sect. 1.4, Appendix A1.4.2 (IUCr, 2001).</p></li>
<li><p>The same character string encoding conventions MUST be used as for the specification of the <span class="property docutils literal">space_group_symbol_hermann_mauguin</span> property.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul class="simple">
<li><p><span class="val docutils literal">C 1 2 1</span></p></li>
</ul>
</li>
<li><p><strong>Bibliographic References</strong>:</p>
<p>IUCr (2001). International Tables for Crystallography vol. B. Reciprocal Space. Ed. U. Shmueli. 2-nd edition. Dordrecht/Boston/London, Kluwer Academic Publishers.</p>
<p>IUCr (2005). International Tables for Crystallography vol. A. Space-Group Symmetry. Ed. Theo Hahn. 5-th edition. Dordrecht, Springer.</p>
</li>
</ul>
</section>
<section id="space-group-it-number">
<h4><a class="toc-backref" href="#toc-entry-89" role="doc-backlink"><span class="sectnum">8.2.15 </span>space_group_it_number</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Space group number which specifies the space group of the structure as defined in the International Tables for Crystallography Vol. A. (IUCr, 2005).</p></li>
<li><p><strong>Type</strong>: integer</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>The integer value MUST be between 1 and 230.</p></li>
<li><p>MUST be <span class="val docutils literal">null</span> if <span class="property docutils literal">nperiodic_dimensions</span> is not equal to 3.</p></li>
</ul>
</li>
</ul>
</section>
<section id="cartesian-site-positions">
<h4><a class="toc-backref" href="#toc-entry-90" role="doc-backlink"><span class="sectnum">8.2.16 </span>cartesian_site_positions</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Cartesian positions of each site in the structure.
A site is usually used to describe positions of atoms; what atoms can be encountered at a given site is conveyed by the <span class="property docutils literal">species_at_sites</span> property, and the species themselves are described in the <span class="property docutils literal">species</span> property.</p></li>
<li><p><strong>Type</strong>: list of list of floats</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.
If supported, filters MAY support only a subset of comparison operators.</p></li>
<li><p>It MUST be a list of length equal to the number of sites in the structure, where every element is a list of the three Cartesian coordinates of a site expressed as float values in the unit angstrom (Å).</p></li>
<li><p>An entry MAY have multiple sites at the same Cartesian position (for a relevant use of this, see e.g., the property <a class="reference internal" href="#assemblies">assemblies</a>).</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal"><span class="pre">[[0,0,0],[0,0,2]]</span></span> indicates a structure with two sites, one sitting at the origin and one along the (positive) <em>z</em>-axis, 2 Å away from the origin.</p></li>
</ul>
</li>
</ul>
</section>
<section id="nsites">
<h4><a class="toc-backref" href="#toc-entry-91" role="doc-backlink"><span class="sectnum">8.2.17 </span>nsites</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: An integer specifying the length of the <span class="property docutils literal">cartesian_site_positions</span> property.</p></li>
<li><p><strong>Type</strong>: integer</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property with support for all mandatory filter features.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">42</span></p></li>
</ul>
</li>
<li><p><strong>Query examples</strong>:</p>
<ul>
<li><p>Match only structures with exactly 4 sites: <code class="filter">nsites=4</code></p></li>
<li><p>Match structures that have between 2 and 7 sites: <code class="filter">nsites&gt;=2 AND nsites&lt;=7</code></p></li>
</ul>
</li>
</ul>
</section>
<section id="species-at-sites">
<h4><a class="toc-backref" href="#toc-entry-92" role="doc-backlink"><span class="sectnum">8.2.18 </span>species_at_sites</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Name of the species at each site (where values for sites are specified with the same order of the property <a class="reference internal" href="#cartesian-site-positions">cartesian_site_positions</a>).
The properties of the species are found in the property <a class="reference internal" href="#species">species</a>.</p></li>
<li><p><strong>Type</strong>: list of strings.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.
If supported, filters MAY support only a subset of comparison operators.</p></li>
<li><p>MUST have length equal to the number of sites in the structure (first dimension of the list property <a class="reference internal" href="#cartesian-site-positions">cartesian_site_positions</a>).</p></li>
<li><p>Each species name mentioned in the <span class="property docutils literal">species_at_sites</span> list MUST be described in the list property <a class="reference internal" href="#species">species</a> (i.e. for each value in the <span class="property docutils literal">species_at_sites</span> list there MUST exist exactly one dictionary in the <span class="property docutils literal">species</span> list with the <span class="property docutils literal">name</span> attribute equal to the corresponding <span class="property docutils literal">species_at_sites</span> value).</p></li>
<li><p>Each site MUST be associated only to a single species.
<strong>Note</strong>: However, species can represent mixtures of atoms, and multiple species MAY be defined for the same chemical element.
This latter case is useful when different atoms of the same type need to be grouped or distinguished, for instance in simulation codes to assign different initial spin states.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal"><span class="pre">[&quot;Ti&quot;,&quot;O2&quot;]</span></span> indicates that the first site is hosting a species labeled <span class="val docutils literal">&quot;Ti&quot;</span> and the second a species labeled <span class="val docutils literal">&quot;O2&quot;</span>.</p></li>
<li><p><span class="val docutils literal">[&quot;Ac&quot;, &quot;Ac&quot;, &quot;Ag&quot;, &quot;Ir&quot;]</span> indicates that the first two sites contain the <span class="val docutils literal">&quot;Ac&quot;</span> species, while the third and fourth sites contain the <span class="val docutils literal">&quot;Ag&quot;</span> and <span class="val docutils literal">&quot;Ir&quot;</span> species, respectively.</p></li>
</ul>
</li>
</ul>
</section>
<section id="species">
<h4><a class="toc-backref" href="#toc-entry-93" role="doc-backlink"><span class="sectnum">8.2.19 </span>species</a></h4>
<ul>
<li><p><strong>Description</strong>: A list describing the species of the sites of this structure.
Species can represent pure chemical elements, virtual-crystal atoms representing a statistical occupation of a given site by multiple chemical elements, and/or a location to which there are attached atoms, i.e., atoms whose precise location are unknown beyond that they are attached to that position (frequently used to indicate hydrogen atoms attached to another element, e.g., a carbon with three attached hydrogens might represent a methyl group, -CH3).</p></li>
<li><p><strong>Type</strong>: list of dictionary with keys:</p>
<ul class="simple">
<li><p><span class="property docutils literal">name</span>: string (REQUIRED)</p></li>
<li><p><span class="property docutils literal">chemical_symbols</span>: list of strings (REQUIRED)</p></li>
<li><p><span class="property docutils literal">concentration</span>: list of float (REQUIRED)</p></li>
<li><p><span class="property docutils literal">attached</span>: list of strings (OPTIONAL)</p></li>
<li><p><span class="property docutils literal">nattached</span>: list of integers (OPTIONAL)</p></li>
<li><p><span class="property docutils literal">mass</span>: list of floats (OPTIONAL)</p></li>
<li><p><span class="property docutils literal">original_name</span>: string (OPTIONAL).</p></li>
</ul>
</li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: SHOULD be supported by all implementations, i.e., SHOULD NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.
If supported, filters MAY support only a subset of comparison operators.</p></li>
<li><p>Each list member MUST be a dictionary with the following keys:</p>
<ul>
<li><p><strong>name</strong>: REQUIRED; gives the name of the species; the <strong>name</strong> value MUST be unique in the <span class="property docutils literal">species</span> list;</p></li>
<li><p><strong>chemical_symbols</strong>: REQUIRED; MUST be a list of strings of all chemical elements composing this species. Each item of the list MUST be one of the following:</p>
<ul class="simple">
<li><p>a valid chemical-element symbol, or</p></li>
<li><p>the special value <span class="val docutils literal">&quot;X&quot;</span> to represent a non-chemical element, or</p></li>
<li><p>the special value <span class="val docutils literal">&quot;vacancy&quot;</span> to represent that this site has a non-zero probability of having a vacancy (the respective probability is indicated in the <span class="property docutils literal">concentration</span> list, see below).</p></li>
</ul>
<p>If any one entry in the <span class="property docutils literal">species</span> list has a <span class="property docutils literal">chemical_symbols</span> list that is longer than 1 element, the correct flag MUST be set in the list <span class="property docutils literal">structure_features</span> (see property <a class="reference internal" href="#structure-features">structure_features</a>).</p>
</li>
<li><p><strong>concentration</strong>: REQUIRED; MUST be a list of floats, with same length as <span class="property docutils literal">chemical_symbols</span>. The numbers represent the relative concentration of the corresponding chemical symbol in this species.
The numbers SHOULD sum to one. Cases in which the numbers do not sum to one typically fall only in the following two categories:</p>
<ul class="simple">
<li><p>Numerical errors when representing float numbers in fixed precision, e.g. for two chemical symbols with concentrations <span class="val docutils literal">1/3</span> and <span class="val docutils literal">2/3</span>, the concentration might look something like <span class="val docutils literal">[0.33333333333, 0.66666666666]</span>. If the client is aware that the sum is not one because of numerical precision, it can renormalize the values so that the sum is exactly one.</p></li>
<li><p>Experimental errors in the data present in the database. In this case, it is the responsibility of the client to decide how to process the data.</p></li>
</ul>
<p>Note that concentrations are uncorrelated between different sites (even of the same species).</p>
</li>
<li><p><strong>attached</strong>: OPTIONAL; if provided MUST be a list of length 1 or more of strings of chemical symbols for the elements attached to this site, or &quot;X&quot; for a non-chemical element.</p></li>
<li><p><strong>nattached</strong>: OPTIONAL; if provided MUST be a list of length 1 or more of integers indicating the number of attached atoms of the kind specified in the value of the <span class="field docutils literal">attached</span> key.</p>
<p>The implementation MUST include either both or none of the <span class="field docutils literal">attached</span> and <span class="field docutils literal">nattached</span> keys, and if they are provided, they MUST be of the same length.
Furthermore, if they are provided, the <a class="reference internal" href="#structure-features">structure_features</a> property MUST include the string <span class="val docutils literal">site_attachments</span>.</p>
</li>
<li><p><strong>mass</strong>: OPTIONAL. If present MUST be a list of floats, with the same length as <span class="property docutils literal">chemical_symbols</span>, providing element masses expressed in a.m.u.
Elements denoting vacancies MUST have masses equal to 0.</p></li>
<li><p><strong>original_name</strong>: OPTIONAL. Can be any valid Unicode string, and SHOULD contain (if specified) the name of the species that is used internally in the source database.</p></li>
</ul>
<p><strong>Note</strong>: With regard to &quot;source database&quot;, we refer to the immediate source being queried via the OPTIMADE API implementation.
The main use of this field is for source databases that use species names, containing characters that are not allowed (see description of the list property <a class="reference internal" href="#species-at-sites">species_at_sites</a>).</p>
</li>
<li><p>For systems that have only species formed by a single chemical symbol, and that have at most one species per chemical symbol, SHOULD use the chemical symbol as species name (e.g., <span class="val docutils literal">&quot;Ti&quot;</span> for titanium, <span class="val docutils literal">&quot;O&quot;</span> for oxygen, etc.)
However, note that this is OPTIONAL, and client implementations MUST NOT assume that the key corresponds to a chemical symbol, nor assume that if the species name is a valid chemical symbol, that it represents a species with that chemical symbol.
This means that a species <span class="val docutils literal">{&quot;name&quot;: &quot;C&quot;, &quot;chemical_symbols&quot;: <span class="pre">[&quot;Ti&quot;],</span> &quot;concentration&quot;: [1.0]}</span> is valid and represents a titanium species (and <em>not</em> a carbon species).</p></li>
<li><p>It is NOT RECOMMENDED that a structure includes species that do not have at least one corresponding site.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul class="simple">
<li><p><span class="val docutils literal">[ {&quot;name&quot;: &quot;Ti&quot;, &quot;chemical_symbols&quot;: <span class="pre">[&quot;Ti&quot;],</span> &quot;concentration&quot;: [1.0]} ]</span>: any site with this species is occupied by a Ti atom.</p></li>
<li><p><span class="val docutils literal">[ {&quot;name&quot;: &quot;Ti&quot;, &quot;chemical_symbols&quot;: [&quot;Ti&quot;, <span class="pre">&quot;vacancy&quot;],</span> &quot;concentration&quot;: [0.9, 0.1]} ]</span>: any site with this species is occupied by a Ti atom with 90 % probability, and has a vacancy with 10 % probability.</p></li>
<li><p><span class="val docutils literal">[ {&quot;name&quot;: &quot;BaCa&quot;, &quot;chemical_symbols&quot;: [&quot;vacancy&quot;, &quot;Ba&quot;, <span class="pre">&quot;Ca&quot;],</span> &quot;concentration&quot;: [0.05, 0.45, 0.5], &quot;mass&quot;: [0.0, 137.327, 40.078]} ]</span>: any site with this species is occupied by a Ba atom with 45 % probability, a Ca atom with 50 % probability, and by a vacancy with 5 % probability.</p></li>
<li><p><span class="val docutils literal">[ {&quot;name&quot;: &quot;C12&quot;, &quot;chemical_symbols&quot;: <span class="pre">[&quot;C&quot;],</span> &quot;concentration&quot;: [1.0], &quot;mass&quot;: [12.0]} ]</span>: any site with this species is occupied by a carbon isotope with mass 12.</p></li>
<li><p><span class="val docutils literal">[ {&quot;name&quot;: &quot;C13&quot;, &quot;chemical_symbols&quot;: <span class="pre">[&quot;C&quot;],</span> &quot;concentration&quot;: [1.0], &quot;mass&quot;: [13.0]} ]</span>: any site with this species is occupied by a carbon isotope with mass 13.</p></li>
<li><p><span class="val docutils literal">[ {&quot;name&quot;: &quot;CH3&quot;, &quot;chemical_symbols&quot;: <span class="pre">[&quot;C&quot;],</span> &quot;concentration&quot;: [1.0], &quot;attached&quot;: <span class="pre">[&quot;H&quot;],</span> &quot;nattached&quot;: [3]} ]</span>: any site with this species is occupied by a methyl group, -CH3, which is represented without specifying precise positions of the hydrogen atoms.</p></li>
</ul>
</li>
</ul>
</section>
<section id="assemblies">
<h4><a class="toc-backref" href="#toc-entry-94" role="doc-backlink"><span class="sectnum">8.2.20 </span>assemblies</a></h4>
<ul>
<li><p><strong>Description</strong>: A description of groups of sites that are statistically correlated.</p></li>
<li><p><strong>Type</strong>: list of dictionary with keys:</p>
<ul class="simple">
<li><p><span class="property docutils literal">sites_in_groups</span>: list of list of integers (REQUIRED)</p></li>
<li><p><span class="property docutils literal">group_probabilities</span>: list of floats (REQUIRED)</p></li>
</ul>
</li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.
If supported, filters MAY support only a subset of comparison operators.</p></li>
<li><p>The property SHOULD be <span class="val docutils literal">null</span> for entries that have no partial occupancies.</p></li>
<li><p>If present, the correct flag MUST be set in the list <span class="property docutils literal">structure_features</span> (see property <a class="reference internal" href="#structure-features">structure_features</a>).</p></li>
<li><p>Client implementations MUST check its presence (as its presence changes the interpretation of the structure).</p></li>
<li><p>If present, it MUST be a list of dictionaries, each of which represents an assembly and MUST have the following two keys:</p>
<ul>
<li><p><strong>sites_in_groups</strong>: Index of the sites (0-based) that belong to each group for each assembly.</p>
<p>Example: <span class="val docutils literal">[[1], [2]]</span>: two groups, one with the second site, one with the third.
Example: <span class="val docutils literal">[[1,2], [3]]</span>: one group with the second and third site, one with the fourth.</p>
</li>
<li><p><strong>group_probabilities</strong>: Statistical probability of each group. It MUST have the same length as <span class="property docutils literal">sites_in_groups</span>.
It SHOULD sum to one.
See below for examples of how to specify the probability of the occurrence of a vacancy.
The possible reasons for the values not to sum to one are the same as already specified above for the <span class="property docutils literal">concentration</span> of each <span class="property docutils literal">species</span>, see property <a class="reference internal" href="#species">species</a>.</p></li>
</ul>
</li>
<li><p>If a site is not present in any group, it means that it is present with 100 % probability (as if no assembly was specified).</p></li>
<li><p>A site MUST NOT appear in more than one group.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong> (for each entry of the assemblies list):</p>
<ul class="simple">
<li><p><span class="val docutils literal">{&quot;sites_in_groups&quot;: [[0], <span class="pre">[1]],</span> &quot;group_probabilities&quot;: [0.3, 0.7]}</span>: the first site and the second site never occur at the same time in the unit cell.
Statistically, 30 % of the times the first site is present, while 70 % of the times the second site is present.</p></li>
<li><p><span class="val docutils literal">{&quot;sites_in_groups&quot;: [[1,2], <span class="pre">[3]],</span> &quot;group_probabilities&quot;: [0.3, 0.7]}</span>: the second and third sites are either present together or not present; they form the first group of atoms for this assembly.
The second group is formed by the fourth site.
Sites of the first group (the second and the third) are never present at the same time as the fourth site.
30 % of times sites 1 and 2 are present (and site 3 is absent); 70 % of times site 3 is present (and sites 1 and 2 are absent).</p></li>
</ul>
</li>
<li><p><strong>Notes</strong>:</p>
<ul>
<li><p>Assemblies are essential to represent, for instance, the situation where an atom can statistically occupy two different positions (sites).</p></li>
<li><p>By defining groups, it is possible to represent, e.g., the case where a functional molecule (and not just one atom) is either present or absent (or the case where it is present in two conformations).</p></li>
<li><p>Considerations on virtual alloys and on vacancies: In the special case of a virtual alloy, these specifications allow two different, equivalent ways of specifying them.
For instance, for a site at the origin with 30 % probability of being occupied by Si, 50 % probability of being occupied by Ge, and 20 % of being a vacancy, the following two representations are possible:</p>
<ul>
<li><p>Using a single species:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;cartesian_site_positions&quot;: [[0,0,0]],
  &quot;species_at_sites&quot;: [&quot;SiGe-vac&quot;],
  &quot;species&quot;: [
    {
      &quot;name&quot;: &quot;SiGe-vac&quot;,
      &quot;chemical_symbols&quot;: [&quot;Si&quot;, &quot;Ge&quot;, &quot;vacancy&quot;],
      &quot;concentration&quot;: [0.3, 0.5, 0.2]
    }
  ]
  // ...
}</code></pre>
</li>
<li><p>Using multiple species and the assemblies:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;cartesian_site_positions&quot;: [ [0,0,0], [0,0,0], [0,0,0] ],
  &quot;species_at_sites&quot;: [&quot;Si&quot;, &quot;Ge&quot;, &quot;vac&quot;],
  &quot;species&quot;: [
    { &quot;name&quot;: &quot;Si&quot;, &quot;chemical_symbols&quot;: [&quot;Si&quot;], &quot;concentration&quot;: [1.0] },
    { &quot;name&quot;: &quot;Ge&quot;, &quot;chemical_symbols&quot;: [&quot;Ge&quot;], &quot;concentration&quot;: [1.0] },
    { &quot;name&quot;: &quot;vac&quot;, &quot;chemical_symbols&quot;: [&quot;vacancy&quot;], &quot;concentration&quot;: [1.0] }
  ],
  &quot;assemblies&quot;: [
    {
      &quot;sites_in_groups&quot;: [ [0], [1], [2] ],
      &quot;group_probabilities&quot;: [0.3, 0.5, 0.2]
    }
  ]
  // ...
}</code></pre>
</li>
</ul>
</li>
<li><p>It is up to the database provider to decide which representation to use, typically depending on the internal format in which the structure is stored.
However, given a structure identified by a unique ID, the API implementation MUST always provide the same representation for it.</p></li>
<li><p>The probabilities of occurrence of different assemblies are uncorrelated.
So, for instance in the following case with two assemblies:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;assemblies&quot;: [
    {
      &quot;sites_in_groups&quot;: [ [0], [1] ],
      &quot;group_probabilities&quot;: [0.2, 0.8]
    },
    {
      &quot;sites_in_groups&quot;: [ [2], [3] ],
      &quot;group_probabilities&quot;: [0.3, 0.7]
    }
  ]
}</code></pre>
<p>Site 0 is present with a probability of 20 % and site 1 with a probability of 80 %. These two sites are correlated (either site 0 or 1 is present). Similarly, site 2 is present with a probability of 30 % and site 3 with a probability of 70 %.
These two sites are correlated (either site 2 or 3 is present).
However, the presence or absence of sites 0 and 1 is not correlated with the presence or absence of sites 2 and 3 (in the specific example, the pair of sites (0, 2) can occur with 0.2*0.3 = 6 % probability; the pair (0, 3) with 0.2*0.7 = 14 % probability; the pair (1, 2) with 0.8*0.3 = 24 % probability; and the pair (1, 3) with 0.8*0.7 = 56 % probability).</p>
</li>
</ul>
</li>
</ul>
</section>
<section id="structure-features">
<h4><a class="toc-backref" href="#toc-entry-95" role="doc-backlink"><span class="sectnum">8.2.21 </span>structure_features</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: A list of strings that flag which special features are used by the structure.</p></li>
<li><p><strong>Type</strong>: list of strings</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: MUST be supported by all implementations, MUST NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: MUST be a queryable property.
Filters on the list MUST support all mandatory HAS-type queries.
Filter operators for comparisons on the string components MUST support equality, support for other comparison operators are OPTIONAL.</p></li>
<li><p>MUST be an empty list if no special features are used.</p></li>
<li><p>MUST be sorted alphabetically.</p></li>
<li><p>If a special feature listed below is used, the list MUST contain the corresponding string.</p></li>
<li><p>If a special feature listed below is not used, the list MUST NOT contain the corresponding string.</p></li>
<li><p><strong>List of strings used to indicate special structure features</strong>:</p>
<ul>
<li><p><span class="val docutils literal">disorder</span>: this flag MUST be present if any one entry in the <a class="reference internal" href="#species">species</a> list has a <span class="field docutils literal">chemical_symbols</span> list that is longer than 1 element.</p></li>
<li><p><span class="val docutils literal">implicit_atoms</span>: this flag MUST be present if the structure contains atoms that are not assigned to sites via the property <a class="reference internal" href="#species-at-sites">species_at_sites</a> (e.g., because their positions are unknown).
When this flag is present, the properties related to the chemical formula will likely not match the type and count of atoms represented by the <a class="reference internal" href="#species-at-sites">species_at_sites</a>, <a class="reference internal" href="#species">species</a>, and <a class="reference internal" href="#assemblies">assemblies</a> properties.</p></li>
<li><p><span class="val docutils literal">site_attachments</span>: this flag MUST be present if any one entry in the <a class="reference internal" href="#species">species</a> list includes <span class="field docutils literal">attached</span> and <span class="field docutils literal">nattached</span>.</p></li>
<li><p><span class="val docutils literal">assemblies</span>: this flag MUST be present if the property <a class="reference internal" href="#assemblies">assemblies</a> is present.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p>A structure having implicit atoms and using assemblies: <span class="val docutils literal">[&quot;assemblies&quot;, &quot;implicit_atoms&quot;]</span></p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="calculations-entries">
<h3><a class="toc-backref" href="#toc-entry-96" role="doc-backlink"><span class="sectnum">8.3 </span>Calculations Entries</a></h3>
<p>The <span class="entry docutils literal">calculations</span> entries have the properties described above in section <a class="reference internal" href="#properties-used-by-multiple-entry-types">Properties Used by Multiple Entry Types</a>.</p>
</section>
<section id="references-entries">
<h3><a class="toc-backref" href="#toc-entry-97" role="doc-backlink"><span class="sectnum">8.4 </span>References Entries</a></h3>
<p>The <span class="entry docutils literal">references</span> entries describe bibliographic references.
The following properties are used to provide the bibliographic details:</p>
<ul class="simple">
<li><p><strong>address</strong>, <strong>annote</strong>, <strong>booktitle</strong>, <strong>chapter</strong>, <strong>crossref</strong>, <strong>edition</strong>, <strong>howpublished</strong>, <strong>institution</strong>, <strong>journal</strong>, <strong>key</strong>, <strong>month</strong>, <strong>note</strong>, <strong>number</strong>, <strong>organization</strong>, <strong>pages</strong>, <strong>publisher</strong>, <strong>school</strong>, <strong>series</strong>, <strong>title</strong>, <strong>volume</strong>, <strong>year</strong>: meanings of these properties match the <a class="reference external" href="http://bibtexml.sourceforge.net/btxdoc.pdf">BibTeX specification</a>, values are strings;</p></li>
<li><p><strong>bib_type</strong>: type of the reference, corresponding to <strong>type</strong> property in the BibTeX specification, value is string;</p></li>
<li><p><strong>authors</strong> and <strong>editors</strong>: lists of <em>person objects</em> which are dictionaries with the following keys:</p>
<ul>
<li><p><strong>name</strong>: Full name of the person, REQUIRED.</p></li>
<li><p><strong>firstname</strong>, <strong>lastname</strong>: Parts of the person's name, OPTIONAL.</p></li>
</ul>
</li>
<li><p><strong>doi</strong> and <strong>url</strong>: values are strings.</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., any of the properties MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on any of these properties is OPTIONAL.
If supported, filters MAY support only a subset of comparison operators.</p></li>
<li><p>Every references entry MUST contain at least one of the properties.</p></li>
</ul>
</li>
</ul>
<p>Example:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;references&quot;,
    &quot;id&quot;: &quot;Dijkstra1968&quot;,
    &quot;attributes&quot;: {
      &quot;authors&quot;: [
        {
          &quot;name&quot;: &quot;Edsger Dijkstra&quot;,
          &quot;firstname&quot;: &quot;Edsger&quot;,
          &quot;lastname&quot;: &quot;Dijkstra&quot;
        }
      ],
      &quot;year&quot;: &quot;1968&quot;,
      &quot;title&quot;: &quot;Go To Statement Considered Harmful&quot;,
      &quot;journal&quot;: &quot;Communications of the ACM&quot;,
      &quot;doi&quot;: &quot;10.1145/362929.362947&quot;
    }
  }
}</code></pre>
</section>
<section id="files-entries">
<h3><a class="toc-backref" href="#toc-entry-98" role="doc-backlink"><span class="sectnum">8.5 </span>Files Entries</a></h3>
<p>The <span class="entry docutils literal">files</span> entries describe files.
The following properties are used to do so:</p>
<section id="url">
<h4><a class="toc-backref" href="#toc-entry-99" role="doc-backlink"><span class="sectnum">8.5.1 </span>url</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: The URL to get the contents of a file.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: MUST be supported by all implementations, MUST NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p><strong>Response</strong>: REQUIRED in the response.</p></li>
<li><p>The URL MUST point to the actual contents of a file (i.e. byte stream), not an intermediate (preview) representation.
For example, if referring to a file on GitHub, a link should point to raw contents.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal"><span class="pre">&quot;https://example.org/files/cifs/1000000.cif&quot;</span></span></p></li>
</ul>
</li>
</ul>
</section>
<section id="url-stable-until">
<h4><a class="toc-backref" href="#toc-entry-100" role="doc-backlink"><span class="sectnum">8.5.2 </span>url_stable_until</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Point in time until which the URL in <span class="property docutils literal">url</span> is guaranteed to stay stable.</p></li>
<li><p><strong>Type</strong>: timestamp</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p><span class="val docutils literal">null</span> means that there is no stability guarantee for the URL in <span class="property docutils literal">url</span>.
Indefinite support could be communicated by providing a date sufficiently far in the future, for example, <span class="val docutils literal"><span class="pre">9999-12-31</span></span>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="name">
<h4><a class="toc-backref" href="#toc-entry-101" role="doc-backlink"><span class="sectnum">8.5.3 </span>name</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Base name of a file.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: MUST be supported by all implementations, MUST NOT be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>File name extension is an integral part of a file name and, if available, MUST be included.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">&quot;1000000.cif&quot;</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="size">
<h4><a class="toc-backref" href="#toc-entry-102" role="doc-backlink"><span class="sectnum">8.5.4 </span>size</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Size of a file in bytes.</p></li>
<li><p><strong>Type</strong>: integer</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>If provided, it MUST be guaranteed that either exact size of a file is given or its upper bound.
This way if a client reserves a static buffer or truncates the download stream after this many bytes the whole file would be received.
Such provision is included to allow the providers to serve on-the-fly compressed files.</p></li>
</ul>
</li>
</ul>
</section>
<section id="media-type">
<h4><a class="toc-backref" href="#toc-entry-103" role="doc-backlink"><span class="sectnum">8.5.5 </span>media_type</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Media type identifier (also known as MIME type), for a file as per <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc6838">RFC 6838 Media Type Specifications and Registration Procedures</a>.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal"><span class="pre">&quot;chemical/x-cif&quot;</span></span></p></li>
</ul>
</li>
</ul>
</section>
<section id="version">
<h4><a class="toc-backref" href="#toc-entry-104" role="doc-backlink"><span class="sectnum">8.5.6 </span>version</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Version information of a file (e.g. commit, revision, timestamp).</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>If provided, it MUST be guaranteed that file contents pertaining to the same combination of <span class="field docutils literal">id</span> and <span class="field docutils literal">version</span> are the same.</p></li>
</ul>
</li>
</ul>
</section>
<section id="modification-timestamp">
<h4><a class="toc-backref" href="#toc-entry-105" role="doc-backlink"><span class="sectnum">8.5.7 </span>modification_timestamp</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Timestamp of the last modification of file contents.
A modification is understood as an addition, change or deletion of one or more bytes, resulting in file contents different from the previous.</p></li>
<li><p><strong>Type</strong>: timestamp</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>Timestamps of subsequent file modifications SHOULD be increasing (not earlier than previous timestamps).</p></li>
</ul>
</li>
</ul>
</section>
<section id="description">
<h4><a class="toc-backref" href="#toc-entry-106" role="doc-backlink"><span class="sectnum">8.5.8 </span>description</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Free-form description of a file.</p></li>
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
</ul>
</li>
<li><p><strong>Examples</strong>:</p>
<ul>
<li><p><span class="val docutils literal">&quot;POSCAR format file&quot;</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="checksums">
<h4><a class="toc-backref" href="#toc-entry-107" role="doc-backlink"><span class="sectnum">8.5.9 </span>checksums</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Dictionary providing checksums of file contents.</p></li>
<li><p><strong>Type</strong>: dictionary with keys identifying checksum functions and values (strings) giving the actual checksums</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>Supported dictionary keys: <span class="property docutils literal">md5</span>, <span class="property docutils literal">sha1</span>, <span class="property docutils literal">sha224</span>, <span class="property docutils literal">sha256</span>, <span class="property docutils literal">sha384</span>, <span class="property docutils literal">sha512</span>.
Checksums outside this list MAY be used, but their names MUST be prefixed by a database-provider-specific namespace prefix (see appendix <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>).</p></li>
</ul>
</li>
</ul>
</section>
<section id="atime">
<h4><a class="toc-backref" href="#toc-entry-108" role="doc-backlink"><span class="sectnum">8.5.10 </span>atime</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Time of last access of a file as per POSIX standard.</p></li>
<li><p><strong>Type</strong>: timestamp</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
</ul>
</li>
</ul>
</section>
<section id="ctime">
<h4><a class="toc-backref" href="#toc-entry-109" role="doc-backlink"><span class="sectnum">8.5.11 </span>ctime</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Time of last status change of a file as per POSIX standard.</p></li>
<li><p><strong>Type</strong>: timestamp</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
</ul>
</li>
</ul>
</section>
<section id="mtime">
<h4><a class="toc-backref" href="#toc-entry-110" role="doc-backlink"><span class="sectnum">8.5.12 </span>mtime</a></h4>
<ul class="simple">
<li><p><strong>Description</strong>: Time of last modification of a file as per POSIX standard.</p></li>
<li><p><strong>Type</strong>: timestamp</p></li>
<li><p><strong>Requirements/Conventions</strong>:</p>
<ul>
<li><p><strong>Support</strong>: OPTIONAL support in implementations, i.e., MAY be <span class="val docutils literal">null</span>.</p></li>
<li><p><strong>Query</strong>: Support for queries on this property is OPTIONAL.</p></li>
<li><p>It should be noted that the values of <span class="field docutils literal">last_modified</span>, <span class="field docutils literal">modification_timestamp</span> and <span class="field docutils literal">mtime</span> do not necessary match.
<span class="field docutils literal">last_modified</span> pertains to the modification of the OPTIMADE metadata, <span class="field docutils literal">modification_timestamp</span> pertains to file contents and <span class="field docutils literal">mtime</span> pertains to the modification of the file (not necessary changing its contents).
For example, appending an empty string to a file would result in the change of <span class="field docutils literal">mtime</span> in some operating systems, but this would not be deemed as a modification of its contents.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="custom-entry-types">
<h3><a class="toc-backref" href="#toc-entry-111" role="doc-backlink"><span class="sectnum">8.6 </span>Custom Entry Types</a></h3>
<p>Database and definition providers can define custom entry types.
The names of such entry types MUST start with corresponding namespace prefix (see appendix <a class="reference internal" href="#namespace-prefixes">Namespace Prefixes</a>).
Custom entry types MUST have all properties described above in section <a class="reference internal" href="#properties-used-by-multiple-entry-types">Properties Used by Multiple Entry Types</a>.</p>
<ul class="simple">
<li><p><strong>Requirements/Conventions for properties in custom entry types</strong>:</p>
<ul>
<li><p><strong>Support</strong>: Support for any properties in database-provider-specific or definition-provider-specific entry types is fully OPTIONAL.</p></li>
<li><p><strong>Query</strong>: Support for queries on these properties are OPTIONAL.
If supported, only a subset of the filter features MAY be supported.</p></li>
</ul>
</li>
</ul>
</section>
<section id="relationships-used-by-multiple-entry-types">
<h3><a class="toc-backref" href="#toc-entry-112" role="doc-backlink"><span class="sectnum">8.7 </span>Relationships Used by Multiple Entry Types</a></h3>
<p>In accordance with section <a class="reference internal" href="#relationships">Relationships</a>, all entry types MAY use relationships to describe relations to other entries.</p>
<section id="references">
<h4><a class="toc-backref" href="#toc-entry-113" role="doc-backlink"><span class="sectnum">8.7.1 </span>References</a></h4>
<p>The references relationship is used to provide bibliographic references for any of the entry types.
It relates an entry with any number of <span class="entry docutils literal">references</span> entries.</p>
<p>If the response format supports inclusion of entries of a different type in the response, then the response SHOULD include all references-type entries mentioned in the response.</p>
<p>For example, for the JSON response format, the top-level <span class="field docutils literal">included</span> field SHOULD be used as per the <a class="reference external" href="https://jsonapi.org/format/1.1/#fetching-includes">JSON:API 1.1 specification</a>:</p>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;structures&quot;,
    &quot;id&quot;: &quot;example.db:structs:1234&quot;,
    &quot;attributes&quot;: {
      &quot;formula&quot;: &quot;Es2&quot;,
      &quot;url&quot;: &quot;http://example.db/structs/1234&quot;,
      &quot;immutable_id&quot;: &quot;http://example.db/structs/1234&#64;123&quot;,
      &quot;last_modified&quot;: &quot;2007-04-07T12:02:20Z&quot;
    },
    &quot;relationships&quot;: {
      &quot;references&quot;: {
        &quot;data&quot;: [
          { &quot;type&quot;: &quot;references&quot;, &quot;id&quot;: &quot;Dijkstra1968&quot; },
          {
            &quot;type&quot;: &quot;references&quot;,
            &quot;id&quot;: &quot;1234&quot;,
            &quot;meta&quot;: {
              &quot;description&quot;: &quot;Reference for the general crystal prototype.&quot;
            }
          }
        ]
      }
    }
  },
  &quot;included&quot;: [
    {
      &quot;type&quot;: &quot;references&quot;,
      &quot;id&quot;: &quot;Dijkstra1968&quot;,
      &quot;attributes&quot;: {
        &quot;authors&quot;: [
          {
            &quot;name&quot;: &quot;Edsger Dijkstra&quot;,
            &quot;firstname&quot;: &quot;Edsger&quot;,
            &quot;lastname&quot;: &quot;Dijkstra&quot;
          }
        ],
        &quot;year&quot;: &quot;1968&quot;,
        &quot;title&quot;: &quot;Go To Statement Considered Harmful&quot;,
        &quot;journal&quot;: &quot;Communications of the ACM&quot;,
        &quot;doi&quot;: &quot;10.1145/362929.362947&quot;
      }
    },
    {
      &quot;type&quot;: &quot;references&quot;,
      &quot;id&quot;: &quot;1234&quot;,
      &quot;attributes&quot;: {
        &quot;doi&quot;: &quot;10.1234/1234&quot;
      }
    }
  ]
}</code></pre>
</section>
<section id="calculations">
<h4><a class="toc-backref" href="#toc-entry-114" role="doc-backlink"><span class="sectnum">8.7.2 </span>Calculations</a></h4>
<p>Relationships with calculations MAY be used to indicate provenance where a structure is either an input to or an output of calculations.</p>
<blockquote>
<p><strong>Note</strong>: We intend to implement in a future version of this API a standardized mechanism to differentiate these two cases, thus allowing databases a common way of exposing the full provenance tree with inputs and outputs between structures and calculations.</p>
<p>At the moment the database providers are suggested to extend their API the way they choose, always using their database-provider-specific prefix in non-standardized fields.</p>
</blockquote>
</section>
<section id="files">
<h4><a class="toc-backref" href="#toc-entry-115" role="doc-backlink"><span class="sectnum">8.7.3 </span>Files</a></h4>
<p>Relationships with files may be used to relate an entry with any number of <span class="entry docutils literal">files</span> entries.</p>
<pre class="code jsonc literal-block"><code>{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;structures&quot;,
    &quot;id&quot;: &quot;example.db:structs:1234&quot;,
    &quot;attributes&quot;: {
      &quot;chemical_formula_descriptive&quot;: &quot;H2O&quot;
    },
    &quot;relationships&quot;: {
      &quot;files&quot;: {
        &quot;data&quot;: [
          { &quot;type&quot;: &quot;files&quot;, &quot;id&quot;: &quot;example.db:files:1234&quot; }
        ]
      }
    }
  },
  &quot;included&quot;: [
    {
      &quot;type&quot;: &quot;files&quot;,
      &quot;id&quot;: &quot;example.db:files:1234&quot;,
      &quot;attributes&quot;: {
        &quot;media_type&quot;: &quot;chemical/x-cif&quot;,
        &quot;url&quot;: &quot;https://example.org/files/cifs/1234.cif&quot;
      }
    }
  ]
}</code></pre>
</section>
</section>
</section>
<section id="appendices">
<h2><a class="toc-backref" href="#toc-entry-116" role="doc-backlink"><span class="sectnum">9 </span>Appendices</a></h2>
<section id="the-filter-language-ebnf-grammar">
<h3><a class="toc-backref" href="#toc-entry-117" role="doc-backlink"><span class="sectnum">9.1 </span>The Filter Language EBNF Grammar</a></h3>
<pre class="code ebnf literal-block"><code>(* BEGIN EBNF GRAMMAR Filter *)
(* The top-level 'filter' rule: *)

Filter = [Spaces], Expression ;

(* Values *)

OrderedConstant = String | Number ;
UnorderedConstant = ( TRUE | FALSE ) ;

Value = ( UnorderedConstant | OrderedValue ) ;

OrderedValue = ( OrderedConstant | Property ) ;
(* Note: support for Property in OrderedValue is OPTIONAL *)

ValueListEntry = ( Value | ValueEqRhs | ValueRelCompRhs | FuzzyStringOpRhs ) ;
(* Note: support for ValueEqRhs, ValueRelCompRhs and FuzzyStringOpRhs in ValueListEntry are OPTIONAL *)

ValueList = ValueListEntry, { Comma, ValueListEntry } ;
ValueZip = ValueListEntry, Colon, ValueListEntry, { Colon, ValueListEntry } ;

ValueZipList = ValueZip, { Comma, ValueZip } ;

(* Expressions *)

Expression = ExpressionClause, [ OR, Expression ] ;

ExpressionClause = ExpressionPhrase, [ AND, ExpressionClause ] ;

ExpressionPhrase = [ NOT ], ( Comparison | OpeningBrace, Expression, ClosingBrace ) ;

Comparison = ConstantFirstComparison
           | PropertyFirstComparison ;
(* Note: support for ConstantFirstComparison is OPTIONAL *)

ConstantFirstComparison = ( OrderedConstant, ValueOpRhs
                          | UnorderedConstant, ValueEqRhs ) ;

PropertyFirstComparison = Property, [ ValueOpRhs
                                    | KnownOpRhs
                                    | FuzzyStringOpRhs
                                    | SetOpRhs
                                    | SetZipOpRhs
                                    | LengthOpRhs ] ;
(* Note: support for SetZipOpRhs in Comparison is OPTIONAL *)

ValueOpRhs = ( ValueEqRhs | ValueRelCompRhs ) ;

ValueEqRhs = EqualityOperator, Value ;

ValueRelCompRhs = RelativeComparisonOperator, OrderedValue ;

KnownOpRhs = IS, ( KNOWN | UNKNOWN ) ;

FuzzyStringOpRhs = CONTAINS, Value
                 | STARTS, [ WITH ], Value
                 | ENDS, [ WITH ], Value ;

SetOpRhs = HAS, ( ( Value | EqualityOperator, Value | RelativeComparisonOperator, OrderedValue | FuzzyStringOpRhs ) | ALL, ValueList | ANY, ValueList | ONLY, ValueList ) ;
(* Note: support for the alternatives with EqualityOperator, RelativeComparisonOperator, FuzzyStringOpRhs, and ONLY in SetOpRhs are OPTIONAL *)

SetZipOpRhs = PropertyZipAddon, HAS, ( ValueZip | ONLY, ValueZipList | ALL, ValueZipList | ANY, ValueZipList ) ;

PropertyZipAddon = Colon, Property, { Colon, Property } ;

LengthOpRhs = LENGTH, [ Operator ], Value ;
(* Note: support for [ Operator ] in LengthOpRhs is OPTIONAL *)

(* Property *)

Property = Identifier, { Dot, Identifier } ;

(* TOKENS *)

(* Separators: *)

OpeningBrace = '(', [Spaces] ;
ClosingBrace = ')', [Spaces] ;

Dot = '.', [Spaces] ;
Comma = ',', [Spaces] ;
Colon = ':', [Spaces] ;

(* Boolean relations: *)

AND = 'AND', [Spaces] ;
NOT = 'NOT', [Spaces] ;
OR = 'OR', [Spaces] ;

IS = 'IS', [Spaces] ;
KNOWN = 'KNOWN', [Spaces] ;
UNKNOWN = 'UNKNOWN', [Spaces] ;

CONTAINS = 'CONTAINS', [Spaces] ;
STARTS = 'STARTS', [Spaces] ;
ENDS = 'ENDS', [Spaces] ;
WITH = 'WITH', [Spaces] ;

LENGTH = 'LENGTH', [Spaces] ;
HAS = 'HAS', [Spaces] ;
ALL = 'ALL', [Spaces] ;
ONLY = 'ONLY', [Spaces] ;
ANY = 'ANY', [Spaces] ;

(* Comparison operator tokens: *)

Operator = ( EqualityOperator | RelativeComparisonOperator ) ;
EqualityOperator = [ '!' ], '=' , [Spaces] ;
RelativeComparisonOperator = ( '&lt;' | '&gt;' ), [ '=' ], [Spaces] ;

(* Boolean values *)

TRUE = 'TRUE', [Spaces] ;
FALSE = 'FALSE', [Spaces] ;

(* Property syntax *)

Identifier = LowercaseLetter, { LowercaseLetter | Digit }, [Spaces] ;

Letter = UppercaseLetter | LowercaseLetter ;

UppercaseLetter = 'A' | 'B' | 'C' | 'D' | 'E' | 'F' | 'G' | 'H' | 'I'
                | 'J' | 'K' | 'L' | 'M' | 'N' | 'O' | 'P' | 'Q' | 'R'
                | 'S' | 'T' | 'U' | 'V' | 'W' | 'X' | 'Y' | 'Z' ;

LowercaseLetter = 'a' | 'b' | 'c' | 'd' | 'e' | 'f' | 'g' | 'h' | 'i'
                | 'j' | 'k' | 'l' | 'm' | 'n' | 'o' | 'p' | 'q' | 'r'
                | 's' | 't' | 'u' | 'v' | 'w' | 'x' | 'y' | 'z' | '_' ;

(* Strings: *)

String = '&quot;', { EscapedChar }, '&quot;', [Spaces] ;

EscapedChar = UnescapedChar | '\', '&quot;' | '\', '\' ;

UnescapedChar = Letter | Digit | Space | Punctuator | UnicodeHighChar ;

Punctuator = '!' | '#' | '$' | '%' | '&amp;' | &quot;'&quot; | '(' | ')' | '*' | '+'
           | ',' | '-' | '.' | '/' | ':' | ';' | '&lt;' | '=' | '&gt;' | '?'
           | '&#64;' | '[' | ']' | '^' | '`' | '{' | '|' | '}' | '~' ;

(* BEGIN EBNF GRAMMAR Number *)
(* Number token syntax: *)

Number = [ Sign ] ,
         ( Digits, [ '.', [ Digits ] ] | '.' , Digits ),
         [ Exponent ], [Spaces] ;

Exponent =  ( 'e' | 'E' ) , [ Sign ] , Digits ;

Sign = '+' | '-' ;

Digits =  Digit, { Digit } ;

Digit = '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' ;

(* White-space: *)

(* Special character tokens: *)

tab = ? \t ?;
nl  = ? \n ?;
cr  = ? \r ?;
vt  = ? \v ?;
ff  = ? \f ?;

Space = ' ' | tab | nl | cr | vt | ff ;

Spaces = Space, { Space } ;

(* The 'UnicodeHighChar' specifies any Unicode character above 0x7F.
   It is specified in this grammar by an extension to EBNF that allows a
   regular expression to specify terminal symbol ranges. *)

UnicodeHighChar = ? [^\x00-\x7F] ? ;

(* END EBNF GRAMMAR Number *)
(* END EBNF GRAMMAR Filter *)</code></pre>
<p>Note: when implementing a parser according this grammar, the implementers MAY choose to construct a lexer that ignores all whitespace (spaces, tabs, newlines, vertical tabulation and form feed characters, as described in the grammar 'Space' definition), and use such a lexer to recognize language elements that are described in the <span class="docutils literal">(* TOKENS *)</span> section of the grammar.
In that case, it can be beneficial to remove the '[Spaces]' element from the <span class="docutils literal">Filter = [Spaces], Expression</span> definition as well and use the remaining grammar rules as a parser generator input (e.g., for yacc, bison, antlr).</p>
</section>
<section id="regular-expressions-for-optimade-filter-tokens">
<h3><a class="toc-backref" href="#toc-entry-118" role="doc-backlink"><span class="sectnum">9.2 </span>Regular Expressions for OPTIMADE Filter Tokens</a></h3>
<p>The string below contains Perl-Compatible Regular Expressions to recognize identifiers, number, and string values as specified in this specification.</p>
<pre class="code literal-block"><code>#BEGIN PCRE identifiers
[a-z_][a-z_0-9]*
#END PCRE identifiers

#BEGIN PCRE numbers
[-+]?(?:\d+(\.\d*)?|\.\d+)(?:[eE][-+]?\d+)?
#END PCRE numbers

#BEGIN PCRE strings
&quot;([^\\&quot;]|\\.)*&quot;
#END PCRE strings</code></pre>
<p>The strings below contain Extended Regular Expressions (EREs) to recognize identifiers, number, and string values as specified in this specification.</p>
<pre class="code literal-block"><code>#BEGIN ERE identifiers
[a-z_][a-z_0-9]*
#END ERE identifiers

#BEGIN ERE numbers
[-+]?([0-9]+(\.[0-9]*)?|\.[0-9]+)([eE][-+]?[0-9]+)?
#END ERE numbers

#BEGIN ERE strings
&quot;([^\&quot;]|\\.)*&quot;
#END ERE strings</code></pre>
</section>
<section id="the-symmetry-operation-string-regular-expressions">
<h3><a class="toc-backref" href="#toc-entry-119" role="doc-backlink"><span class="sectnum">9.3 </span>The Symmetry Operation String Regular Expressions</a></h3>
<p>Symmetry operation strings that comprise the <span class="property docutils literal">space_group_symmetry_operations_xyz</span> property MUST conform to the following regular expressions.
The regular expressions are recorded below in two forms, one in a more readable form using variables and the other as an explicit pattern compatible with the <a class="reference internal" href="#optimade-regular-expression-format">OPTIMADE Regular Expression Format</a>.</p>
<ul>
<li><p>Perl Compatible Regular Expression (PCRE) syntax, with <a class="reference external" href="https://perldoc.perl.org/perlre">Perl extensions</a> used for readability and expressivity.
The <span class="val docutils literal">symop_definitions</span> section defines several variables in Perl syntax that capture common parts of the regular expressions (REs) and need to be interpolated into the final REs used for matching.
The <span class="val docutils literal">symops</span> section contains the REs themselves.
The whitespace characters in these definitions are not significant; if used in Perl programs, these expressions MUST be processed with the <code>/x</code> RE modifier.
A working example of these REs in action can be found in the <code>tests/cases/pcre_symops_001.sh</code> and other test cases.</p>
<pre class="code PCRE literal-block"><code>#BEGIN PCRE symop_definitions

$translations = '1\/2|[12]\/3|[1-3]\/4|[1-5]\/6';

$symop_translation_appended = &quot;[-+]? [xyz] ([-+][xyz])? ([-+] ($translations) )?&quot;;
$symop_translation_prepended = &quot;[-+]? ($translations) ([-+] [xyz] ([-+][xyz])? )?&quot;;

$symop_re = &quot;($symop_translation_appended|$symop_translation_prepended)&quot;;

#END PCRE symop_definitions</code></pre>
<pre class="code PCRE literal-block"><code>#BEGIN PCRE symops

^ # From the beginning of the string...
($symop_re)(,$symop_re){2}
$ # ... match to the very end of the string

#END PCRE symops</code></pre>
</li>
<li><p>The regular expression is also provided in an expanded form as an OPTIMADE regex:</p>
<pre class="code ECMA literal-block"><code>#BEGIN ECMA symops

^([-+]?[xyz]([-+][xyz])?([-+](1/2|[12]/3|[1-3]/4|[1-5]/6))?|[-+]?(1/2|[12]/3|[1-3]/4|[1-5]/6)([-+][xyz]([-+][xyz])?)?),([-+]?[xyz]([-+][xyz])?([-+](1/2|[12]/3|[1-3]/4|[1-5]/6))?|[-+]?(1/2|[12]/3|[1-3]/4|[1-5]/6)([-+][xyz]([-+][xyz])?)?),([-+]?[xyz]([-+][xyz])?([-+](1/2|[12]/3|[1-3]/4|[1-5]/6))?|[-+]?(1/2|[12]/3|[1-3]/4|[1-5]/6)([-+][xyz]([-+][xyz])?)?)$

#END ECMA symops</code></pre>
</li>
</ul>
</section>
<section id="optimade-json-lines-partial-data-format">
<h3><a class="toc-backref" href="#toc-entry-120" role="doc-backlink"><span class="sectnum">9.4 </span>OPTIMADE JSON lines partial data format</a></h3>
<p>The OPTIMADE JSON lines partial data format is a lightweight format for transmitting property data that are too large to fit in a single OPTIMADE response.
The format is based on <a class="reference external" href="https://jsonlines.org/">JSON Lines</a>, which enables streaming of JSON data.
Note: since the below definition references both JSON fields and OPTIMADE properties, the data type names depend on context: for JSON they are, e.g., &quot;array&quot; and &quot;object&quot; and for OPTIMADE properties they are, e.g., &quot;list&quot; and &quot;dictionary&quot;.</p>
<p id="slice-object">To aid the definition of the format below, we first define a &quot;slice object&quot; to be a JSON object describing slices of arrays.
The dictionary has the following OPTIONAL fields:</p>
<ul class="simple">
<li><p><span class="field docutils literal">&quot;start&quot;</span>: Integer.
The slice starts at the value with the given index (inclusive).
The default is 0, i.e., the value at the start of the array.</p></li>
<li><p><span class="field docutils literal">&quot;stop&quot;</span>: Integer.
The slice ends at the value with the given index (inclusive).
If omitted, the end of the slice is the last index of the array.</p></li>
<li><p><span class="field docutils literal">&quot;step&quot;</span>: Integer.
The absolute difference in index between two subsequent values that are included in the slice.
The default is 1, i.e., every value in the range indicated by <span class="field docutils literal">start</span> and <span class="field docutils literal">stop</span> is included in the slice.
Hence, a value of 2 denotes a slice of every second value in the array.</p></li>
</ul>
<p>For example, for the array <span class="val docutils literal">[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;]</span> the slice object <span class="val docutils literal">{&quot;start&quot;: 1, &quot;end&quot;: 7, &quot;step&quot;: 3}</span> refers to the items <span class="val docutils literal">[&quot;b&quot;, &quot;e&quot;, &quot;h&quot;]</span>.</p>
<p>Furthermore, we also define the following special markers:</p>
<ul class="simple">
<li><p>The <em>end-of-data-marker</em> is this exact JSON: <span class="val docutils literal"><span class="pre">[&quot;PARTIAL-DATA-END&quot;,</span> <span class="pre">[&quot;&quot;]]</span></span>.</p></li>
<li><p>A <em>reference-marker</em> is this exact JSON: <span class="val docutils literal"><span class="pre">[&quot;PARTIAL-DATA-REF&quot;,</span> <span class="pre">[&quot;&lt;url&gt;&quot;]]</span></span>, where <span class="val docutils literal">&quot;&lt;url&gt;&quot;</span> is to be replaced with a URL being referenced.
A reference-marker MUST only occur in a place where the property being communicated could have an embedded list.</p></li>
<li><p>A <em>next-marker</em> is this exact JSON: <span class="val docutils literal"><span class="pre">[&quot;PARTIAL-DATA-NEXT&quot;,</span> <span class="pre">[&quot;&lt;url&gt;&quot;]]</span></span>, where <span class="val docutils literal">&quot;&lt;url&gt;&quot;</span> is to be replaced with the target URL for the next link.</p></li>
</ul>
<p>There is no requirement on the syntax or format of the URLs provided in these markers.
When data is fetched from these URLs the response MUST use the JSON lines partial data format, i.e., the markers cannot be used to link to partial data provided in other formats.
The markers have been deliberately designed to be valid JSON objects but <em>not</em> valid OPTIMADE property values.
Since the OPTIMADE list data type is defined as a list of values of the same data type or <span class="val docutils literal">null</span>, the above markers cannot be encountered inside the actual data of an OPTIMADE property.</p>
<blockquote>
<p><strong>Implementation note:</strong> the recognizable string values for the markers should make it possible to prescreen the raw text of the JSON data lines for the reference-marker string to determine which are the lines that one can exclude from further processing to resolve references (alternatively, this screening can be done by the string parser used by the JSON parser).
The underlying design idea is that for lines that have reference-markers, the time it takes to process the data structure to locate the markers should be negligible compared to the time it takes to resolve and handle the large data they reference.
Hence, the most relevant optimization is to avoid spending time processing data structures to find markers for lines where there are none.</p>
</blockquote>
<p>The full response MUST be valid <a class="reference external" href="https://jsonlines.org/">JSON Lines</a> that adheres to the following format:</p>
<ul class="simple">
<li><p>The first line is a header object (defined below).</p></li>
<li><p>The following lines are data lines adhering to the formats described below.</p></li>
<li><p>The final line is either an end-of-data-marker (indicating that there is no more data to be given), or a next-marker indicating that more data is available, which can be obtained by retrieving data from the provided URL.</p></li>
</ul>
<p>The first line MUST be a JSON object providing header information.
The header object MUST contain the keys:</p>
<ul>
<li><p><span class="field docutils literal"><span class="pre">&quot;optimade-partial-data&quot;</span></span>: Object.
An object identifying the response as being on OPTIMADE partial data format.</p>
<p>It MUST contain the following key:</p>
<ul class="simple">
<li><p><span class="field docutils literal">&quot;format&quot;</span>: String.
Specifies the minor version of the partial data format used.
The string MUST be of the format &quot;MAJOR.MINOR&quot;, referring to the version of the OPTIMADE standard that describes the format.
The version number string MUST NOT be prefixed by, e.g., &quot;v&quot;. In implementations of the present version of the standard, the value MUST be exactly <span class="val docutils literal">1.2</span>.
A client MUST NOT expect to be able to parse the <span class="field docutils literal">format</span> value if the field is not a string of the format MAJOR.MINOR or if the MAJOR version number is unrecognized.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal">&quot;layout&quot;</span>: String.
A string either equal to <span class="val docutils literal">&quot;dense&quot;</span> or <span class="val docutils literal">&quot;sparse&quot;</span> to indicate whether the returned format uses a dense or sparse layout.</p></li>
</ul>
<p>The following key is RECOMMENDED in the header object:</p>
<ul class="simple">
<li><p><span class="field docutils literal">&quot;returned_ranges&quot;</span>: Array of Object.
For dense layout, and sparse layout of one dimensional list properties, the array contains a single element which is a <a class="reference internal" href="#slice-object">slice object</a> representing the range of data present in the response.
In the specific case of a hierarchy of list properties represented as a sparse multidimensional array, if the field <span class="field docutils literal">&quot;returned_ranges&quot;</span> is given, it MUST contain one slice object per dimension of the multidimensional array, representing slices for each dimension that cover the data given in the response.</p></li>
</ul>
<p>The header object MAY also contain the keys:</p>
<ul class="simple">
<li><p><span class="field docutils literal">&quot;property_name&quot;</span>: String.
The name of the property being provided.</p></li>
<li><p><span class="field docutils literal">&quot;entry&quot;</span>: Object.
An object that MUST have the following two keys:</p>
<ul>
<li><p><span class="field docutils literal">&quot;id&quot;</span>: String.
The id of the entry of the property being provided.</p></li>
<li><p><span class="field docutils literal">&quot;type&quot;</span>: String.
The type of the entry of the property being provided.</p></li>
</ul>
</li>
<li><p><span class="field docutils literal">&quot;has_references&quot;</span>: Boolean.
An optional boolean to indicate whether any of the data lines in the response contains a reference marker.
A value of <span class="val docutils literal">false</span> means that the client does not have to process any of the lines to detect reference markers, which may speed up the parsing.</p></li>
<li><p><span class="field docutils literal">&quot;item_schema&quot;</span>: Object.
An object that represents a JSON Schema that validates the data lines of the response.
The format SHOULD be the relevant partial extract of a valid property definition as described in <a class="reference internal" href="#property-definitions">Property Definitions</a>.
If a schema is provided, it MUST be a valid JSON schema using the same version of JSON schema as described in that section.</p></li>
<li><p><span class="field docutils literal">&quot;links&quot;</span>: Object.
An object to provide relevant links for the property being provided.
It MAY contain the following key:</p>
<ul>
<li><p><span class="field docutils literal">&quot;base_url&quot;</span>: String.
The base URL of the implementation serving the database to which this property belongs.</p></li>
<li><p><span class="field docutils literal">&quot;item_describedby&quot;</span>: String.
A URL to an external JSON Schema that validates the data lines of the response.
The format and requirements on this schema are the same as for the inline schema field <span class="field docutils literal">item_schema</span>.</p></li>
</ul>
</li>
</ul>
<p>The format of data lines of the response (i.e., all lines except the first and the last) depends on whether the header object specifies the layout as <span class="val docutils literal">&quot;dense&quot;</span> or <span class="val docutils literal">&quot;sparse&quot;</span>.</p>
<ul class="simple">
<li><p><strong>Dense layout:</strong> In the dense partial data layout, each data line reproduces one item from the OPTIMADE list property being transmitted in the JSON format.
If OPTIMADE list properties are embedded inside the item, they can either be included in full or replaced with a reference-marker.
If a list is replaced by a reference marker, the client MAY use the provided URL to obtain the list items.
If the field <span class="field docutils literal">&quot;returned_ranges&quot;</span> is omitted, then the client MUST assume that the data is a continuous range of data from the start of the array up to the number of elements given until reaching the end-of-data-marker or next-marker.</p></li>
<li><p><strong>Sparse layout for one-dimensional list:</strong> When the response sparsely communicates items for a one-dimensional OPTIMADE list property, each data line contains a JSON array of the format:</p>
<ul>
<li><p>The first item of the array is the zero-based index of list property item being provided by this line.</p></li>
<li><p>The second item of the array is the list property item located at the indicated index, represented using the same format as each line in the dense layout.
In the same way as for the dense layout, reference-markers are allowed inside the item data for embedded lists that do not fit in the response (see example below).</p></li>
</ul>
</li>
<li><p><strong>Sparse layout for multidimensional lists:</strong> the server MAY use a specific sparse layout for the case that the OPTIMADE property represents a series of directly hierarchically embedded lists (i.e., a multidimensional sparse array).
In this case, each data line contains a JSON array of the format:</p>
<ul>
<li><p>All array items except the last one are integer zero-based indices of the list property item being provided by this line; these indices refer to the aggregated dimensions in the order of outermost to innermost.</p></li>
<li><p>The last item of the array is the list property item located at the indicated coordinates, represented using the same format as each line in the dense layout.
In the same way as for the dense layout, reference-markers are allowed inside the item data for embedded lists that do not fit in the response (see example below).</p></li>
</ul>
</li>
</ul>
<p>If the final line of the response is a next-marker, the client MAY continue fetching the data for the property by retrieving another partial data response from the provided URL.
If the final line is an end-of-data-marker, any data not covered by any of the responses are to be assigned the value <span class="val docutils literal">null</span>.</p>
<p>If <span class="field docutils literal">&quot;returned_ranges&quot;</span> is included in the response and the client encounters a next-marker before receiving all lines indicated by the slice, it should proceed by not assigning any values to the corresponding items, i.e., this is not an error.
Since the remaining values are not assigned a value, they will be <span class="val docutils literal">null</span> if they are not assigned values by another response retrieved via a next link encountered before the final end-of-data-marker.
(Since there is no requirement that values are assigned in a specific order between responses, it is possible that the omitted values are already assigned.
In that case the values shall remain as assigned, i.e., they are not overwritten by <span class="val docutils literal">null</span> in this situation.)</p>
<section id="examples">
<h4><a class="toc-backref" href="#toc-entry-121" role="doc-backlink"><span class="sectnum">9.4.1 </span>Examples</a></h4>
<p>Below follows an example of a dense response for a partial array data of integer values.
The request returns the first three items and provides the next-marker link to continue fetching data:</p>
<pre class="code jsonl literal-block"><code>{&quot;optimade-partial-data&quot;: {&quot;format&quot;: &quot;1.2.0&quot;}, &quot;layout&quot;: &quot;dense&quot;, &quot;returned_ranges&quot;: [{&quot;start&quot;: 10, &quot;stop&quot;: 20, &quot;step&quot;: 2}]}
123
345
-12.6
[&quot;PARTIAL-DATA-NEXT&quot;, [&quot;https://example.db.org/value4&quot;]]</code></pre>
<p>Below follows an example of a dense response for a list property as a partial array of multidimensional array values.
The item with index 10 in the original list is provided explicitly in the response and is the first one provided in the response since start=10.
The item with index 12 in the list, the second data item provided since start=10 and step=2, is not included only referenced.
The third provided item (index 14 in the original list) is only partially returned: it is a list of three items, the first and last are explicitly provided, the second one is only referenced.</p>
<pre class="code jsonl literal-block"><code>{&quot;optimade-partial-data&quot;: {&quot;format&quot;: &quot;1.2.0&quot;}, &quot;layout&quot;: &quot;dense&quot;, &quot;returned_ranges&quot;: [{&quot;start&quot;: 10, &quot;stop&quot;: 20, &quot;step&quot;: 2}]}
[[10,20,21], [30,40,50]]
[&quot;PARTIAL-DATA-REF&quot;, [&quot;https://example.db.org/value2&quot;]]
[[11, 110], [&quot;PARTIAL-DATA-REF&quot;, [&quot;https://example.db.org/value3&quot;]], [550, 333]]
[&quot;PARTIAL-DATA-NEXT&quot;, [&quot;https://example.db.org/value4&quot;]]</code></pre>
<p>Below follows an example of the sparse layout for multidimensional lists with three aggregated dimensions.
The underlying property value can be taken to be sparse data in lists in four dimensions of 10000 x 10000 x 10000 x N, where the innermost list is a non-sparse list of arbitrary length of numbers.
The only non-null items in the outer three dimensions are, say, [3,5,19], [30,15,9], and [42,54,17].
The response below communicates the first item explicitly; the second one by deferring the innermost list using a reference-marker; and the third item is not included in this response, but deferred to another page via a next-marker.</p>
<pre class="code jsonl literal-block"><code>{&quot;optimade-partial-data&quot;: {&quot;format&quot;: &quot;1.2.0&quot;}, &quot;layout&quot;: &quot;sparse&quot;}
[3,5,19,  [10,20,21,30]]
[30,15,9, [&quot;PARTIAL-DATA-REF&quot;, [&quot;https://example.db.org/value1&quot;]]]
[&quot;PARTIAL-DATA-NEXT&quot;, [&quot;https://example.db.org/&quot;]]</code></pre>
<p>An example of the sparse layout for multidimensional lists with three aggregated dimensions and integer values:</p>
<pre class="code jsonl literal-block"><code>{&quot;optimade-partial-data&quot;: {&quot;format&quot;: &quot;1.2.0&quot;}, &quot;layout&quot;: &quot;sparse&quot;}
[3,5,19,  10]
[30,15,9, 31]
[&quot;PARTIAL-DATA-NEXT&quot;, [&quot;https://example.db.org/&quot;]]</code></pre>
<p>An example of the sparse layout for multidimensional lists with three aggregated dimensions and values that are multidimensional lists of integers of arbitrary lengths:</p>
<pre class="code jsonl literal-block"><code>{&quot;optimade-partial-data&quot;: {&quot;format&quot;: &quot;1.2.0&quot;}, &quot;layout&quot;: &quot;sparse&quot;}
[3,5,19, [ [10,20,21], [30,40,50] ] ]
[3,7,19, [&quot;PARTIAL-DATA-REF&quot;, [&quot;https://example.db.org/value2&quot;]]]
[4,5,19, [ [11, 110], [&quot;PARTIAL-DATA-REF&quot;, [&quot;https://example.db.org/value3&quot;]], [550, 333]]]
[&quot;PARTIAL-DATA-END&quot;, [&quot;&quot;]]</code></pre>
</section>
</section>
<section id="property-definition-example">
<h3><a class="toc-backref" href="#toc-entry-122" role="doc-backlink"><span class="sectnum">9.5 </span>Property Definition Example</a></h3>
<p>This appendix provides a more complete example of a Property Definition in the format defined in <a class="reference internal" href="#property-definitions">Property Definitions</a>.
(Note: the description strings have been wrapped for readability only.)</p>
<pre class="code jsonc literal-block"><code>{
  &quot;title&quot;: &quot;Forces and atomic masses list&quot;,
  &quot;$id&quot;: &quot;https://properties.example.com/v1.2.0/forces_and_masses&quot;,
  &quot;x-optimade-type&quot;: &quot;list&quot;,
  &quot;x-optimade-property&quot;: {
    &quot;version&quot;: &quot;1.2.0&quot;,
    &quot;property-format&quot;: &quot;1.2&quot;,
    &quot;units&quot;: [
      {
        &quot;title&quot;: &quot;Newton&quot;,
        &quot;symbol&quot;: &quot;N&quot;,
        &quot;$id&quot;: &quot;https://units.example.com/v1.2.0/N&quot;,
        &quot;description&quot;: &quot;The newton SI unit of force, defined as 1 kg m/s^2
                        using the 2019 redefinition of the SI base units.&quot;,
        &quot;standard&quot;: {
          &quot;name&quot;: &quot;gnu units&quot;,
          &quot;version&quot;: &quot;3.15&quot;,
          &quot;symbol&quot;: &quot;newton&quot;
        },
        &quot;defining-relation&quot;: {
          &quot;base-units&quot;: [
            {
              &quot;symbol&quot;: &quot;kg&quot;,
              &quot;id&quot;: &quot;https://units.example.com/v1.2.0/kg&quot;
            },
            {
              &quot;symbol&quot;: &quot;m&quot;,
              &quot;id&quot;: &quot;https://units.example.com/v1.2.0/m&quot;
            },
            {
              &quot;symbol&quot;: &quot;s&quot;,
              &quot;id&quot;: &quot;https://units.example.com/v1.2.0/s&quot;
            }
          ],
          &quot;base-units-expression&quot;: &quot;kg*m*s^-2&quot;
        }
      },
      {
        &quot;title&quot;: &quot;Dalton mass unit&quot;,
        &quot;symbol&quot;: &quot;u&quot;,
        &quot;$id&quot;: &quot;https://units.example.com/v1.2.0/u&quot;,
        &quot;description&quot;: &quot;The dalton mass unit defined as 1/12 of the mass of an
                        unbound neutral atom of carbon-12 in its nuclear and
                        electronic ground state and at rest. Approximately
                        equal to $1.66053906660(50)*10^{-27}$ kg&quot;,
        &quot;standard&quot;: {
          &quot;name&quot;: &quot;gnu units&quot;,
          &quot;version&quot;: &quot;3.15&quot;,
          &quot;symbol&quot;: &quot;atomicmassunit&quot;
        }
      }
    ]
  },
  &quot;type&quot;: [&quot;array&quot;, &quot;null&quot;],
  &quot;description&quot;: &quot;A list of forces and atomic masses&quot;,
  &quot;examples&quot;: [
    [{&quot;force&quot;: 42.0, &quot;mass&quot;: 28.0855}, {&quot;force&quot;: 44.2, &quot;mass&quot;: 15.9994}],
    [{&quot;force&quot;: 12.0, &quot;mass&quot;: 24.3050}]
  ],
  &quot;x-optimade-unit&quot;: &quot;inapplicable&quot;,
  &quot;x-optimade-requirements&quot;: {
    &quot;support&quot;: &quot;should&quot;,
    &quot;sortable&quot;: false,
    &quot;query-support&quot;: &quot;none&quot;
  },
  &quot;items&quot;: {
    &quot;title&quot;: &quot;Force and atomic mass pair&quot;,
    &quot;x-optimade-type&quot;: &quot;dictionary&quot;,
    &quot;description&quot;: &quot;A dictionary containing a force and mass value&quot;,
    &quot;x-optimade-unit&quot;: &quot;inapplicable&quot;,
    &quot;type&quot;: [&quot;object&quot;],
    &quot;properties&quot;: {
      &quot;force&quot;: {
        &quot;title&quot;: &quot;Force&quot;,
        &quot;description&quot;: &quot;A force value&quot;,
        &quot;x-optimade-type&quot;: &quot;float&quot;,
        &quot;x-optimade-unit&quot;: &quot;N&quot;,
        &quot;type&quot;: [&quot;number&quot;],
        &quot;examples&quot;: [42.0]
      },
      &quot;mass&quot;: {
        &quot;title&quot;: &quot;Mass&quot;,
        &quot;description&quot;: &quot;An atomic mass&quot;,
        &quot;x-optimade-type&quot;: &quot;float&quot;,
        &quot;x-optimade-unit&quot;: &quot;u&quot;,
        &quot;type&quot;: [&quot;number&quot;],
        &quot;examples&quot;: [15.9994]
      }
    }
  }
}</code></pre>
</section>
<section id="optimade-regular-expression-format">
<h3><a class="toc-backref" href="#toc-entry-123" role="doc-backlink"><span class="sectnum">9.6 </span>OPTIMADE Regular Expression Format</a></h3>
<p>This section defines a Unicode string representation of regular expressions (regexes) to be referenced from other parts of the specification.
The format will be referred to as an &quot;OPTIMADE regex&quot;.</p>
<p>Regexes are commonly embedded in a context where they need to be enclosed by delimiters (e.g., double quotes or slash characters).
If this is the case, some outer-level escape rules likely apply to allow the end delimiter to appear within the regex.
Such delimiters and escape rules are <em>not</em> included in the definition of the OPTIMADE regex format itself and need to be clarified when this format is referenced.
The format defined in this section applies after such outer escape rules have been applied (e.g., when all occurrences of <span class="docutils literal">\/</span> have been translated into <span class="docutils literal">/</span> for a format where an unescaped slash character is the end delimiter).
Likewise, if an OPTIMADE regex is embedded in a serialized data format (e.g., JSON), this section documents the format of the Unicode string resulting from the deserialization of that format.</p>
<p>An OPTIMADE regex is a regular expression that adheres to <a class="reference external" href="https://262.ecma-international.org/11.0/#sec-patterns">ECMA-262, section 21.2.1</a> with additional restrictions described below which define a subset of the ECMA-262 format chosen to match features commonly available in different database backends.
The regex is interpreted according to the ECMA-262 processing rules that apply for an expression where only the Unicode variable is set to true of all variables set by the RegExp internal slot described by <a class="reference external" href="https://262.ecma-international.org/11.0/#sec-notation">ECMA-262, section 21.2.2.1</a>.</p>
<p>The subset includes only the following tokens and features:</p>
<ul class="simple">
<li><p>Individual Unicode characters matching themselves, as defined by the JSON specification (<a class="reference external" href="https://tools.ietf.org/html/rfc8259.html">RFC 8259</a>).</p></li>
<li><p>The <span class="docutils literal">.</span> character to match any one Unicode character except the line break characters LINE FEED (LF) (U+000A), CARRAGE RETURN (U+000D), LINE SEPARATOR (U+2028), PARAGRAPH SEPARATOR (U+2029) (see <a class="reference external" href="https://262.ecma-international.org/14.0/?_gl=1*yqtzjq*_ga*MjEzNTE2ODEyNi4xNzA0NTQ1NTk5*_ga_TDCK4DWEPP*MTcwNzk5ODA1My43LjEuMTcwNzk5OTYxNC4wLjAuMA..#sec-compileatom">ECMA-262 section 2.2.2.7</a>).</p></li>
<li><p>A literal escape of <a class="reference external" href="https://262.ecma-international.org/11.0/#prod-SyntaxCharacter">one of the characters defined as syntax characters in the ECMA-262 standard</a>, i.e., the escape character (<span class="docutils literal">\</span>) followed by one of the following characters <span class="docutils literal">^ $ \ . * + ? ( ) [ ] { } |</span> to represent that literal character.
No other characters can be escaped.
(This rule prevents other escapes that are interpreted differently depending on regex flavor.)</p></li>
<li><p>Simple character classes (e.g., <span class="docutils literal">[abc]</span>), complemented character classes (e.g. <span class="docutils literal">[^abc]</span>), and their ranged versions (e.g., <span class="docutils literal"><span class="pre">[a-z]</span></span>, <span class="docutils literal"><span class="pre">[^a-z]</span></span>) with the following constraints:</p>
<ul>
<li><p>The character <span class="docutils literal">-</span> designates ranges, unless it is the first or last character of the class in which case it represents a literal <span class="docutils literal">-</span> character.</p></li>
<li><p>If the first character is <span class="docutils literal">^</span> then the expression matches all characters <em>except</em> the ones specified by the class as defined by the characters that follows.</p></li>
<li><p>The characters <span class="docutils literal">\ [ ]</span> can only appear escaped with a preceding backslash, e.g. <span class="docutils literal">\\</span> designates that the class includes a literal <span class="docutils literal">\</span> character.
The other syntax characters may appear either escaped or unescaped to designate that the class includes them.
(This rule prevents other escapes inside classes that are not the same across regex flavors and expressions that, in some flavors, are interpreted as nested classes.)</p></li>
<li><p>Except as specified above, all characters represent themselves literally (including syntax characters).</p></li>
<li><p>Characters that represent themselves literally can only appear at most once.
(This rule prevents various kinds of extended character class syntax that differs between regex formats that assigns special meaning to duplicated characters such as POSIX character classes, e.g., <span class="docutils literal">[:alpha:]</span>, equivalence classes, e.g., <span class="docutils literal">[=a=]</span>, set constructs, e.g. <span class="docutils literal"><span class="pre">[A--B]</span></span>, <span class="docutils literal"><span class="pre">[A&amp;&amp;B]</span></span>, etc.).</p></li>
</ul>
</li>
<li><p>Simple quantifiers: <span class="docutils literal">+</span> (one or more), <span class="docutils literal">*</span> (zero or more), <span class="docutils literal">?</span> (zero or one) that appear directly after a character, group, or character class.
(This rule prevents expressions with special meaning in some regex flavors, e.g., <span class="docutils literal">+?</span> and <span class="docutils literal"><span class="pre">(?...)</span></span>.)</p></li>
<li><p>The beginning-of-input (<span class="docutils literal">^</span>) and end-of-input (<span class="docutils literal">$</span>) anchors.</p></li>
<li><p>Simple grouping (<span class="docutils literal"><span class="pre">(...)</span></span>) and alternation (<span class="docutils literal">|</span>).</p></li>
</ul>
<p>Note that lazy quantifiers (<span class="docutils literal">+?</span>, <span class="docutils literal">*?</span>, <span class="docutils literal"><span class="pre">??</span></span>) are <em>not</em> included, nor are range quantifiers (<span class="docutils literal">{x}</span>, <span class="docutils literal">{x,y}</span>, <span class="docutils literal">{x,}</span>).
Furthermore, there is no support for escapes designating shorthand character classes as <span class="docutils literal">\</span> and a letter or number, nor is there any way to represent a Unicode character by specifying a code point as a number, only via the Unicode character itself.
(However, the regex can be embedded in a context that defines such escapes, e.g., in serialized JSON a string containing the character <span class="docutils literal">\u</span> followed by four hexadecimal digits is deserialized into the corresponding Unicode character.)</p>
<p>An OPTIMADE regex matches the string at any position unless it contains a leading beginning-of-input (<span class="docutils literal">^</span>) or trailing end-of-input (<span class="docutils literal">$</span>) anchor listed above, i.e., the anchors are not implicitly assumed.
For example, the OPTIMADE regex &quot;es&quot; matches &quot;expression&quot;.</p>
<p>Regexes that utilize tokens and features beyond the designated subset are allowed to have an undefined behavior, i.e., they MAY match or not match <em>any</em> string or MAY produce an error.
Implementations that do not produce errors in this situation are RECOMMENDED to generate warnings if possible.</p>
<blockquote>
<p>Compatibility notes:</p>
<ul class="simple">
<li><p>The subset is intended to be compatible with, but even further restricted than, the subset recommended in the JSON Schema standard, see <a class="reference external" href="https://json-schema.org/draft/2020-12/json-schema-core#section-6.4">JSON Schema: A Media Type for Describing JSON Documents 2020-12, section 6.4</a>.
The compatibility with the JSON Schema standard is expressed here as &quot;intended&quot; since there is some room for interpretation of the precise features included in the recommendation given in that standard.</p></li>
<li><p>The definition tolerates (with undefined behavior) regexes that use tokens and features beyond the defined subset.
Hence, a regex can be directly handed over to a backend implementation compatible with the subset without needing validation or translation.</p></li>
<li><p>Additional consideration of how the <span class="docutils literal">.</span> character operates in relation to line breaks may be required for multiline text.
If the regex is applied to strings containing only the LINE FEED (U+000A) character and none of the other Unicode line break characters, most regex backend implementations are compatible with the defined behavior.
If the regex is applied to string data containing arbitrary combinations of Unicode line break characters and the right behavior cannot be achieved via environmental settings and regex options, implementations can consider a translation step where other line break characters are translated into LINE FEED in the text operated on.</p></li>
<li><p>Compatibility with different regex implementations may change depending on the environment, implementation programming language versions, and options and has to be verified by implementations.
However, as a general guide, we have used third-party sources, e.g., the <a class="reference external" href="https://gist.github.com/CMCDragonkai/6c933f4a7d713ef712145c5eb94a1816">Regular Expression Engine Comparison Chart</a> to collect the following information for compatibility when operating on text using LINE FEED as the line break character:</p>
<ul>
<li><p><a class="reference external" href="https://262.ecma-international.org/">ECMAScript (also known as javascript)</a> and version 1 and 2 of <a class="reference external" href="https://www.pcre.org/">PCRE</a> are meant to be compatible by design when used with appropriate options.</p></li>
<li><p>The following regex formats appear generally compatible when operating in Unicode mode: <a class="reference external" href="https://perldoc.perl.org/perlre">Perl</a>, <a class="reference external" href="https://docs.python.org/3/library/re.html">Python</a>, <a class="reference external" href="https://ruby-doc.org/3.2.2/Regexp.html">Ruby</a>, <a class="reference external" href="https://docs.rs/regex/latest/regex/">Rust</a>, <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html">Java</a>, <a class="reference external" href="https://learn.microsoft.com/en-us/dotnet/standard/base-types/details-of-regular-expression-behavior">.NET</a>, <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/regexp.html">MySQL 8</a>, <a class="reference external" href="https://www.mongodb.com/docs/manual/reference/operator/query/regex/">MongoDB</a>, <a class="reference external" href="https://docs.oracle.com/cd/B13789_01/appdev.101/b10795/adfns_re.htm">Oracle</a>, <a class="reference external" href="https://www.ibm.com/docs/en/db2/11.5?topic=reference-regular-expressions">IBM Db2</a>, <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/regexp-syntax.html">Elasticsearch</a>, <a class="reference external" href="https://duckdb.org/docs/sql/functions/patternmatching.html#regular-expressions">DuckDB</a> (which uses the <a class="reference external" href="https://github.com/google/re2/wiki/Syntax">re2</a> library).</p></li>
<li><p>SQLite supports regexes via libraries and thus can use a compatible format (e.g., PCRE2).</p></li>
<li><p>XML Schema appears to use a compatible regex format, except it is implicitly anchored: i.e., the beginning-of-input <span class="docutils literal">^</span> and end-of-input <span class="docutils literal">$</span> anchors must be removed, and missing anchors replaced by <span class="docutils literal">.*</span>.</p></li>
<li><p>POSIX Extended regexes (and their extended GNU implementations) are incompatible because <span class="docutils literal">\</span> is not a special character in character classes.
POSIX Basic regexes also have further differences, e.g., the meaning of some escaped syntax characters is reversed.</p></li>
</ul>
</li>
</ul>
</blockquote>
</section>
</section>
</main>
<footer>
<p>Generated on: 2024-04-05.
</p>
</footer>
</body>
</html>
